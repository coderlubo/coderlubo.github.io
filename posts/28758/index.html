<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    <meta name="description" content="Hexo Theme Redefine">
    <meta name="author" content="Lubo">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-redefine.png">
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/posts/28758/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    <meta property="og:type" content="article">
    <meta property="og:title" content="计算机网络">
    <meta property="og:description" content="Hexo Theme Redefine">
    <meta property="og:url" content="http://example.composts/28758/">
    <meta property="og:image" content="/images/redefine-logo.svg">
    <meta property="og:site_name" content="Lubo&#39;s Blog">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="计算机网络">
    <meta name="twitter:description" content="Hexo Theme Redefine">
    <meta name="twitter:image" content="/images/redefine-logo.svg">
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/redefine-logo.svg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/redefine-logo.svg">
    <meta name="theme-color" content="#005080">
    <link rel="shortcut icon" href="/images/redefine-logo.svg">
    
    <title>
        
            计算机网络 -
        
        Lubo&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/assets/fonts.css">
    
    
    
    
        <link rel="preconnect" href="https://evan.beee.top" crossorigin>
    
    <script id="hexo-configurations">
    let REDEFINE = window.REDEFINE || {};
    REDEFINE.hexo_config = {"hostname":"example.com","root":"/","language":"en","path":"search.xml"};
    REDEFINE.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true},"style":{"primary_color":"#005080","avatar":"/images/1.svg","favicon":"/images/redefine-logo.svg","article_img_align":"center","right_side_width":"210px","content_max_width":"1000px","nav_color":{"left":"#000000","right":"#DCDCDC","transparency":40},"hover":{"shadow":true,"scale":false},"first_screen":{"enable":true,"background_image":{"light":"https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/2ad62c38f0b41506ca9ed2f57ed549c4-bg2-134b10.jpg","dark":"https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/2ad62c38f0b41506ca9ed2f57ed549c4-bg2-134b10.jpg"},"title_color":{"light":"#000","dark":"#d1d1b6"},"description":"This is Lubo's Blog","custom_font":{"enable":false,"font_family":null,"font_url":null}},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":true},"code_block":{"copy":true,"style":"simple","custom_font":{"enable":false,"font_family":null,"font_url":null}},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"1.1.3","friend_links":{"columns":2},"home_article":{"date_format":"auto","category":{"enable":true,"limit":3},"tag":{"enable":true,"limit":3}}};
    REDEFINE.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
    
    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/fontawesome/fontawesome.min.css">
    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/fontawesome/brands.min.css">
    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/fontawesome/solid.min.css">
    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/fontawesome/regular.min.css">
    
    
    
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="menu-wrapper">
    
    <div class="menu-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Lubo&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="pc">
                <ul class="menu-list">
                    
                        
                            <li class="menu-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        HOME
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="menu-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        ARCHIVES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="menu-drawer">
        <ul class="drawer-menu-list">
            
                
                    <li class="drawer-menu-item flex-center">
                        <a class="" 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                HOME
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-menu-item flex-center">
                        <a class="" 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                ARCHIVES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            
            
                <div class="article-title">
                    <h1 class="article-title-regular">计算机网络</h1>
                </div>
            
                
            

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/1.svg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Lubo</span>
                            
                        </div>
                        <div class="meta-info">
                            <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="pc">2021-10-09</span>
        <span class="mobile">2021-10-09 00</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="pc">2023-03-11 09:25:07</span>
            <span class="mobile">2023-03-11 09:25</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">基础知识</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Network/">Network</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content markdown-body">
                <h1>计算机网络</h1>
<h4>2021年10月9日</h4>
<hr>
<h2 id="第一章-计算机网络概述">第一章 计算机网络概述</h2>
<h3 id="一、什么是-Internet">一、什么是 Internet</h3>
<h4 id="什么是-Internet-——-从具体构成角度">什么是 Internet —— 从具体构成角度</h4>
<ul>
<li>
<p>节点</p>
<ul>
<li>主机及其上运行的应用程序</li>
<li>路由器、交换机等网络交换设备</li>
</ul>
</li>
<li>
<p>边：通信链路</p>
<ul>
<li>接入网链路：主机连接到互联网的链路</li>
<li>主干链路：路由器间的链路</li>
</ul>
</li>
<li>
<p>==协议==</p>
<blockquote>
<p>协议定义了在两个或多个通信实体之间交换的 ==报文格式和次序==，以及在报文传输和/或接收或其他事件方面所采取的 ==动作==</p>
</blockquote>
<ul>
<li>类似人类协议</li>
<li>机器之间的协议而非人与人之间的协议</li>
<li>Internet 中所有的通信行为都受协议制约</li>
</ul>
</li>
<li>
<p>数以亿计的、互联的计算设备：</p>
<ul>
<li>主机 = 端系统</li>
<li>运行网络应用程序</li>
</ul>
</li>
<li>
<p>通信链路</p>
<ul>
<li>光纤、同轴电缆、无线电Q 、卫星</li>
<li>传输速率 = 带宽（bps） router</li>
</ul>
</li>
<li>
<p>分组交换设备：转发分组 (packets)</p>
</li>
<li>
<p>路由器和交换机</p>
</li>
<li>
<p>协议控制发送、接收消息</p>
<ul>
<li>如TCP、IP、HTTP、FTP、 PPP</li>
</ul>
</li>
<li>
<p>Internet：“网络的网络”</p>
<ul>
<li>松散的层次结构，互连的ISP</li>
<li>公共Internet vs. 专用intranet</li>
</ul>
</li>
<li>
<p>Internet标准</p>
<ul>
<li>RFC: Request for comments</li>
<li>IETF: Internet Engineering Task Force</li>
</ul>
</li>
</ul>
<h4 id="什么是-Internet-——-从服务角度">什么是 Internet —— 从服务角度</h4>
<ul>
<li>使用通信设施进行通信的分 布式应用
<ul>
<li>Web、VoIP、email、分布式 游戏、电子商务、社交网络 ……</li>
</ul>
</li>
<li>通信基础设施为 apps 提供编程接口（通信服务）
<ul>
<li>将发送和接收数据的 apps 与互联网连接起来</li>
<li>为 app 应用提供服务选择，类似于邮政服务：
<ul>
<li>无连接不可靠服务</li>
<li>面向连接的可靠服务</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<h3 id="网络结构">网络结构</h3>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/e351785bfedd7a35082d608042c3751b-%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84-b6e002.png"
                      style="zoom:50%;" 
                >
<ul>
<li>网络边缘：
<ul>
<li>主机</li>
<li>应用程序（客户端和服务 器）</li>
</ul>
</li>
<li>网络核心：—— 数据交换
<ul>
<li>互连着的路由器</li>
<li>网络的网络</li>
</ul>
</li>
<li>接入网、物理媒体：
<ul>
<li>有线或者无线通信链路</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="二、网络边缘">二、网络边缘</h3>
<ul>
<li>
<p>端系统（主机）：</p>
<ul>
<li>运行应用程序</li>
<li>如 Web、email 在 “网络的边缘”</li>
</ul>
</li>
<li>
<p>客户/服务器模式</p>
<ul>
<li>客户端向服务器请求、接收服务</li>
<li>如Web浏览器/服务器；email 客户端/服务器</li>
</ul>
</li>
<li>
<p>对等（peer-peer ）模式</p>
<ul>
<li>很少（甚至没有）专门的服务器</li>
<li>如 Gnutella、KaZaA、Emule</li>
</ul>
</li>
</ul>
<p>==<strong>目标：在端系统之间传输数据</strong>==</p>
<ul>
<li>
<p>握手：在数据传输之前 做好准备</p>
<ul>
<li>人类协议中：你好、你好</li>
<li>两个通信主机之间为连接 建立状态</li>
</ul>
</li>
<li>
<p>TCP – 传输控制协议（ Transmission Control Protocol ）—— ==采用网络设施的面向连接服务==</p>
<ul>
<li>Internet上 ==面向连接== 的服务</li>
<li>TCP 服务 [RFC 793]
<ul>
<li>可靠地、按顺序地传送数据
<ul>
<li>确认和重传</li>
</ul>
</li>
<li>流量控制
<ul>
<li>发送方不会淹没接收方</li>
</ul>
</li>
<li>拥塞控制
<ul>
<li>当网络拥塞时，发送方降低发送速率</li>
</ul>
</li>
</ul>
</li>
<li>使用TCP的应用：HTTP (Web), FTP (文件传 送), Telnet (远程登录), SMTP (email)</li>
</ul>
</li>
<li>
<p>UDP – 用户数据报协议 (User Datagram Protocol) [RFC 768]: —— ==采用基础设施的无连接服务==</p>
<ul>
<li>无连接</li>
<li>不可靠数据传输</li>
<li>无流量控制</li>
<li>无拥塞控制</li>
<li>使用 UDP的应用： 流媒体、远程会议、DNS、Internet电话</li>
</ul>
</li>
</ul>
<h3 id="三、网络核心">三、网络核心</h3>
<blockquote>
<ul>
<li>网络核心：电路交换</li>
<li>基本问题：数据怎样通过网络进行传输？
<ul>
<li>电路交换：为每个呼叫预留一条专有电路：如电话网</li>
<li>分组交换：
<ul>
<li>将要传送的数据分成一个个单位： 分组</li>
<li>将分组从一个路由器传到相邻路由器（hop），一段段最终从源端传到目标端</li>
<li>每段：采用链路的最大传输能力（带宽）</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="电路交换">电路交换</h4>
<h6 id="端到端的资源被分配给从源端到目标端的呼叫-“call”：">端到端的资源被分配给从源端到目标端的呼叫 “call”：</h6>
<ul>
<li>独享资源：不同享
<ul>
<li>每个呼叫一旦建立起来就能够保证性能</li>
</ul>
</li>
<li>如果呼叫没有数据发送，被分配的资源就会被浪费 (no sharing)</li>
<li>通常被传统电话网络采用</li>
</ul>
<h6 id="为呼叫预留端-端资源">为呼叫预留端-端资源</h6>
<ul>
<li>链路带宽、交换能力</li>
<li>专用资源：不共享</li>
<li>保证性能</li>
<li>要求建立呼叫连接</li>
</ul>
<h6 id="网络资源（如带宽）被分成片">网络资源（如带宽）被分成片</h6>
<ul>
<li>为呼叫分配片</li>
<li>如果某个呼叫没有数据， 则其资源片处于 ==空闲状态== （不共享）</li>
<li>将带宽分成片
<ul>
<li>频分(Frequencydivision multiplexing)</li>
<li>时分(Time-division multiplexing)</li>
<li>波分(Wave-division multiplexing)</li>
</ul>
</li>
</ul>
<h6 id="FDM-与-TDM">FDM 与 TDM</h6>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/40baf64ceb7caedee93653088beb76b8-FDM%E4%B8%8ETDM-d6fb45.png"
                      style="zoom:50%;" 
                >
<blockquote>
<h6 id="计算举例">计算举例</h6>
<p>在一个电路交换网络上，从主机A到主机B发送 一个640,000比特的文件需要多长时间？</p>
<ul>
<li>所有的链路速率为1.536 Mbps</li>
<li>每条链路使用时隙数为24的TDM</li>
<li>建立端-端的电路需500 ms</li>
</ul>
<h6 id="解：">解：</h6>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/e7017d81f60a41ba8125757e9439011d-A%E3%80%81B%E4%BC%A0%E8%BE%93%E6%97%B6%E7%A9%BA%E5%9B%BE-f94b2d.png"
                      style="zoom:50%;" 
                >
<p>每条链路的速率（一个时间片）：1.536Mbps/24 = 64kbps</p>
<p>传输时间：640kb/64kps = 10s</p>
<p>共用时间：传输时间+建立链路时间=10s + 500ms = 10.5s</p>
</blockquote>
<h6 id="电路交换不适合计算机之间的通信">==电路交换不适合计算机之间的通信==</h6>
<ul>
<li>连接建立时间长</li>
<li>计算机之间的通信有突发性，如果使用线路交换，则浪费的片较多</li>
<li>即使这个呼叫没有数据传递，其所占据的片也不能够被别的呼叫使用</li>
<li>可靠性不高？</li>
</ul>
<h4 id="分组交换">分组交换</h4>
<h6 id="以分组为单位存储-转发方式">以分组为单位存储-转发方式</h6>
<ul>
<li>
<p>网络带宽资源不再分分为一个个片，传输时使用全部带宽</p>
</li>
<li>
<p>主机之间传输的数据被分为一个个分组</p>
</li>
</ul>
<h6 id="资源共享，按需使用：">资源共享，按需使用：</h6>
<ul>
<li>存储-转发：分组每次移动一跳（ hop ）
<ul>
<li>在转发之前，节点必须收到整个分组</li>
<li>延迟比线路交换要大</li>
<li>排队时间</li>
<li>被传输到下一个链路之前， 整个分组必须到达路由器： 存储-转发</li>
<li>在一个速率为R bps的链路 ，一个长度为L bits 的分组的存储转发延时： L/R s</li>
</ul>
</li>
</ul>
<blockquote>
<h6 id="Example">Example:</h6>
<ul>
<li>
<p>L = 7.5 Mbits</p>
</li>
<li>
<p>R = 1.5 Mbps</p>
</li>
<li>
<p>3次存储转发的延时 = 15 s</p>
  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/a31e564a83999d760168193b338c79a7-%E5%88%86%E7%BB%84%E4%BC%A0%E8%BE%93-67ecea.png"
                      style="zoom:50%;" 
                >
</li>
</ul>
</blockquote>
<h6 id="排队延迟和丢失">排队延迟和丢失</h6>
<ul>
<li>排队和延迟：
<ul>
<li>如果到达速率 &gt; 链路的输出速率:
<ul>
<li>分组将会排队，等待传输</li>
<li>如果路由器的缓存用完了，分组将会被抛弃</li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 id="网络核心的关键功能">网络核心的关键功能</h6>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/804969eb85fa8f7d6c6c2c1a3104b3b4-%E7%BD%91%E7%BB%9C%E6%A0%B8%E5%BF%83%E7%9A%84%E5%85%B3%E9%94%AE%E5%8A%9F%E8%83%BD-b20b7e.png"
                      style="zoom: 80%;" 
                >
<h6 id="统计多路复用">统计多路复用</h6>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/a22599beb0ed6520b9cba73f1ded29c7-%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8-2e1166.png"
                      alt=""
                ></p>
<h4 id="分组交换-VS-电路交换">分组交换 VS 电路交换</h4>
<p>==同样的网络资源，分组交换允许更多用户使用网络！==</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/f47a07290863d108cda71da4852eec36-%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2VS%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2-73666e.png"
                      alt=""
                ></p>
<blockquote>
<h6 id="分组交换是“突发数据的胜利者？”">分组交换是“突发数据的胜利者？”</h6>
<ul>
<li>适合于对突发式数据传输
<ul>
<li>资源共享</li>
<li>简单，不必建立呼叫</li>
</ul>
</li>
<li>过度使用会造成网络拥塞：分组延时和丢失
<ul>
<li>对可靠地数据传输需要协议来约束：拥塞控制</li>
</ul>
</li>
<li>Q: 怎样提供类似电路交换的服务？
<ul>
<li>保证音频/视频应用需要的带宽</li>
<li>一个仍未解决的问题(chapter 7)</li>
<li>预约服务（线路交换）对比按需服务（分组交换）的例子?</li>
</ul>
</li>
</ul>
</blockquote>
<h6 id="分组交换网络：存储-转发">分组交换网络：存储-转发</h6>
<p>分组交换: 分组的存储转发一段一段从源端传到目标端 ，按照有无网络层的连接，分成：</p>
<ol>
<li>
<p>数据报网络：</p>
<ul>
<li>分组的目标地址决定下一跳</li>
<li>在不同的阶段，路由可以改变</li>
<li>类似：问路</li>
<li>Internent</li>
</ul>
<blockquote>
<h4 id="数据报-datagram-的工作原理">数据报(datagram) 的工作原理</h4>
<p>分组交换: 分组的存储转发一段一段从源端传到目标端 ，按照有无网络层的连接，分成：</p>
<ul>
<li>
<p>在通信之前,无须建立起一个连接,有数据就传输</p>
</li>
<li>
<p>每一个分组都独立路由(路径不一样,可能会失序)</p>
</li>
<li>
<p>路由器根据分组的目标地址进行路由</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/81a1671884fa8818388e4de4928aacf1-%E6%95%B0%E6%8D%AE%E6%8A%A5%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86-7a6062.png"
                      alt=""
                ></p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>虚电路网络：</p>
</li>
</ol>
<ul>
<li>每个分组都带标签（虚电路标识 VC ID），标签决定下一跳</li>
<li>在 ==呼叫建立时== 决定路径，在整个呼叫中路径保持不变</li>
<li>==路由器维持每个呼叫的状态信息==</li>
<li>X.25 和 ATM</li>
</ul>
<blockquote>
<h4 id="虚电路-virtual-circuit-的工作原理">虚电路(virtual circuit)的工作原理</h4>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/8530520ecec4163c470ca240617d9573-%E8%99%9A%E7%94%B5%E8%B7%AF%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86-121917.png"
                      style="zoom:50%;" 
                >
</blockquote>
<h6 id="网络分类">网络分类</h6>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/ccb7bb1e126caf746e87cfdd9c013e9b-%E7%BD%91%E7%BB%9C%E5%88%86%E7%B1%BB-3be3a2.png"
                      style="zoom:50%;" 
                >
<h3 id="四、接入网络和物理媒体">四、接入网络和物理媒体</h3>
<blockquote>
<h6 id="怎样将端系统和边缘路由器连接？">怎样将端系统和边缘路由器连接？</h6>
<ul>
<li>住宅接入网络</li>
<li>单位接入网络（学校、公 司）</li>
<li>无线接入网络</li>
</ul>
<p>==注意==：</p>
<ul>
<li>接入网络的带宽 (bits per second) ？</li>
<li>共享/专用？</li>
</ul>
</blockquote>
<h4 id="接入网">接入网</h4>
<h5 id="住宅接入：modem">住宅接入：modem</h5>
<ul>
<li>
<p>将上网数据调制加载音频信号上， 在电话线上传输，在局端将其中的数据解调出来；反之亦然</p>
<ul>
<li>调频</li>
<li>调幅</li>
<li>调相位</li>
<li>综合调制</li>
</ul>
</li>
<li>
<p>拨号调制解调器</p>
<ul>
<li>56Kbps 的速率直接接入路由器 (通常更低)</li>
<li>不能同时上网和打电话：不能总是在线</li>
</ul>
</li>
<li>
<p>digital subscriber line (DSL)</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/05367a53e1c8aa26846ad81d6805e272-DSL-883f88.png"
                      alt=""
                ></p>
<ul>
<li>采用现存的到交换局DSLAM的电话线
<ul>
<li>DSL线路上的数据被传到互联网</li>
<li>DSL线路上的语音被传到电话网</li>
</ul>
</li>
<li>&lt; 2.5 Mbps上行传输速率(typically &lt; 1 Mbps)</li>
<li>&lt; 24 Mbps下行传输速率(typically &lt; 10 Mbps)</li>
</ul>
</li>
<li>
<p>线缆网络</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/fea41b9474c2f1f3ac58691d700ad1d6-%E7%BA%BF%E7%BC%86%E7%BD%91%E7%BB%9C1-450561.png"
                      alt=""
                ></p>
<ul>
<li>有线电视信号线缆双向改造</li>
<li>FDM: 在不同频段传输不同信道的数据，数字电视和上网数据（上下行）</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/83c56321b50589e53118b4a9458c3e93-%E7%BA%BF%E7%BC%86%E7%BD%91%E7%BB%9C2-55b647.png"
                      alt=""
                ></p>
<ul>
<li>HFC: hybrid fiber coax
<ul>
<li>非对称: 最高30Mbps的下行传输速率, 2 Mbps 上行传输速率</li>
</ul>
</li>
<li>线缆和光纤网络将个家庭用户接入到 ISP 路由器</li>
<li>各用户共享到线缆头端的接入网络
<ul>
<li>与DSL不同, DSL每个用户一个专用线路到CO（centraloffice）</li>
</ul>
</li>
</ul>
</li>
<li>
<p>电缆模式</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/246be849d09bbde78c00d391a4b48fd3-%E4%BD%8F%E5%AE%85%E6%8E%A5%E5%85%A5%E7%94%B5%E7%BC%86%E6%A8%A1%E5%BC%8F-797bb4.png"
                      alt=""
                ></p>
</li>
<li>
<p>家庭网络</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/a79dacd12ef038eff6c859ae8fb06d1a-%E5%AE%B6%E5%BA%AD%E7%BD%91%E7%BB%9C-9bbca7.png"
                      alt=""
                ></p>
</li>
</ul>
<h4 id="企业接入网络-Ethernet">企业接入网络(Ethernet)</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/a956000ab9352fededdfbd4c552a46e5-%E4%BC%81%E4%B8%9A%E6%8E%A5%E5%85%A5%E7%BD%91%E7%BB%9C-54e243.png"
                      alt=""
                ></p>
<ul>
<li>经常被企业或者大学等机构采用
<ul>
<li>10 Mbps, 100Mbps, 1Gbps, 10Gbps传输率</li>
<li>现在，端系统经常直接接到以太网络交换机上</li>
</ul>
</li>
</ul>
<h4 id="无线接入网络">无线接入网络</h4>
<ul>
<li>
<p>各无线端系统共享无线接入网络（端系统到无线路由器）</p>
</li>
<li>
<p>通过基站或者叫接入点</p>
</li>
<li>
<p>无线LANs:</p>
  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/62ddd752545dfd930b608fe9bca461e8-%E6%97%A0%E7%BA%BFLANs-a23094.png"
                      style="zoom:50%;" 
                >
<p>建筑物内部 (100 ft)</p>
<ul>
<li>802.11b/g (WiFi): 11, 54 Mbps 传输速率</li>
</ul>
</li>
<li>
<p>广域无线接入</p>
  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/1bc849256b79573aabb674ec8ec1d632-%E5%B9%BF%E5%9F%9F%E6%97%A0%E7%BA%BF%E6%8E%A5%E5%85%A5-67af59.png"
                      style="zoom:50%;" 
                >
<ul>
<li>由电信运营商提供 (cellular) , 10’s km</li>
<li>1 到 10 Mbps</li>
<li>3G, 4G: LTE</li>
</ul>
</li>
</ul>
<h4 id="物理媒体">物理媒体</h4>
<ul>
<li>
<p>Bit: 在发送-接收对间传播</p>
</li>
<li>
<p>物理链路：连接每个发送-接收对之间的物理媒体</p>
</li>
<li>
<p>导引型媒体:</p>
<ul>
<li>信号沿着固体媒介被导引：同 轴电缆、光纤、双绞线</li>
</ul>
</li>
<li>
<p>非导引型媒体：</p>
<ul>
<li>开放的空间传输电磁波或者光信号，在电磁或者光信号中承载数字数据</li>
</ul>
</li>
<li>
<p>双绞线 (TP) ：两根绝缘铜导线拧合</p>
<ul>
<li>5类：100Mbps 以太网 ，Gbps 千兆位以太网</li>
<li>6类：10Gbps万兆以太网</li>
</ul>
</li>
<li>
<p>同轴电缆：</p>
<ul>
<li>两根同轴的铜导线</li>
<li>双向</li>
<li>基带电缆：
<ul>
<li>电缆上一个单个信道</li>
<li>Ethernet</li>
</ul>
</li>
<li>宽带电缆：
<ul>
<li>电缆上有多个信道</li>
<li>HFC</li>
</ul>
</li>
</ul>
</li>
<li>
<p>光纤和光缆：</p>
<ul>
<li>光脉冲，每个脉冲表示一个 bit，在玻璃纤维中传输</li>
<li>高速：
<ul>
<li>点到点的高速传输（如10 Gps-100Gbps传输速率 ）</li>
<li>低误码率：在两个中继器之 间可以有很长的距离，不受电磁噪声的干扰</li>
<li>安全</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="物理媒介：无线链路">物理媒介：无线链路</h5>
<ul>
<li>开放空间传输电磁波，携带要传输的数据
<ul>
<li>无需物理“线缆”</li>
<li>双向</li>
<li>传播环境效应：
<ul>
<li>反射</li>
<li>吸收</li>
<li>干扰</li>
</ul>
</li>
</ul>
</li>
<li>无线链路类型:
<ul>
<li>地面微波
<ul>
<li>e.g. up to 45 Mbps channels</li>
</ul>
</li>
<li>LAN (e.g., WiFi)
<ul>
<li>11Mbps, 54 Mbps,540Mbps…</li>
</ul>
</li>
<li>wide-area (e.g., 蜂窝)
<ul>
<li>3G cellular: ~ 几Mbps</li>
<li>4G 10Mbps</li>
<li>5G 数Gbps</li>
</ul>
</li>
<li>卫星
<ul>
<li>每个信道Kbps 到45Mbps (或者 多个聚集信道)</li>
<li>270 msec端到端延迟</li>
<li>同步静止卫星和低轨卫星</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="五、Internet-结构和-ISP">五、Internet 结构和 ISP</h3>
<h4 id="网络的网络">网络的网络</h4>
<ul>
<li>端系统通过 接入==ISPs==  (Internet Service Providers)连接到互联网
<ul>
<li>住宅，公司和大学的ISPs</li>
</ul>
</li>
<li>接入ISPs相应的必须是互联的
<ul>
<li>因此任何2个端系统可相互发送分组到对方</li>
</ul>
</li>
<li>导致的“网络的网络”非常复杂
<ul>
<li>发展和演化是通过 ==经济的和国家的== 政策来驱动的</li>
</ul>
</li>
<li>让我们采用渐进方法来描述当前互联网的结构</li>
</ul>
<blockquote>
<h6 id="给定数百万接入ISPs，如何将它们互联到一起">给定数百万接入ISPs，如何将它们互联到一起</h6>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/b3493de70bd9c38d91ab83f8bb19b299-ISPs%E8%BF%9E%E6%8E%A5-cab974.png"
                      style="zoom:50%;" 
                >
</blockquote>
<ul>
<li>==global ISP==</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/118ff7874567d64655d3f6a821882b5b-global%20ISP-bd0a42.png"
                      style="zoom:50%;" 
                >
<ul>
<li>global ISP 竞争
<ul>
<li>但是，如果全局ISP是可行的业务，那会有竞争者 有利可图，一定会有竞争</li>
</ul>
</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/660fe7293d2ada930b9ada4ea6f65e9c-global%20ISP%E7%AB%9E%E4%BA%89-f0ed49.png"
                      style="zoom:50%;" 
                >
<ul>
<li>global ISP 合作
<ul>
<li>竞争：但如果全局ISP是有利可为的业务，那会有竞争者</li>
<li>合作：通过ISP之间的合作可以完成业务的扩展，肯定会有互联，对等互联的结算关系</li>
</ul>
</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/0adb5c59464b40e967f6d595f1222476-global%20ISP%E5%90%88%E4%BD%9C-ff3cee.png"
                      style="zoom:50%;" 
                >
<ul>
<li>
<p>…然后业务会细分（全球接入和区域接入），区域网络将出现，用与将接入ISPs连接到全局ISPs</p>
  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/d34f015b245c8b38a129599e5f04e1fd-global%20ISP%E4%B8%9A%E5%8A%A1%E7%BB%86%E5%88%86-248a40.png"
                      style="zoom:50%;" 
                >
</li>
<li>
<p>然后内容提供商网络 (Internet Content Providers,e.g., Google, Microsoft, Akamai) 可能会构建它们自己的网络，将它们的服务、内容更加靠近端用户，向用户提供更好的服务,减少自己的运营支出</p>
  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/f57d5a250b2b5e3c3ca0329f8c545291-content%20provider%20network-800e4c.png"
                      style="zoom:50%;" 
                >
</li>
<li>
<p>在网络的最中心，一些为数不多的充分连接的大范围网络（分布广、节点有限、 但是之间有着多重连接）</p>
<ul>
<li>==“tier-1” commercial ISPs== (e.g., Level 3, Sprint, AT&amp;T, NTT), 国家或者国际范围的覆盖</li>
<li>==content provider network== (e.g., Google): 将它们的数据中心接入ISP，方便周边 用户的访问；通常私有网络之间用专网绕过第一层ISP和区域ISPs</li>
</ul>
</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/843d49654b3f7bd3983dd37fac0e7183-Tier1%20ISP-ef58ec.png"
                      style="zoom:50%;" 
                >
<h4 id="network-of-networks">network of networks</h4>
<ul>
<li>松散的层次模型</li>
<li>中心：第一层ISP（如UUNet, BBN/Genuity, Sprint, AT&amp;T）国家/国际覆盖，速率极高
<ul>
<li>直接与其他第一层ISP相连</li>
<li>与大量的第二层ISP和其他客户网络相连</li>
</ul>
</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/9706786420bba6392f569d5f9f7528b4-%E7%AC%AC%E4%B8%80%E5%B1%82ISP-e6944e.png"
                      style="zoom:50%;" 
                >
<ul>
<li>第二层ISP: 更小些的 (通常是区域性的) ISP
<ul>
<li>与一个或多个第一层ISPs，也可能与其他第二层ISP</li>
</ul>
</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/224e6c52a1d055cfceb7a4e52ba6a51e-%E7%AC%AC%E4%BA%8C%E5%B1%82ISP-80064e.png"
                      style="zoom:50%;" 
                >
<ul>
<li>第三层ISP与其他本地ISP
<ul>
<li>接入网 (与端系统最近)</li>
</ul>
</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/9ad3923e87f792b4ef4a292eae60c127-%E7%AC%AC%E4%B8%89%E5%B1%82ISP-38b779.png"
                      style="zoom:50%;" 
                >
<blockquote>
<h5 id="一个分组要经过许多网络！">一个分组要经过许多网络！</h5>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/28727b6307d325e0b03ddc9d9702aa0e-%E4%B8%80%E4%B8%AA%E5%88%86%E7%BB%84%E8%A6%81%E7%BB%8F%E8%BF%87%E8%AE%B8%E5%A4%9A%E7%BD%91%E7%BB%9C-bf4232.png"
                      style="zoom:50%;" 
                >
</blockquote>
<ul>
<li>
<p>很多内容提供商(如：Google, Akamai )可能会部署自己的网络,连接自己的在各地的DC（数据中心），走自己的数据</p>
</li>
<li>
<p>连接若干local ISP和各级（包括一层）ISP,更加靠近用户</p>
<ul>
<li>经济考虑：少付费</li>
<li>用户考虑：更快</li>
</ul>
  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/f57d5a250b2b5e3c3ca0329f8c545291-content%20provider%20network-800e4c.png"
                      style="zoom:50%;" 
                >
</li>
</ul>
<h4 id="ISP之间的连接">ISP之间的连接</h4>
<ul>
<li>POP: 高层ISP面向客户网络的接入点，涉及费用结算
<ul>
<li>如一个低层ISP接入多个高层ISP，多宿（multi home）</li>
</ul>
</li>
<li>对等接入：2个ISP对等互接，不涉及费用结算</li>
<li>IXP：多个对等ISP互联互通之处，通常不涉及费用结算
<ul>
<li>对等接入</li>
</ul>
</li>
<li>ICP自己部署专用网络，同时和各级ISP连接</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/843d49654b3f7bd3983dd37fac0e7183-Tier1%20ISP-ef58ec.png"
                      style="zoom:50%;" 
                >
<h3 id="六、分组延时、丢失和吞吐量">六、分组延时、丢失和吞吐量</h3>
<blockquote>
<h6 id="分组丢失和延时是怎样发生的？">分组丢失和延时是怎样发生的？</h6>
<p>在路由器缓冲区的分组队列</p>
<ul>
<li>分组到达链路的速率超过了链路输出的能力</li>
<li>分组等待排到队头、被传输</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/bde14051e34a1a458ec5dad11f577ae4-%E5%88%86%E7%BB%84%E4%B8%A2%E5%A4%B1%E5%92%8C%E5%BB%B6%E6%97%B6%E7%9A%84%E5%8F%91%E7%94%9F-0700d5.png"
                      style="zoom:50%;" 
                >
</blockquote>
<h4 id="四种分组延时">四种分组延时</h4>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/14cc51c9ffb38ebb2e015bd95b1a8cb9-%E5%88%86%E7%BB%84%E5%BB%B6%E6%97%B6-4be226.png"
                      style="zoom: 80%;" 
                >
<ol>
<li>节点处理延时：</li>
</ol>
<ul>
<li>检查 bit 级差错</li>
<li>检查分组首部和决定将分组导向何处</li>
</ul>
<ol start="2">
<li>排队延时</li>
</ol>
<ul>
<li>在输出链路上等待传输的时间</li>
<li>依赖于路由器的拥塞程度</li>
</ul>
<ol start="3">
<li>传输延时:</li>
</ol>
<ul>
<li>R=链路带宽(bps)</li>
<li>L=分组长度(bits)</li>
<li>将分组发送到链路上的 时间 = L/R</li>
<li>存储转发延时</li>
</ul>
<ol start="4">
<li>传播延时:</li>
</ol>
<ul>
<li>d = 物理链路的长度</li>
<li>s = 在媒体上的传播速度 (~2x108 m/sec)</li>
<li>传播延时 = d/s</li>
</ul>
<p>==在整个分组被第一个路由器传输之前，第一个比特已经到达了第二个路由器！==</p>
<h4 id="节点延时">节点延时</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/6ecba6eaa1ae3a8eb0b29dc9ef33c2e7-%E8%8A%82%E7%82%B9%E5%BB%B6%E6%97%B6-58025c.png"
                      alt=""
                ></p>
<ul>
<li>dproc = 处理延时：通常是微秒数量级或更少</li>
<li>dqueue = 排队延时：取决于拥塞程度</li>
<li>dtrans = 传输延时：= L/R, 对低速率的链路而言很大（如拨号），通常为微秒级到毫秒级</li>
<li>dprop = 传播延时：几微秒到几百毫秒</li>
</ul>
<h4 id="排队延时">排队延时</h4>
<ul>
<li>
<p>R=链路带宽 (bps)</p>
</li>
<li>
<p>L=分组长度 (bits)</p>
</li>
<li>
<p>a=分组到达队列的平均速率</p>
<p>==流量强度 = La/R==</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/9b03b10c92447ecf46ad0c4327d2cc24-%E6%8E%92%E9%98%9F%E5%BB%B6%E6%97%B6-22d8fe.png"
                      alt=""
                ></p>
</li>
<li>
<p>La/R ~ 0: 平均排队延时很小</p>
</li>
<li>
<p>La/R -&gt;1: 延时变得很大</p>
</li>
<li>
<p>La/R &gt; 1: 比特到达队列的速率超过了从该队列输出的速率，平均排队延时将趋向无穷大！</p>
</li>
</ul>
<p>==设计系统时流量强度不能大于1！==</p>
<h4 id="Internet的延时和路由">Internet的延时和路由</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/6861ad489d33acf2e143fcceffa95a88-Internet%E5%BB%B6%E6%97%B6%E5%92%8C%E8%B7%AF%E7%94%B1-121969.png"
                      alt=""
                ></p>
<p>Traceroute 诊断程序: 提供从源端，经过路由器，到目的的延时测量</p>
<ul>
<li>For all i:
<ul>
<li>沿着目的的路径，向每个路由器发送3个探测分组</li>
<li>路由器 i 将向发送方返回一个分组</li>
<li>发送方对发送和回复之间间隔计时</li>
</ul>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/cc68109aefc8457c1b7cdd8bf0f5c8dc-traceroute-c5a016.png"
                      alt=""
                ></p>
<blockquote>
<ul>
<li>
<p>在Windows系统下</p>
<ul>
<li>
<p>Tracerert hostname</p>
<ul>
<li>如 Tracerert <a class="link"   target="_blank" rel="noopener" href="http://www.gucas.ac.cn" >www.gucas.ac.cn <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
</ul>
</li>
<li>
<p>更完整的例子</p>
<ul>
<li>
<p>tracert [-d] [-h maximum_hops] [-j computer-list] [-w timeout] target_name</p>
</li>
<li>
<p>请见帮助：<a class="link"   target="_blank" rel="noopener" href="http://www.linkwan.com/gb/broadmeter/article/trace" >http://www.linkwan.com/gb/broadmeter/article/trace <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> -help.htm</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>means no reponse (probe lost, router not replying)</li>
<li>测试网址：
<ul>
<li><a class="link"   target="_blank" rel="noopener" href="http://www.traceroute.org" >www.traceroute.org <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="http://www.linkwan.com" >www.linkwan.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="分组丢失">分组丢失</h4>
<ul>
<li>链路的队列缓冲区容量有限</li>
<li>当分组到达一个满的队列时，该分组将会丢失</li>
<li>丢失的分组可能会被 ==前一个节点== 或 ==源端系统== 重传，或 ==根本不重传==</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/814ee0d9717f1255c93b12ab7215c9b6-%E5%88%86%E7%BB%84%E4%B8%A2%E5%A4%B1-8a32a3.png"
                      style="zoom:50%;" 
                >
<h4 id="吞吐量">吞吐量</h4>
<ul>
<li>吞吐量: 在源端和目标端之间传输的速率（数 据量/单位时间）
<ul>
<li>瞬间吞吐量: 在一个时间点的速率</li>
<li>平均吞吐量: 在一个长时间内平均值</li>
</ul>
</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/e8a6326df8a67af238121b69903ad057-%E5%90%9E%E5%90%90%E9%87%8F-d60115.png"
                      style="zoom:50%;" 
                >
<blockquote>
<p>Rs &lt; Rc 端到端平均吞吐是多少?</p>
<p>Rs &gt; Rc 端到端平均吞吐是多少?</p>
<p>==瓶颈链路：端到端路径上，限制端到端吞吐的链路==</p>
<p>==其他节点都不传输，吞吐量 min{Rs,Rc}==</p>
<p>==端到端平均吞吐=min{R1，R2,…,Rn}==</p>
</blockquote>
<h4 id="吞吐量：互联网场景">吞吐量：互联网场景</h4>
<blockquote>
<h6 id="链路上的每一段实际可用带宽Ri’">链路上的每一段实际可用带宽Ri’=?</h6>
<ul>
<li>
<p>端到端吞吐量： min{Ri’}</p>
</li>
<li>
<p>每个连接上的端到 端吞吐: min(Rc,Rs,R/10)</p>
</li>
<li>
<p>实际上: Rc 或者 Rs 经常是瓶颈</p>
  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/433b05a033f7e23992cf0ed9a8355ec4-%E4%BA%92%E8%81%94%E7%BD%91%E5%9C%BA%E6%99%AF-5d2b33.png"
                      style="zoom:50%;" 
                >
</li>
</ul>
</blockquote>
<h3 id="七、协议层次及服务模型">七、协议层次及服务模型</h3>
<blockquote>
<p>==网络是一个复杂的系统!==</p>
<ul>
<li>网络功能繁杂：数字信号的物理信号承载、点到点、路由、rdt、进 程区分、应用等</li>
<li>现实来看，网络的许多构成元素和设备:
<ul>
<li>主机、路由器、各种媒体的链路、应用、协议、硬件、软件</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="层次化方式实现复杂网络功能">层次化方式实现复杂网络功能:</h4>
<ul>
<li>将网络复杂的功能分层功能明确的 ==层次==，每一层实现了其中一个或一组 ==功能==，功能中有其上层可以使用的功能： ==服务==</li>
<li>本层协议实体相互交互执行本层的 ==协议动作==，目的是实现本层功能， 通过接口为上层提供更好的服务</li>
<li>在实现本层协议的时候，直接 ==利用了下层所提供的服务==</li>
<li>本层的服务：借助下层服务实现的本层协议实体之间交互带来的新功能（上层可以利用的）+ 更下层所提供的服务</li>
</ul>
<h6 id="服务和服务访问点">服务和服务访问点</h6>
<ul>
<li>服务( Service)：低层实体向上层实体提供它们之间的通信的能力
<ul>
<li>服务用户(service user)</li>
<li>服务提供者(service provider )</li>
</ul>
</li>
<li>原语(primitive)：上层使用下层服务的形式，高层使用低层提供的服务，以及低层向高层提供服务都是通过服务访问原语来进行交互的—形式</li>
<li>服务访问点SAP (Services Access Point) ：上层使用下层提供的服务通过层间的接口—地点；
<ul>
<li>例子:邮箱</li>
<li>地址(address)：下层的一个实体支撑着上层的多个实体， SAP有标志不同上层实体的作用</li>
<li>可以有不同的实现，队列</li>
<li>例子:传输层的SAP: 端口(port)</li>
</ul>
</li>
</ul>
<h6 id="服务类型">服务类型</h6>
<ul>
<li>面向连接的服务和无连接的服务-方式
<ul>
<li>面向连接的服务( Connection-oriented Service)
<ul>
<li>连接(Connection)：两个通信实体为进行通信而建立的一种结合</li>
<li>面向连接的服务通信的过程：建立连接，通信，拆除连接</li>
<li>面向连接的服务的例子：网络层的连接被成为虚电路</li>
<li>适用范围：对于大的数据块要传输; 不适合小的零星报文</li>
<li>特点：保序</li>
<li>服务类型:
<ul>
<li>可靠的信息流 传送页面(可靠的获得,通过接收方的确认)</li>
<li>可靠的字节流 远程登录</li>
<li>不可靠的连接 数字化声音</li>
</ul>
</li>
</ul>
</li>
<li>无连接的服务(Connectionless Service)
<ul>
<li>无连接服务：两个对等层实体在通信前不需要建立一个连接，不预留资源；不需要通信双方都是活跃；(例：寄信)</li>
<li>特点：不可靠、可能重复、可能失序</li>
<li>IP分组，数据包；</li>
<li>适用范围：适合传送零星数据；</li>
<li>服务类型：
<ul>
<li>不可靠的数据报电子方式的函件</li>
<li>有确认的数据报挂号信</li>
<li>请求回答信息查询</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 id="服务和协议">服务和协议</h6>
<ul>
<li>服务与协议的区别
<ul>
<li>服务(Service)：低层实体向上层实体提供它们之间的通信的能力，是通过原语(primitive)来操作的，垂直</li>
<li>协议(protocol) ：对等层实体(peer entity)之间在相互通信的过程中，需要遵循的规则的集合，水平</li>
</ul>
</li>
<li>服务与协议的联系
<ul>
<li>本层 ==协议的实现== 要靠下层提供的服务来实现</li>
<li>本层实体通过协议为上层 ==提供更高级的服务==</li>
</ul>
</li>
</ul>
<h6 id="数据单元-DU">数据单元(DU)</h6>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/4e5e984ee1bd44eee71c2f22f6ef7a18-DU-24c02f.png"
                      style="zoom:50%;" 
                >
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/a5f909c9aeead24ae7be0620bdf084d2-%E5%8D%8F%E8%AE%AE%E5%92%8C%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%85%B3%E7%B3%BB-796b3d.png"
                      style="zoom: 80%;" 
                >
<h6 id="分层处理和实现复杂系统的好处？">分层处理和实现复杂系统的好处？</h6>
<p>==对付复杂的系统==</p>
<ul>
<li>概念化：结构清晰，便于标示网络组件，以及描述其相互关系
<ul>
<li>分层参考模型</li>
</ul>
</li>
<li>结构化：模块化更易于维护和系统升级
<ul>
<li>改变某一层服务的实现不影响系统中的其他层次
<ul>
<li>对于其他层次而言是透明的</li>
</ul>
</li>
<li>如改变登机程序并不影响系统的其它部分
<ul>
<li>改变2个秘书使用的通信方式不影响2个翻译的工作</li>
<li>改变2个翻译使用的语言也不影响上下2个层次的工作</li>
</ul>
</li>
</ul>
</li>
<li>分层思想被认为有害的地方？
<ul>
<li>效率相对低</li>
</ul>
</li>
</ul>
<h6 id="Internet-协议栈">Internet 协议栈</h6>
<ul>
<li>应用层: 网络应用
<ul>
<li>为人类用户或者其他应用进程提供网络应用服务</li>
<li>FTP, SMTP, HTTP,DNS</li>
</ul>
</li>
<li>传输层: 主机之间的数据传输
<ul>
<li>在网络层提供的端到端通信基础上，细分为进程到进程，将不可靠的通信变成可靠地通信</li>
<li>TCP, UDP</li>
</ul>
</li>
<li>网络层: 为数据报从源到目的选择路由
<ul>
<li>主机主机之间的通信，端到端通信，不可靠</li>
<li>IP, 路由协议</li>
</ul>
</li>
<li>链路层: 相邻网络节点间的数据传输
<ul>
<li>2个相邻2点的通信，点到点通信，可靠或不可靠</li>
<li>点对对协议PPP, 802.11(wifi), Ethernet</li>
</ul>
</li>
<li>物理层: 在线路上传送 bit</li>
</ul>
<h6 id="ISO-OSI-参考模型">ISO/OSI 参考模型</h6>
<ul>
<li>表示层: 允许应用解释传输的 数据, e.g., 加密，压缩，机 器相关的表示转换</li>
<li>会话层: 数据交换的同步，检 查点，恢复</li>
<li>互联网协议栈没有这两层!
<ul>
<li>这些服务，如果需要的话，必须被应用实现</li>
<li>需要吗?</li>
</ul>
</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/e3fbdb1a317e13fdc5a8e20ceadfa4d3-ISO%E3%80%81OSI%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-0d60e3.png"
                      style="zoom:50%;" 
                >
<h6 id="封装和解封装">封装和解封装</h6>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/2c0630c862c5b5e26a7ddc7689aca7dc-%E5%B0%81%E8%A3%85%E5%92%8C%E8%A7%A3%E5%B0%81%E8%A3%85-fe38be.png"
                      alt=""
                ></p>
<h6 id="各层次的协议数据单元">各层次的协议数据单元</h6>
<ul>
<li>应用层：报文(message)</li>
<li>传输层：报文段(segment)：TCP段，UDP数据报</li>
<li>网络层：分组packet（如果无连接方式：数据报 datagram）</li>
<li>数据链路层：帧(frame)</li>
<li>物理层：位(bit)</li>
</ul>
<h3 id="八、历史">八、历史</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/ca9ab96c7679422fcfa9f064cec05722-%E5%8E%86%E5%8F%B2-127d2c.png"
                      alt=""
                ></p>
<h6 id="早期（1960以前）计算机网络">早期（1960以前）计算机网络</h6>
<ul>
<li>线路交换网络</li>
<li>线路交换的特性使得其不适合计算机之间的通信
<ul>
<li>线路建立时间过长</li>
<li>独享方式占用通信资源，不适合突发性很强的计算机之间的通信</li>
<li>可靠性不高：非常不适合军事通信</li>
</ul>
</li>
<li>三个小组独立地开展分组交换的研究
<ul>
<li>1961: Kleinrock(MIT)，排队论，展现了分组交换的有效性</li>
<li>1964: Baran(美国兰德公司) – 军用网络上的分组交换</li>
<li>1964：Donald（英国）等，NPL</li>
</ul>
</li>
</ul>
<h6 id="1961-1972-早期的分组交换概念">1961-1972: 早期的分组交换概念</h6>
<ul>
<li>1967: 美国高级研究计划研究局考虑ARPAne
<ul>
<li>Kleinrock在MIT的同事</li>
</ul>
</li>
<li>1969: 第一个 ARPAnet 节点开始工作,UCLA
<ul>
<li>IMP:接口报文处理机</li>
</ul>
</li>
<li>1969年底: 4个节点</li>
<li>1972:
<ul>
<li>ARPAnet 公众演示</li>
<li>网络控制协议是第一个端 系统直接的主机-主机协议
<ul>
<li>NCP协议：相当于传输层和网络层在一起，支持应用开发</li>
</ul>
</li>
<li>第一个e-mail 程序（BBN）</li>
<li>ARPAnet有15个节点</li>
</ul>
</li>
</ul>
<h6 id="1972-1980-专用网络和网络互联">1972-1980: 专用网络和网络互联</h6>
<ul>
<li>出现了很多对以后来说重要的网络形式， 雨后春笋
<ul>
<li>1970: ALOHAnet,夏威夷上的微波网络</li>
<li>1973: Metcalfe在博士论文中提出了 Ethernet</li>
<li>ATM网络
<ul>
<li>ALOHAnet，Telenet，Cyclades法国等</li>
</ul>
</li>
</ul>
</li>
<li>1970后期，网络体系结构的必要性
<ul>
<li>专用的体系结构： DECnet, SNA, XNA</li>
<li>标准化的体系结构</li>
</ul>
</li>
<li>1974: 网际互联的Cerf and Kahn 体系结构</li>
<li>1979: ARPAnet的规模在持续增加，体系结构也在酝酿着变化，以支持网络互联和其他目的（性能）需求
<ul>
<li>节点数目增加，有200个节点</li>
</ul>
</li>
</ul>
<blockquote>
<h5 id="Cerf-and-Kahn-网络互联原则">Cerf and Kahn 网络互联原则:</h5>
<ul>
<li>极简、自治</li>
<li>尽力而为（best effort）服务模型</li>
<li>无状态的路由器</li>
<li>分布控制</li>
</ul>
<p>==定义了今天的 Internet 体系结构==</p>
</blockquote>
<h6 id="1980-1990：体系结构变化，网络数量激增，应用丰富">1980-1990：体系结构变化，网络数量激增，应用丰富</h6>
<ul>
<li>1983: TCP/IP部署，标记日
<ul>
<li>NCP分化成2个层次，TCP/IP， 从而出现UDP</li>
<li>覆盖式IP解决网络互联问题</li>
<li>主机设备和网络交换设备分开</li>
</ul>
</li>
<li>1982: smtp e-mail协议定义  1983: DNS 定义，完成域名到IP地址的转换</li>
<li>1985: ftp 协议定义</li>
<li>1988: TCP拥塞控制</li>
<li>其他网络形式的发展
<ul>
<li>新的国家级网络: Csnet, BITnet, NSFnet, Minitel</li>
<li>1985年：ISO/OSI提出， 时机不对且太繁琐</li>
</ul>
</li>
<li>100,000主机连接到网络联邦</li>
</ul>
<h6 id="1990-2000’s-商业化-Web-新的应用">1990, 2000’s: 商业化, Web, 新的应用</h6>
<ul>
<li>1990年代初: NSF对ARPAnet 的访问网，双主干，ARPAnet退役</li>
<li>1991: NSF放宽了对NSFnet用于商业目的的限制 (1995退役)， ASFNET非盈利性机构维护，后面叫Internet</li>
<li>UNIX 中TCP/IP的 ==免费捆绑==</li>
<li>1990年代初: Web
<ul>
<li>hypertext [Bush 1945, Nelson 1960’s]</li>
<li>HTML, HTTP: Berners-Lee</li>
<li>1994: Mosaic (Netscape， andreesen)</li>
<li>1990年代后期: Web的商业化</li>
</ul>
</li>
</ul>
<h6 id="1990后期-–-21世纪">1990后期 – 21世纪:</h6>
<ul>
<li>TCP/IP体系结构的 ==包容性==，在其上部署应用便捷，出现非常多的应用</li>
<li>新一代 ==杀手级应用==（即时讯息 ，P2P 文件共享，社交网络等 ）更进一步促进互联网的发展</li>
<li>安全问题不断出现和修订（互 联网的 ==补丁对策==）</li>
<li>2001网络泡沫，使得一些好公司沉淀下来（谷歌，微软，苹果，Yahoo，思科）</li>
<li>主干网的速率达到Gbps</li>
</ul>
<h6 id="2005-现在">2005-现在</h6>
<ul>
<li>~50+亿主机：包括智能手机和平板</li>
<li>宽带接入的快速部署</li>
<li>高速无线接入无处不在：移动互联时代
<ul>
<li>4G部署,5G蓄势待发</li>
<li>带宽大，终端性能高，价格便宜，应用不断增多</li>
</ul>
</li>
<li>在线社交网络等新型应用的出现:
<ul>
<li>Facebook: 10亿用户</li>
<li>微信，qq：数十亿用户</li>
</ul>
</li>
<li>内容提供商 (Google, Microsoft)创建他们自己的网络
<ul>
<li>通过自己的专用网络提供对搜索、视频内容和电子邮件的即刻访问</li>
</ul>
</li>
<li>电子商务，大学，企业在云中运行他们的服务 (eg, Amazon EC2)</li>
<li>体系结构酝酿着大的变化，未来网络蠢蠢欲动</li>
</ul>
<h3 id="九、小结">九、小结</h3>
<ul>
<li>组成角度看什么是互联网
<ul>
<li>边缘：端系统（包括应用）+ 接入网</li>
<li>核心：网络交换设备+通信链路</li>
<li>协议：对等层实体通信过程中遵守的规则的集合
<ul>
<li>语法，语义，时序</li>
</ul>
</li>
</ul>
</li>
<li>为了实现复杂的网络功能，采用分层方式设计、实现和调试
<ul>
<li>应用层，传输层，网络层，数据链路层，物理层</li>
<li>协议数据单位：
<ul>
<li>报文，报文段，分组，帧，位</li>
</ul>
</li>
</ul>
</li>
<li>从服务角度看互联网
<ul>
<li>通信服务基础设施
<ul>
<li>提供的通信服务：面向连接 无连接</li>
</ul>
</li>
<li>应用</li>
</ul>
</li>
<li>应用之间的交互
<ul>
<li>C/S模式</li>
<li>P2P模式</li>
</ul>
</li>
<li>数据交换
<ul>
<li>分组数据交换</li>
<li>线路交换</li>
</ul>
</li>
<li>比较线路交换和分组交换</li>
<li>分组交换的2种方式
<ul>
<li>虚电路</li>
<li>数据报</li>
</ul>
</li>
<li>接入网和物理媒介
<ul>
<li>接入网技术：
<ul>
<li>住宅：ADSL，拨号，cable modem</li>
<li>单位：以太网</li>
<li>无线接入方式</li>
</ul>
</li>
<li>物理媒介
<ul>
<li>光纤，同轴电缆，以太网，双绞线</li>
</ul>
</li>
</ul>
</li>
<li>ISP层次结构</li>
<li>分组交换网络中延迟和丢失是如何发生的
<ul>
<li>延迟的组成：处理、传输、传播、排队</li>
</ul>
</li>
<li>网络的分层体系结构
<ul>
<li>分层体系结构</li>
<li>服务</li>
<li>协议数据单元</li>
<li>封装与解封装</li>
</ul>
</li>
<li>历史</li>
</ul>
<h2 id="第二章-应用层">第二章 应用层</h2>
<h3 id="一、应用层协议原理">一、应用层协议原理</h3>
<ul>
<li>网络应用的原理：网络应用协议的概念和实现方面
<ul>
<li>传输层的服务模型</li>
<li>客户-服务器模式</li>
<li>对等模式(peerto-peer)</li>
<li>内容分发网络</li>
<li>网络应用的实例：互联网流行的应用层协议
<ul>
<li>HTTP</li>
<li>FTP</li>
<li>SMTP / POP3 / IMAP</li>
<li>DNS</li>
</ul>
</li>
<li>编程：网络应用程序
<ul>
<li>Socket API</li>
</ul>
</li>
</ul>
</li>
<li>一些网络应用的例子
<ul>
<li>E-mail、Web、文本消息、远程登录、P2P文件共享、即时通信、多用户网络游戏、流媒体(YouTube, Hulu, Netflix)、Internet 电话、实时电视会议、社交网络、搜索、……</li>
</ul>
</li>
<li>创建一个新的网络应用
<ul>
<li>编程
<ul>
<li>在不同的端系统上运行</li>
<li>通过网络基础设施提供的服务，应用进程彼此通信</li>
<li>如Web: Web 服务器软件与浏览器软件通信</li>
</ul>
</li>
<li>网络核心中没有应用层软件
<ul>
<li>网络核心没有应用层功能</li>
<li>网络应用只在端系统上存在，快速网络应用开发和部署</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="网络应用的体系结构">网络应用的体系结构</h4>
<ul>
<li>可能的应用架构：
<ul>
<li>客户-服务器模式（C/S:client/server）</li>
<li>对等模式(P2P:Peer To Peer)</li>
<li>混合体：客户-服务器和对等体系结构</li>
</ul>
</li>
</ul>
<h6 id="客户-服务器（C-S）体系结构">客户-服务器（C/S）体系结构</h6>
<ul>
<li>服务器:
<ul>
<li>一直运行</li>
<li>固定的IP地址和周知的端口号（约定）</li>
<li>扩展性：服务器场
<ul>
<li>数据中心进行扩展</li>
<li>==扩展性差==</li>
</ul>
</li>
<li>客户端:
<ul>
<li>主动与服务器通信</li>
<li>与互联网有间歇性的连接</li>
<li>可能是动态IP地址</li>
<li>不直接与其它客户端通信</li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 id="对等体（P2P）体系结构">对等体（P2P）体系结构</h6>
<ul>
<li>（几乎）没有一直运行的服务器</li>
<li>任意端系统之间可以进行通信</li>
<li>每一个节点既是客户端又是服务器
<ul>
<li>自扩展性-新peer节点带来新的服务能力，当然也带来新的服务请求</li>
</ul>
</li>
<li>参与的主机间歇性连接且可以改变 IP 地址
<ul>
<li>难以管理</li>
</ul>
</li>
<li>例子: Gnutella，迅雷</li>
</ul>
<h6 id="C-S和P2P体系结构的混合体">C/S和P2P体系结构的混合体</h6>
<ul>
<li>Napster
<ul>
<li>文件搜索：集中
<ul>
<li>主机在中心服务器上注册其资源</li>
<li>主机向中心服务器查询资源位置</li>
</ul>
</li>
<li>文件传输：P2P
<ul>
<li>任意Peer节点之间</li>
</ul>
</li>
</ul>
</li>
<li>即时通信
<ul>
<li>在线检测：集中
<ul>
<li>当用户上线时，向中心服务器注册其IP地址</li>
<li>用户与中心服务器联系，以找到其在线好友的位置</li>
</ul>
</li>
<li>两个用户之间聊天：P2P</li>
</ul>
</li>
</ul>
<h4 id="进程通信">进程通信</h4>
<blockquote>
<p>进程：在主机上运行的应用程序</p>
<ul>
<li>
<p>客户端进程（clients）：发起通信的进程</p>
</li>
<li>
<p>服务器进程（servers ）：等待连接的进程</p>
</li>
</ul>
</blockquote>
<ul>
<li>在同一个主机内，使用进程间通信机制通信（ 操作系统定义）</li>
<li>不同主机，通过交换报文（Message）来通信
<ul>
<li>使用OS提供的通信服 务</li>
<li>按照应用协议交换报文
<ul>
<li>借助传输层提供的服务</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>==注意：P2P架构的应用也有客户端进程和服务器进程之分==</p>
<h4 id="分布式进程通信需要解决的问题">分布式进程通信需要解决的问题</h4>
<ul>
<li>问题1：进程标示和寻址问题（服务用户）</li>
<li>问题2：传输层-应用层提供服务是如何（服务）
<ul>
<li>位置：层间界面的SAP （TCP/IP ：socket）</li>
<li>形式：应用程序接口API （TCP/IP ：socket API）</li>
</ul>
</li>
<li>问题3：如何使用传输层提供的服务，实现应用进程之间的报文交换，实现应用（用户使用服务）
<ul>
<li>定义应用层协议：报文格式，解释，时序等</li>
<li>编制程序，使用OS提供的API ，调用网络基础设施提供通信服务传报文，实现应用时序等</li>
</ul>
</li>
</ul>
<h5 id="问题1：对进程进行编址（addressing）">问题1：对进程进行编址（addressing）</h5>
<ul>
<li>
<p>进程为了接收报文，必须有一个标识</p>
<p>即：SAP（发送也需要标示）</p>
<ul>
<li>主机：唯一的 32 位IP地址
<ul>
<li>仅仅有IP地址不能够唯一标示一个进程；在一台端系统上有很多应用进程在运行</li>
</ul>
</li>
<li>所采用的传输层协议：TCP or UDP</li>
<li>==端口号==（Port Numbers）</li>
</ul>
</li>
<li>
<p>一些知名端口号的例子：</p>
<ul>
<li>HTTP: TCP 80 Mail: TCP25 ftp:TCP 2</li>
</ul>
</li>
<li>
<p>一个进程：用 ==IP+port== 标示 端节点</p>
</li>
<li>
<p>本质上，一对主机进程之间的通信由2个端节点构成</p>
</li>
</ul>
<h5 id="问题2：传输层提供的服务">问题2：传输层提供的服务</h5>
<p>==需要穿过层间的信息==</p>
<ul>
<li>层间接口必须要携带的信息
<ul>
<li>要传输的报文（对于本层来说：SDU）</li>
<li>谁传的：对方的应用进程的标示：IP+TCP(UDP) 端口</li>
<li>传给谁：对方的应用进程的标示：对方的IP+TCP(UDP)端口号</li>
</ul>
</li>
<li>传输层实体（tcp或者udp实体）根据这些信息进行TCP报文段（UDP数据报）的封装
<ul>
<li>源端口号，目标端口号，数据等</li>
<li>将IP地址往下交IP实体，用于封装IP数据报：源IP,目标IP</li>
</ul>
</li>
</ul>
<p>==层间信息的代表==</p>
<ul>
<li>
<p>如果Socket API 每次传输报文，都携带如此多的信息，太繁琐易错，不便于管理</p>
</li>
<li>
<p>用个代号标示通信的双方或者单方：socket</p>
</li>
<li>
<p>就像OS打开文件返回的句柄一样</p>
<ul>
<li>对句柄的操作，就是对文件的操作</li>
</ul>
</li>
<li>
<p>TCP socket：</p>
<ul>
<li>TCP服务，两个进程之间的通信需要之前要建立连接
<ul>
<li>两个进程通信会持续一段时间，通信关系稳定</li>
</ul>
</li>
<li>可以用一个整数表示两个应用实体之间的通信关系 ，本地标示</li>
<li>穿过层间接口的信息量最小</li>
<li>TCP socket：源IP,源端口，目标IP，目标IP, 目标端口</li>
</ul>
</li>
</ul>
<h6 id="TCP之上的套接字（socket）">TCP之上的套接字（socket）</h6>
<ul>
<li>对于使用面向连接服务（TCP）的应用而言，套接字是4元组的一个具有本地意义的标示
<ul>
<li>4元组：(源IP，源port，目标IP，目标port)</li>
<li>唯一的指定了一个会话（2个进程之间的会话关系）</li>
<li>应用使用这个标示，与远程的应用进程通信</li>
<li>不必在每一个报文的发送都要指定这4元组</li>
<li>就像使用操作系统打开一个文件，OS返回一个文件句柄一样，以后使用这个文件句柄，而不是使用这个文件 的目录名、文件名</li>
<li>简单，便于管理</li>
</ul>
</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/43e9389d3e94099fad9be3b3710a6edf-TCP%20socket-662b98.png"
                       
                >
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/34bb8dd006913639e25e3d2280d2270d-TCP%20socket2-f66f82.png"
                      alt=""
                ></p>
<h6 id="UDP之上的套接字（socket）">UDP之上的套接字（socket）</h6>
<ul>
<li>UDP socket：
<ul>
<li>UDP服务，两个进程之间的通信需要之前无需建立连接
<ul>
<li>每个报文都是独立传输的</li>
<li>前后报文可能给不同的分布式进程</li>
</ul>
</li>
<li>因此，只能用一个整数表示本应用实体的标示
<ul>
<li>因为这个报文可能传给另外一个分布式进程 ·1</li>
</ul>
</li>
<li>穿过层间接口的信息大小最小</li>
<li>UDP socket：本IP,本端口</li>
<li>但是传输报文时：必须要提供对方IP，port
<ul>
<li>接收报文时：传输层需要上传对方的IP，port</li>
</ul>
</li>
</ul>
</li>
<li>对于使用无连接服务（UDP）的应用而言，套接字是2元组的一个具有本地意义的标示
<ul>
<li>2元组：IP，port （源端指定）</li>
<li>UDP套接字指定了应用所在的一个端节点（end point）</li>
<li>在发送数据报时，采用创建好的本地套接字（标示 ID），就不必在发送每个报文中指明自己所采用的 ip和port</li>
<li>但是在发送报文时，必须要指定对方的ip和udp port(另外一个段节点)</li>
</ul>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/76afea47021db351cbc50a21b08e5fa3-UDP%20socket-b58b52.png"
                      alt=""
                ></p>
<blockquote>
<h2 id="套接字（Socket）">套接字（Socket）</h2>
<ul>
<li>进程向套接字发送报文或从套接字接收报文</li>
<li>套接字 &lt;-&gt; 门户
<ul>
<li>发送进程将报文推出门户，发送进程依赖于传输层设施在另外一侧的门将报文交付给接受进程<br>
UDP</li>
<li>接收进程从另外一端的门户收到报文（依赖于传输层设施）</li>
</ul>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/dd6f259aba9eac671b04a7adcb5a7cf1-socket-5c52af.png"
                      alt=""
                ></p>
</blockquote>
<h5 id="问题3：如何使用传输层提供的服务实现应用">问题3：如何使用传输层提供的服务实现应用</h5>
<ul>
<li>定义应用层协议：报文格式，解释，时序等</li>
<li>编制程序，通过API调用网络基础设施提供通信服务传报文，解析报文，实现应用时序等</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/0d0eb8f388800df6edff1f370ae882d5-%E4%BD%BF%E7%94%A8%E4%BC%A0%E8%BE%93%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E5%BA%94%E7%94%A8-f36867.png"
                      alt=""
                ></p>
<h4 id="应用层协议">应用层协议</h4>
<blockquote>
<p>定义了：运行在不同端系统上的应用进程如何相互交换报文</p>
<ul>
<li>交换的报文类型：请求和应答报文</li>
<li>各种报文类型的语法：报文中的各个字段及其描述</li>
<li>字段的语义：即字段取值的含义</li>
<li>进程何时、如何发送报文及对报文进行响应的规则</li>
</ul>
<p>==应用协议仅仅是应用的一个组成部分==</p>
<ul>
<li>Web应用：HTTP协议，web客户端，web服务器，HTML</li>
</ul>
<p>公开协议：</p>
<ul>
<li>由RFC文档定义</li>
<li>允许互操作</li>
<li>如HTTP, SMTP</li>
</ul>
<p>专用（私有）协议：</p>
<ul>
<li>协议不公开</li>
<li>如：Skype</li>
</ul>
</blockquote>
<h5 id="应用需要传输层提供什么样的服务？">应用需要传输层提供什么样的服务？</h5>
<ul>
<li>数据丢失率
<ul>
<li>有些应用则要求100%的可靠数据传输（如文件）</li>
<li>有些应用（如音频）能容忍一定比例以下的数据丢失</li>
</ul>
</li>
<li>延迟
<ul>
<li>一些应用出于有效性考虑，对数据传输有严格的时间限制
<ul>
<li>Internet 电话、交互式游戏</li>
<li>延迟、延迟差</li>
</ul>
</li>
</ul>
</li>
<li>吞吐
<ul>
<li>一些应用（如多媒体）必须需要最小限度的吞吐，从而使得应用能够有效运转</li>
<li>一些应用能充分利用可供使用的吞吐(弹性应用)</li>
</ul>
</li>
<li>安全性
<ul>
<li>机密性</li>
<li>完整性</li>
<li>可认证性（鉴别）</li>
</ul>
</li>
</ul>
<h5 id="常见应用对传输服务的要求">常见应用对传输服务的要求</h5>
<table>
<thead>
<tr>
<th style="text-align:center">应用</th>
<th style="text-align:center">数据丢失率</th>
<th style="text-align:center">吞吐</th>
<th style="text-align:center">时间敏感性</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">文件传输</td>
<td style="text-align:center">不能丢失</td>
<td style="text-align:center">弹性</td>
<td style="text-align:center">不</td>
</tr>
<tr>
<td style="text-align:center">e-mail</td>
<td style="text-align:center">不能丢失</td>
<td style="text-align:center">弹性</td>
<td style="text-align:center">不</td>
</tr>
<tr>
<td style="text-align:center">Web文档</td>
<td style="text-align:center">不能丢失</td>
<td style="text-align:center">弹性</td>
<td style="text-align:center">不</td>
</tr>
<tr>
<td style="text-align:center">实时音视频</td>
<td style="text-align:center">容忍丢失</td>
<td style="text-align:center">音频：5K bps - 1M bps<br>视频：100K bps - 5M bps</td>
<td style="text-align:center">是，100 ms</td>
</tr>
<tr>
<td style="text-align:center">存储音视频</td>
<td style="text-align:center">容忍丢失</td>
<td style="text-align:center">同上</td>
<td style="text-align:center">是，几秒</td>
</tr>
<tr>
<td style="text-align:center">交互式游戏</td>
<td style="text-align:center">容忍丢失</td>
<td style="text-align:center">几K bps - 10 K bps</td>
<td style="text-align:center">是， 100ms</td>
</tr>
<tr>
<td style="text-align:center">即时讯息</td>
<td style="text-align:center">不能丢失</td>
<td style="text-align:center">弹性</td>
<td style="text-align:center">是和不是</td>
</tr>
</tbody>
</table>
<h5 id="Internet-传输层提供的服务">Internet 传输层提供的服务</h5>
<h6 id="TCP-服务">TCP 服务</h6>
<ul>
<li>可靠的传输服务</li>
<li>流量控制：发送方不会淹没接受方</li>
<li>拥塞控制：当网络出现拥塞时，能抑制发送方</li>
<li>不能提供的服务：时间保证、最小吞吐保证和安全</li>
<li>面向连接：要求在客户端 进程和服务器进程之间建立连接</li>
</ul>
<h6 id="UDP-服务">UDP 服务</h6>
<ul>
<li>不可靠数据传输</li>
<li>==不提供== 的服务：可靠， 流量控制、拥塞控制、 时间、带宽保证、建立连接</li>
</ul>
<blockquote>
<h3 id="UDP存在的必要性">UDP存在的必要性</h3>
<ul>
<li>==能够区分不同的进程== ，而IP服务不能
<ul>
<li>在IP提供的主机到主机端到端功能的基础上，区分了主机的应用进程</li>
</ul>
</li>
<li>==无需建立连接== ，省去了建立连接时间，适合事务性的 应用</li>
<li>==不做可靠性的工作== ，例如检错重发，适合那些对实时性要求比较高而对正确性要求不高的应用
<ul>
<li>因为为了实现可靠性（准确性、保序等），必须付出时间代价（检错重发）</li>
</ul>
</li>
<li>没有拥塞控制和流量控制，==应用能够按照设定的速度发送数据==
<ul>
<li>而在TCP上面的应用，应用发送数据的速度和主机向网络发送的实际速度是不一致的，因为有流量控制和拥塞控制</li>
</ul>
</li>
</ul>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center">应用</th>
<th style="text-align:center">应用层协议</th>
<th style="text-align:center">下层的传输协议</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">e-mail</td>
<td style="text-align:center">SMTP [RFC 2821]</td>
<td style="text-align:center">TCP</td>
</tr>
<tr>
<td style="text-align:center">远程终端访问</td>
<td style="text-align:center">Telnet [RFC 854]</td>
<td style="text-align:center">TCP</td>
</tr>
<tr>
<td style="text-align:center">Web</td>
<td style="text-align:center">HTTP [RFC 2616]</td>
<td style="text-align:center">TCP</td>
</tr>
<tr>
<td style="text-align:center">文件传输</td>
<td style="text-align:center">FTP [RFC 959]</td>
<td style="text-align:center">TCP</td>
</tr>
<tr>
<td style="text-align:center">流媒体</td>
<td style="text-align:center">专用协议<br />（如：RealNetWorks）</td>
<td style="text-align:center">TCP 或 UDP</td>
</tr>
<tr>
<td style="text-align:center">Internet 电话</td>
<td style="text-align:center">专用协议<br />（如：Net2Phone）</td>
<td style="text-align:center">TCP 或 UDP</td>
</tr>
</tbody>
</table>
<h5 id="安全TCP">安全TCP</h5>
<h6 id="TCP-UDP">TCP &amp; UDP</h6>
<ul>
<li>都没有加密</li>
<li>明文通过互联网传输 ，甚至密码</li>
</ul>
<h6 id="SSL-——应用层">SSL ——应用层</h6>
<ul>
<li>在TCP上面实现，提供加密的TCP连接</li>
<li>私密性</li>
<li>数据完整性</li>
<li>端到端的鉴别</li>
</ul>
<h6 id="SSL在应用层">SSL在应用层</h6>
<ul>
<li>应用采用SSL库，SSL 库使用TCP通信</li>
</ul>
<h6 id="SSL-socket-API">SSL socket API</h6>
<ul>
<li>应用通过API将明文交给socket，SSL将其加密在互联网上传输</li>
<li>详见第8章</li>
</ul>
<h3 id="二、Web-and-HTTP">二、Web and HTTP</h3>
<blockquote>
<h5 id="一些术语">一些术语</h5>
<ul>
<li>
<p>Web页：由一些对象组成</p>
</li>
<li>
<p>对象可以是HTML文件、JPEG图像、Java小程序、声 音剪辑文件等</p>
</li>
<li>
<p>Web页含有一个基本的HTML文件，该基本HTML文 件又包含若干对象的引用（链接）</p>
</li>
<li>
<p>通过URL对每个对象进行引用</p>
<ul>
<li>访问协议，用户名，口令字，端口等；</li>
</ul>
</li>
<li>
<p>URL格式:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/1564030492daa1e60e7bbb6e1ac87ab4-URL%E6%A0%BC%E5%BC%8F-74b8af.png"
                      alt=""
                ></p>
</li>
</ul>
</blockquote>
<h4 id="HTTP-概况">HTTP 概况</h4>
<h6 id="HTTP-超文本传输协议">HTTP: 超文本传输协议</h6>
<ul>
<li>Web的应用层协议</li>
<li>客户/服务器模式
<ul>
<li>客户: 请求、接收和显示 Web 对象的浏览器</li>
<li>服务器: 对请求进行响应， 发送对象的Web服务器</li>
</ul>
</li>
<li>HTTP 1.0: RFC 1945</li>
<li>HTTP 1.1: RFC 2068</li>
</ul>
<h6 id="使用TCP">使用TCP</h6>
<ul>
<li>
<p>客户发起一个与服务器的 TCP连接 (建立套接字) ， 端口号为 80</p>
</li>
<li>
<p>服务器接受客户的TCP连接</p>
</li>
<li>
<p>在浏览器(HTTP客户端) 与Web服务器(HTTP服务器 server)交换HTTP报文 (应用层协议报文)</p>
</li>
<li>
<p>TCP连接关闭</p>
</li>
</ul>
<h6 id="HTTP是无状态的">HTTP是无状态的</h6>
<ul>
<li>服务器并不维护关</li>
<li>于客户的任何信息</li>
</ul>
<blockquote>
<h5 id="维护状态的协议很复杂！">维护状态的协议很复杂！</h5>
<ul>
<li>必须维护历史信息(状态)</li>
<li>如果服务器/客户端死机，它们的状态信息可能不一致， 二者的信息必须是一致</li>
<li>无状态的服务器能够支持更多的客户端</li>
</ul>
</blockquote>
<h4 id="HTTP连接">HTTP连接</h4>
<h6 id="非持久HTTP">非持久HTTP</h6>
<blockquote>
<ul>
<li>最多只有一个对象在 TCP 连接上发送</li>
<li>下载多个对象需要多个 TCP 连接</li>
<li>HTTP/1.0使用非持久连接</li>
</ul>
</blockquote>
<blockquote>
<h5 id="非持久HTTP连接">非持久HTTP连接</h5>
<p>假设用户输入URL：<a class="link"   target="_blank" rel="noopener" href="http://www.someSchool.edu/someDept/home.index" >www.someSchool.edu/someDept/home.index <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>（包含文本和10个就 jpeg图像的引用）</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/6a805575cd2ef970461ee39716846871-%E9%9D%9E%E6%8C%81%E4%B9%85http%E8%BF%9E%E6%8E%A5-de8c7a.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h5 id="响应时间模型">响应时间模型</h5>
<ul>
<li>
<p>往返时间RTT（round-trip time）：</p>
<ul>
<li>一个小的分组从客户端到服务器，在回到客户端的时间（传输时间忽略）</li>
</ul>
</li>
<li>
<p>响应时间：</p>
<ul>
<li>一个RTT用来发起TCP连接</li>
<li>一个 RTT用来HTTP请求并等待HTTP响应</li>
<li>文件传输时间
<ul>
<li>共：2RTT+传输时间</li>
</ul>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/7f0f2febeae68e7e0e70c51634761e62-%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E6%A8%A1%E5%9E%8B-e24c62.png"
                      alt=""
                ></p>
</li>
</ul>
</blockquote>
<ul>
<li>非持久HTTP的缺点：
<ul>
<li>每个对象要2个 RTT</li>
<li>操作系统必须为每个TCP连接分配资源</li>
<li>但浏览器通常打开并行TCP连接，以获取引用对象</li>
</ul>
</li>
</ul>
<h6 id="持久HTTP">持久HTTP</h6>
<blockquote>
<ul>
<li>多个对象可以在一个 （在客户端和服务器之间的）TCP连接上传输</li>
<li>HTTP/1.1 默认使用持久连接</li>
</ul>
</blockquote>
<ul>
<li>非流水方式的持久HTTP：
<ul>
<li>客户端只能在收到前一个响应后才能发出新的请求</li>
<li>每个引用对象花费一个RTT</li>
</ul>
</li>
<li>流水方式的持久HTTP：
<ul>
<li>HTTP/1.1的默认模式</li>
<li>客户端遇到一个引用对象就立即产生一个请求</li>
<li>所有引用（小）对象只花费一个RTT是可能的</li>
</ul>
</li>
</ul>
<h5 id="HTTP请求报文">HTTP请求报文</h5>
<ul>
<li>两种类型的HTTP报文：请求、响应</li>
<li>HTTP请求报文:
<ul>
<li>ASCII (人能阅读)</li>
</ul>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/a01445d721c173b612b73545efa15abc-HTTP%E6%8A%A5%E6%96%87-3df729.png"
                      alt=""
                ></p>
<blockquote>
<h4 id="HTTP请求报文：通用格式">HTTP请求报文：通用格式</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/6562ac542e420af450c6ef1444c36f50-%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87-b7390e.png"
                      alt=""
                ></p>
</blockquote>
<h6 id="提交表单输入">提交表单输入</h6>
<ul>
<li>Post方式：
<ul>
<li>网页通常包括表单输 入</li>
<li>包含在实体主体 (entity body )中的 输入被提交到服务器</li>
</ul>
</li>
<li>URL方式：
<ul>
<li>方法：GET</li>
<li>输入通过请求行的URL字段上载</li>
</ul>
</li>
</ul>
<h6 id="方法类型">方法类型</h6>
<ul>
<li>HTTP/1.0
<ul>
<li>GET</li>
<li>POST</li>
<li>HEAD
<ul>
<li>要求服务器在响应报文中不包含请求对象 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\to</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span> 故障 跟踪</li>
</ul>
</li>
</ul>
</li>
<li>HTTP/1.1
<ul>
<li>GET, POST, HEAD</li>
<li>PUT
<ul>
<li>将实体主体中的文件上载到URL字段规定的路径</li>
</ul>
</li>
<li>DELETE
<ul>
<li>删除URL字段规定的文件</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="HTTP响应报文">HTTP响应报文</h5>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/fbe1897090b3585f1aa17880a83d7535-%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87-843b3e.png"
                      alt=""
                ></p>
<h6 id="HTTP响应状态码">HTTP响应状态码</h6>
<blockquote>
<p>位于服务器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\to</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span> 客户端的响应报文中的首行</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center">状态码</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">200</td>
<td style="text-align:center">OK：请求成功，请求对象包含在响应报文的后续部分</td>
</tr>
<tr>
<td style="text-align:center">301</td>
<td style="text-align:center">Moved Permanently：请求的对象已经被永久转移了；新的URL在响应报文的Location: 首部行中指定 客户端软件自动用新的URL去获取对象</td>
</tr>
<tr>
<td style="text-align:center">400</td>
<td style="text-align:center">Bad Request：一个通用的差错代码，表示该请求不能被服务器解读</td>
</tr>
<tr>
<td style="text-align:center">404</td>
<td style="text-align:center">Not Found：请求的文档在该服务上没有找到</td>
</tr>
<tr>
<td style="text-align:center">505</td>
<td style="text-align:center">HTTP Version Not Supported</td>
</tr>
</tbody>
</table>
<blockquote>
<h6 id="Trying-out-HTTP-client-side-for-yourself">Trying out HTTP (client side) for yourself</h6>
<ol>
<li>
<p>Telnet to your favorite Web server：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/627c1251a97d78a8414b159ca29e05a8-telnet-adfe1d.png"
                      alt=""
                ></p>
</li>
<li>
<p>type in a GET HTTP request：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/f40777d697cfdd733736b235f82f1b84-get-6bfbb9.png"
                      alt=""
                ></p>
</li>
<li>
<p>look at response message sent by HTTP server!</p>
<blockquote>
<p>（or use Wireshark to look at captured HTTP request/response)</p>
</blockquote>
</li>
</ol>
</blockquote>
<h5 id="用户-服务器状态：cookies">用户-服务器状态：cookies</h5>
<h6 id="4个组成部分：">4个组成部分：</h6>
<ul>
<li>在HTTP响应报文中有 一个cookie的首部行</li>
<li>在HTTP请求报文含有 一个cookie的首部行</li>
<li>在用户端系统中保留有一个cookie文件，由用户的浏览器管理</li>
<li>在Web站点有一个后端数据库</li>
</ul>
<h6 id="Cookies-维护状态">Cookies: 维护状态</h6>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/4566a6eee660f6cfec7c0677d541648e-cookie%E7%BB%B4%E6%8A%A4%E7%8A%B6%E6%80%81-7de6cf.png"
                      alt=""
                ></p>
<h6 id="Cookies能带来什么">Cookies能带来什么</h6>
<ul>
<li>用户验证、购物车、推荐、用户状态 (Web e-mail)</li>
</ul>
<h6 id="如何维持状态">如何维持状态</h6>
<ul>
<li>协议端节点：在多个事务上 ，发送端和接收端维持状态</li>
<li>cookies: http报文携带状态信息</li>
</ul>
<h6 id="Cookies与隐私">Cookies与隐私</h6>
<ul>
<li>Cookies允许站点知道许多关于用户的信息</li>
<li>可能将它知道的东西卖给第三 方</li>
<li>使用重定向和cookie的搜索引擎还能知道用户更多的信息
<ul>
<li>如通过某个用户在大量站点上的行为，了解其个人浏览方式的大致模式</li>
</ul>
</li>
<li>广告公司从站点获得信息</li>
</ul>
<h6 id="Web缓存-代理服务器">Web缓存 (代理服务器)</h6>
<blockquote>
<p>目标：不访问原始服务器，就满足客户的请求</p>
</blockquote>
<ul>
<li>
<p>用户设置浏览器：通过缓存访问Web</p>
</li>
<li>
<p>浏览器将所有的 HTTP 请求发给缓存</p>
<ul>
<li>在缓存中的对象：缓存直接返回对象</li>
<li>如对象不在缓存，缓存请求原始服务器，然后再将对象返回给客户端</li>
</ul>
</li>
<li>
<p>缓存既是客户端又是服务器</p>
</li>
<li>
<p>通常缓存是由ISP安装 (大学、公司、居民区ISP)</p>
</li>
</ul>
<blockquote>
<h6 id="为什么要使用Web缓存-？">为什么要使用Web缓存 ？</h6>
<ul>
<li>降低客户端的请求响应时间</li>
<li>可以大大减少一个机构内部网络与Internent接入链路上的流量</li>
<li>互联网大量采用了缓存： 可以使较弱的ICP也能够有效提供内容</li>
</ul>
</blockquote>
<blockquote>
<h5 id="示例">示例</h5>
<h6 id="假设-：">==假设==：</h6>
<ul>
<li>平均对象大小 = 100kb</li>
<li>机构内浏览器对原始服务器的平均请求率为 = 15请求/s</li>
<li>平均到浏览器的速率：1.5Mbps</li>
<li>机构内部路由器到原始服务器再返回到路由器的的延时（ Internet 延时）= 2s</li>
<li>接入链路带宽：1.54Mbps</li>
</ul>
<h6 id="结果-：">==结果==：</h6>
<ul>
<li>LAN的流量强度 = 15%</li>
<li>接入链路上的流量强度 = 99%</li>
<li>总延时 = LAN延时 + 接入延时 + Internet 延时 = ms + 分 + 2s</li>
</ul>
<h5 id="更快的接入链路">更快的接入链路</h5>
<p>==代价：增加了接入链路带宽（非常昂贵！）==</p>
<h6 id="假设-：-2">==假设==：</h6>
<ul>
<li>平均对象大小 = 100kb</li>
<li>机构内浏览器对原始服务器的 平均请求率为 = 15请求/s</li>
<li>平均到浏览器的速率：1.5Mbps</li>
<li>机构内部路由器到原始服务器再返回到路由器的的延时（ Internet 延时）= 2s</li>
<li>接入链路带宽：1.54Mbps</li>
</ul>
<h6 id="结果-：-2">==结果==：</h6>
<ul>
<li>LAN的流量强度 = 15%</li>
<li>接入链路上的流量强度 = 99%</li>
<li>总延时 = LAN延时 + 接入延时 + Internet 延时 = ms + 分 + 2s</li>
</ul>
<h5 id="安装本地缓存">安装本地缓存</h5>
<p>==代价：web缓存(廉价!)==</p>
<h6 id="假设-：-3">==假设==：</h6>
<ul>
<li>平均对象大小 = 100kb</li>
<li>机构内浏览器对原始服务器的平均请求率为 = 15请求/s</li>
<li>平均到浏览器的速率：1.5Mbps</li>
<li>机构内部路由器到原始服务器再返 回到路由器的的延时（Internet 延 时）= 2s</li>
<li>接入链路带宽：1.54Mbps</li>
</ul>
<h6 id="结果-：-3">==结果==：</h6>
<p>==计算链路利用率，有缓存的延迟==</p>
<ul>
<li>
<p>假设缓存命中率0.4</p>
<ul>
<li>40%请求在缓存中被满足，其他60%的请求 需要被原始服务器满足</li>
</ul>
</li>
<li>
<p>接入链路利用率:</p>
<ul>
<li>60%的请求采用接入链路</li>
</ul>
</li>
<li>
<p>进过接入链路到达浏览器的数据速率 = 0.6*1.50 Mbps = .9 Mbps</p>
<ul>
<li>利用率= 0.9/1.54 = .58</li>
</ul>
</li>
<li>
<p>总体延迟：</p>
<p class='katex-block katex-error ' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;&amp;&#039; at position 2: =&amp;̲ 0.6 * (从原始服务器获…'>=&amp; 0.6 * (从原始服务器获取对象的延迟) +0.4 * (从缓存获取对象的延迟) \\
                                                        
=&amp; 0.6 (2.01) + 0.4 (~msecs)  \\
                                                        
= &amp;~ 1.2 secs \\
</p>
</li>
</ul>
<blockquote>
<p>==比安装154Mbps链路还来得小 (而且比较便宜!)==</p>
</blockquote>
</blockquote>
<h5 id="条件GET方法">条件GET方法</h5>
<ul>
<li>
<p>目标：如果缓存器中的对象拷贝是最新的，就不要发送对象</p>
</li>
<li>
<p>缓存器: 在HTTP请求中指定缓存拷贝的日期</p>
  <div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If-modified-since: &lt;<span class="built_in">date</span>&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li>
<p>服务器: 如果缓存拷贝陈旧，则响应报文没包含对象:</p>
  <div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.0 304 Not Modified</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/bf69c6be39227ba4791cd9d307b0b7d5-%E6%9D%A1%E4%BB%B6get%E6%96%B9%E6%B3%95-42bf06.png"
                      alt=""
                ></p>
</li>
</ul>
<h3 id="三、FTP：文件传输协议">三、FTP：文件传输协议</h3>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/37b66c3553dc82375f08af58b74f10e2-ftp-8834d0.png"
                      alt=""
                ></p>
<ul>
<li>向远程主机上传输文件或从远程主机接收文件</li>
<li>客户/服务器模式
<ul>
<li>客户端：发起传输的一方</li>
<li>服务器：远程主机</li>
</ul>
</li>
<li>ftp: RFC 959</li>
<li>ftp服务器：端口号为21</li>
</ul>
<h4 id="控制连接与数据连接分开">控制连接与数据连接分开</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/5d5be36ed87cf353a20fd30d4e9440d0-ftp1-e7b1a8.png"
                      alt=""
                ></p>
<ul>
<li>FTP客户端与FTP服务器通过端口21联系，并使用TCP为传输协议</li>
<li>客户端通过控制连接获得身份确认</li>
<li>客户端通过控制连接发送命令浏览远程目录</li>
<li>收到一个文件传输命令时，服务器打开一个到客户端的数据连接</li>
<li>一个文件传输完成后，服务器关闭连接</li>
<li>服务器打开第二个TCP数据连接用来传输另一个文件</li>
<li>控制连接： ==带外（“out of band” ）==传送</li>
<li>FTP服务器维护用户的状态信息： 当前路径、用户帐户与控制连接对应 ==有状态==</li>
</ul>
<h4 id="FTP命令、响应">FTP命令、响应</h4>
<h6 id="命令样例：">命令样例：</h6>
<ul>
<li>在控制连接上以ASCII文本方式传送</li>
<li>USER username</li>
<li>PASS password</li>
<li>LIST：请服务器返回远程主机当前目录的文件列表</li>
<li>RETR filename：从远程主机的当前目录检索文件 (gets)</li>
<li>STOR filename：向远程主机的当前目录存放文件 (puts)</li>
</ul>
<h6 id="返回码样例：">返回码样例：</h6>
<ul>
<li>
<p>状态码和状态信息 (同HTTP)</p>
</li>
<li>
<p>331 Username OK, password required</p>
</li>
<li>
<p>125 data connection already open; transfer starting</p>
</li>
<li>
<p>425 Can’t open data connection</p>
</li>
<li>
<p>452 Error writing file</p>
</li>
</ul>
<h3 id="四、EMail：电子邮件">四、EMail：电子邮件</h3>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/8689dadafcf748c9fb5ba62d3d42fdd5-Email-f8b163.png"
                      style="zoom: 80%;" 
                >
<h5 id="3个主要组成部分">3个主要组成部分</h5>
<ul>
<li>用户代理</li>
<li>邮件服务器</li>
<li>简单邮件传输协议：SMTP</li>
</ul>
<h6 id="用户代理">用户代理</h6>
<ul>
<li>又名 “邮件阅读器”</li>
<li>撰写、编辑和阅读邮件</li>
<li>如Outlook、Foxmail</li>
<li>输出和输入邮件保存在服务器上</li>
</ul>
<h6 id="邮件服务器">邮件服务器</h6>
<ul>
<li>邮箱中管理和维护发送给用户的邮件</li>
<li>输出报文队列保持待发送邮件报文</li>
<li>邮件服务器之间的SMTP协议 ：发送email报文
<ul>
<li>客户：发送方邮件服务器</li>
<li>服务器：接收端邮件服务器</li>
</ul>
</li>
</ul>
<h6 id="EMail-SMTP-RFC-2821">EMail: SMTP [RFC 2821]</h6>
<ul>
<li>使用TCP在客户端和服务器之间传送报文，端口号为25</li>
<li>直接传输：从发送方服务器到接收方服务器</li>
<li>传输的3个阶段
<ul>
<li>握手</li>
<li>传输报文</li>
<li>关闭</li>
</ul>
</li>
<li>命令/响应交互
<ul>
<li>命令：ASCII文本</li>
<li>响应：状态码和状态信息</li>
</ul>
</li>
<li>报文必须为7位ASCII码</li>
</ul>
<blockquote>
<h6 id="举例：Alice给Bob发送报文">举例：Alice给Bob发送报文</h6>
<ol>
<li>Alice使用用户代理撰写邮件并发送给 <a class="link"   href="mailto:bob@someschool.edu" >bob@someschool.edu <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>Alice的用户代理将邮件发送到她的邮件服务器；邮件放在报文队列中</li>
<li>SMTP的客户端打开到Bob邮件服务器的TCP连接</li>
<li>SMTP客户端通过TCP连接发送Alice的邮件</li>
<li>Bob的邮件服务器将邮件放到 Bob 的邮箱</li>
<li>Bob调用他的用户代理阅读邮件</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/680f96c3205ec549e7a2738bb21098d3-SMTP-c85a32.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h6 id="简单的SMTP交互">简单的SMTP交互</h6>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/8092dd8398b004ef71559e84ca84f4a9-SMTP%E4%BA%A4%E4%BA%92-9982b0.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h6 id="Try-SMTP-interaction-for-yourself">Try SMTP interaction for yourself</h6>
<ul>
<li>telnet servername 25</li>
<li>see 220 reply from server</li>
<li>enter HELO, MAIL FROM, RCPT TO, DATA, QUIT commands<br>
above lets you send email without using email client (reader)</li>
</ul>
</blockquote>
<h6 id="总结">总结</h6>
<ul>
<li>
<p>SMTP使用持久连接</p>
</li>
<li>
<p>SMTP要求报文（首部 和主体）为7位ASCII编码</p>
</li>
<li>
<p>SMTP服务器使用 CRLF.CRLF 决定报文的尾部</p>
</li>
</ul>
<h6 id="HTTP比较：">HTTP比较：</h6>
<ul>
<li>HTTP：拉（pull）</li>
<li>SMTP：推（push）</li>
<li>二者都是ASCII形式的命令/响应交互、状态码</li>
<li>HTTP：每个对象封装在各自的响应报文中</li>
<li>SMTP：多个对象包含在一个报文中</li>
</ul>
<h6 id="邮件报文格式">邮件报文格式</h6>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/5ceb79e133dd1bef80168014d1d5d003-Email%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F-7dab36.png"
                      alt=""
                ></p>
<p>SMTP：交换email报文的协议 RFC 822: 文本报文的标准：</p>
<ul>
<li>首部行：
<ul>
<li>如, To: 、From: 、Subject: 、与SMTP命令不同！</li>
</ul>
</li>
<li>主体
<ul>
<li>报文，只能是ASCII码字符</li>
</ul>
</li>
</ul>
<h6 id="多媒体扩展">多媒体扩展</h6>
<ul>
<li>
<p>MIME：多媒体邮件扩展（multimedia mail extension）, RFC 2045, 2056</p>
</li>
<li>
<p>在报文首部用额外的行声明MIME内容类型</p>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/cd675da7a3df1a58a49ac2489212999d-MIME-596eec.png"
                      alt=""
                ></p>
<h6 id="邮件访问协议">邮件访问协议</h6>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/531b8eec193ce5a39b4bd7981b9c70ca-%E9%82%AE%E4%BB%B6%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE-4a0370.png"
                      alt=""
                ></p>
<ul>
<li>SMTP: 传送到接收方的邮件服务器</li>
<li>邮件访问协议：从服务器访问邮件
<ul>
<li>POP：邮局访问协议（Post Office Protocol）[RFC 1939]
<ul>
<li>用户身份确认 (代理&lt;–&gt;服务器) 并下载</li>
</ul>
</li>
<li>IMAP：Internet邮件访问协议（Internet Mail Access Protocol）[RFC 1730]
<ul>
<li>更多特性 (更复杂)</li>
<li>在服务器上处理存储的报文</li>
</ul>
</li>
<li>HTTP：Hotmail , Yahoo! Mail等
<ul>
<li>方便</li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 id="POP3协议">POP3协议</h6>
<p>==本地管理文件夹==</p>
<ul>
<li>
<p>用户确认阶段</p>
  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/9eecb622f310d60c336f377498e643cb-%E7%94%A8%E6%88%B7%E7%A1%AE%E8%AE%A4-2ba45d.png"
                      style="zoom:50%;" 
                >
<ul>
<li>客户端命令：
<ul>
<li>user: 申明用户名</li>
<li>pass: 口令</li>
</ul>
</li>
<li>服务器响应
<ul>
<li>+OK</li>
<li>-ERR</li>
</ul>
</li>
</ul>
</li>
<li>
<p>事物处理阶段, 客户端</p>
  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/dd508c5d8060b1dcada34a296c1d055b-%E4%BA%8B%E7%89%A9%E5%A4%84%E7%90%86-f52a33.png"
                      style="zoom:50%;" 
                >
<ul>
<li>list: 报文号列表</li>
<li>retr: 根据报文号检索报文</li>
<li>dele: 删除</li>
<li>quit</li>
</ul>
</li>
<li>
<p>先前的例子使用“下载并删除”模式</p>
<ul>
<li>如果改变客户机，Bob不能阅读邮件</li>
</ul>
</li>
<li>
<p>“下载并保留”：不同客户机上为报文的拷贝</p>
<ul>
<li>POP3在会话中是无状态的</li>
</ul>
</li>
</ul>
<h6 id="IMAP">IMAP</h6>
<p>==远程管理文件夹==</p>
<ul>
<li>IMAP服务器将每个报文与一个文件夹联系起来</li>
<li>允许用户用目录来组织报文</li>
<li>允许用户读取报文组件</li>
<li>IMAP在会话过程中保留 用户状态：
<ul>
<li>目录名、报文ID与目录名之间映射</li>
</ul>
</li>
</ul>
<h3 id="五、DNS（Domain-Name-System）">五、DNS（Domain Name System）</h3>
<h5 id="DNS的必要性">DNS的必要性</h5>
<ul>
<li>IP地址标识主机、路由器</li>
<li>但IP地址不好记忆，不便人类使用(没有意义)</li>
<li>人类一般倾向于使用一些有意义的字符串来标识 Internet上的设备
<ul>
<li>例如：qzheng@ustc.edu.cn 所在的邮件服务器 <a class="link"   target="_blank" rel="noopener" href="http://www.ustc.edu.cn" >www.ustc.edu.cn <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 所在的web服务器</li>
</ul>
</li>
<li>存在着“字符串”—IP地址的转换的必要性</li>
<li>人类用户提供要访问机器的“字符串”名称</li>
<li>由DNS负责转换成为二进制的网络地址</li>
</ul>
<h5 id="DNS系统需要解决的问题">DNS系统需要解决的问题</h5>
<ul>
<li>问题1：如何命名设备
<ul>
<li>用有意义的字符串：好记，便于人类用使用</li>
<li>解决一个平面命名的重名问题：层次化命名</li>
</ul>
</li>
<li>问题2：如何完成名字到IP地址的转换
<ul>
<li>分布式的数据库维护和响应名字查询</li>
</ul>
</li>
<li>问题3：如何维护：增加或者删除一个域，需要在域名系统中做哪些工作</li>
</ul>
<h5 id="DNS-Domain-Name-System-的历史">DNS(Domain Name System)的历史</h5>
<ul>
<li>ARPANET的名字解析解决方案
<ul>
<li>主机名：没有层次的一个字符串（一个平面）</li>
<li>存在着一个（集中）维护站：维护着一张主机名-IP地址的映射文件：Hosts.txt</li>
<li>每台主机定时从维护站取文件</li>
</ul>
</li>
<li>ARPANET解决方案的问题
<ul>
<li>当网络中主机数量很大时
<ul>
<li>没有层次的主机名称很难分配</li>
<li>文件的管理、发布、查找都很麻烦</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="DNS-Domain-Name-System-总体思路和目标">DNS(Domain Name System)总体思路和目标</h5>
<ul>
<li>DNS的主要思路
<ul>
<li>==分层== 的、基于域的命名机制</li>
<li>若干 ==分布== 式的数据库完成名字到IP地址的转换</li>
<li>运行在UDP之上端口号为53的 ==应用服务==</li>
<li>核心的Internet功能，但以应用层协议实现
<ul>
<li>在网络边缘处理复杂性</li>
</ul>
</li>
</ul>
</li>
<li>DNS主要目的：
<ul>
<li>实现主机名-IP地址的转换(name/IP translate)</li>
<li>其它目的
<ul>
<li>==主机别名== 到 ==规范名字== 的转换：Host aliasing</li>
<li>邮件服务器 ==别名== 到邮件服务器的 ==正规名字== 的转换：Mail server aliasing</li>
<li>==负载均衡==：Load Distribution</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="问题1：DNS名字空间-The-DNS-Name-Space">问题1：DNS名字空间(The DNS Name Space)</h5>
<ul>
<li>DNS域名结构
<ul>
<li>一个层面命名设备会有很多重名</li>
<li>NDS采用层次树状结构的命名方法</li>
<li>Internet 根被划为几百个顶级域(top lever domains)
<ul>
<li>通用的(generic)
<ul>
<li>.com; .edu ; .gov ; .int ; .mil; .net ; .org; .firm ; .hsop ; .web ; .arts ; .rec ;</li>
</ul>
</li>
<li>国家的(countries)
<ul>
<li>.cn ; .us ; .nl ; .jp</li>
</ul>
</li>
<li>每个(子)域下面可划分为若干子域(subdomains)</li>
<li>树叶是主机</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<h4 id="DNS-根名字服务器">DNS: 根名字服务器</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/5532ab8620c0ccb36bd12c1bf1123ebc-%E6%A0%B9%E5%90%8D%E5%AD%97%E6%9C%8D%E5%8A%A1%E5%99%A8-4f0cb2.png"
                      alt=""
                ></p>
</blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/2e6640cf1a97d6d2a05704354e381539-DNS%E5%90%8D%E5%AD%97%E7%A9%BA%E9%97%B4-58016f.png"
                      alt=""
                ></p>
<ul>
<li>域名(Domain Name)
<ul>
<li>从本域往上，直到树根</li>
<li>中间使用“.”间隔不同的级别</li>
<li>例如：<a class="link"   target="_blank" rel="noopener" href="http://ustc.edu.cn" >ustc.edu.cn <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>、<a class="link"   target="_blank" rel="noopener" href="http://auto.ustc.edu.cn" >auto.ustc.edu.cn <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>、www.auto. <a class="link"   target="_blank" rel="noopener" href="http://ustc.edu.cn" >ustc.edu.cn <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>域的域名：可以用于表示一个域</li>
<li>主机的域名：一个域上的一个主机</li>
</ul>
</li>
<li>域名的管理
<ul>
<li>一个域管理其下的子域
<ul>
<li>.jp 被划分为 <a class="link"   target="_blank" rel="noopener" href="http://ac.jp" >ac.jp <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> <a class="link"   target="_blank" rel="noopener" href="http://co.jp" >co.jp <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>cn 被划分为 <a class="link"   target="_blank" rel="noopener" href="http://edu.cn" >edu.cn <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> <a class="link"   target="_blank" rel="noopener" href="http://com.cn" >com.cn <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
</ul>
</li>
<li>创建一个新的域，必须征得它所属域的同意</li>
</ul>
</li>
<li>域与物理网络无关
<ul>
<li>域遵从组织界限，而不是物理网络
<ul>
<li>一个域的主机可以不在一个网络</li>
<li>一个网络的主机不一定在一个域</li>
</ul>
</li>
<li>域的划分是逻辑的，而不是物理的</li>
</ul>
</li>
</ul>
<h5 id="问题2：解析问题-名字服务器-Name-Server">问题2：解析问题-名字服务器(Name Server)</h5>
<ul>
<li>
<p>一个名字服务器的问题</p>
<ul>
<li>
<p>可靠性问题：单点故障</p>
</li>
<li>
<p>扩展性问题：通信容量</p>
</li>
<li>
<p>维护问题：远距离的集中式数据库</p>
</li>
</ul>
</li>
<li>
<p>区域(zone)</p>
<ul>
<li>区域的划分有区域管理者自己决定</li>
<li>将DNS名字空间划分为互不相交的区域，每个区域都是树的一部分</li>
<li>名字服务器：
<ul>
<li>每个区域都有一个名字服务器：维护着它所管辖区域的权威信息 (authoritative record)</li>
<li>名字服务器允许被放置在区域之外，以保障可靠性</li>
</ul>
</li>
</ul>
</li>
<li>
<p>名字空间划分为若干区域：Zone</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/c32ebf59e51dbfa3611479e01c66ddb2-Zone-19ac79.png"
                      alt=""
                ></p>
</li>
<li>
<p>权威DNS服务器</p>
<ul>
<li>组织机构的DNS服务器， 提供组织机构服务器（如 Web和mail）可访问的主机和IP之间的映射</li>
<li>组织机构可以选择实现自己维护或由某个服务提供商来维护</li>
</ul>
</li>
<li>
<p>TLD（顶级域）服务器</p>
<ul>
<li>负责顶级域名（如com, org, net, edu和gov）和所有国家级的顶级域名（如cn, uk, fr, ca, jp ）
<ul>
<li>Network solutions 公司维护 com TLD 服务器</li>
<li>Educause公司维护 edu TLD 服务器</li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 id="区域名字服务器维护资源记录">区域名字服务器维护资源记录</h6>
<ul>
<li>
<p>资源记录(resource records)</p>
<ul>
<li>作用：维护 域名-IP地址(其它)的映射关系</li>
<li>位置：Name Server的分布式数据库中</li>
</ul>
</li>
<li>
<p>RR格式: (domain_name, ttl, type,class,Value)</p>
<ul>
<li>
<p>Domain_name: 域名</p>
</li>
<li>
<p>Ttl: time to live : 生存时间(权威，缓冲记录)</p>
</li>
<li>
<p>Class 类别 ：对于Internet，值为IN</p>
</li>
<li>
<p>Value 值：可以是数字，域名或ASCII串</p>
</li>
<li>
<p>Type 类别：资源记录的类型</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/48871a6e69cec9a4cf3c98f99eb37ef4-RR%20type-e78093.png"
                      alt=""
                ></p>
</li>
</ul>
</li>
</ul>
<blockquote>
<h6 id="DNS记录">DNS记录</h6>
<p>DNS ：保存资源记录(RR)的分布式数据库</p>
<p>RR 格式：(name, value, type, ttl)</p>
<ul>
<li>TTL：生存时间，决定了资源记录应当从缓存中删除的时间</li>
</ul>
</blockquote>
<blockquote>
<h5 id="一个例子">一个例子</h5>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/c82c8c597c353c96903bd66a7306e519-dns%20eg-2f4c8f.png"
                      alt=""
                ></p>
</blockquote>
<ul>
<li>
<p>DNS大致工作过程</p>
<ul>
<li>应用调用R解析器(resolver)</li>
<li>解析器作为客户向Name Server发出查询报文 （封装在UDP段中）</li>
<li>Name Server返回响应报文(name/ip)</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/e9ee301a65f64b6b85925451858c7ac8-name%20server%E8%BF%94%E5%9B%9E%E6%8A%A5%E6%96%87-467672.png"
                      alt=""
                ></p>
</li>
</ul>
<h6 id="本地名字服务器（Local-Name-Server）">本地名字服务器（Local Name Server）</h6>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/3b075ceded6e4b9863082bcd21b134e4-local%20name%20server-100780.png"
                      style="zoom:50%;" 
                >
<ul>
<li>并不严格属于层次结构</li>
<li>每个ISP (居民区的ISP、公司、大学）都有一个本地DNS服务器
<ul>
<li>也称为“默认名字服务器”</li>
</ul>
</li>
<li>当一个主机发起一个DNS查询时，查询被送到其本地DNS服务器
<ul>
<li>起着代理的作用，将查询转发到层次结构中</li>
</ul>
</li>
</ul>
<blockquote>
<h4 id="名字服务器（Name-Server）">名字服务器（Name Server）</h4>
<p>名字解析过程</p>
<ul>
<li>目标名字在Local Name Server中
<ul>
<li>情况1：查询的名字在该区域内部</li>
<li>情况2：缓存(cashing)</li>
</ul>
</li>
</ul>
<p>==当与本地名字服务器不能解析名字时，联系根名字服务器顺着根-TLD一直找到权威名字服务器==</p>
</blockquote>
<blockquote>
<h4 id="递归查询">递归查询</h4>
<ul>
<li>
<p>递归查询：</p>
<ul>
<li>名字解析负担都放在当前联络的名字服务器上</li>
<li>问题：根服务器的负担太重</li>
<li>解决：迭代查询 (iterated queries)</li>
</ul>
  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/8aeba125742c51c7ac166e6bc3ef1751-%E9%80%92%E5%BD%92%E6%9F%A5%E8%AF%A2-46c44e.png"
                      style="zoom:50%;" 
                >
</li>
</ul>
</blockquote>
<blockquote>
<h4 id="迭代查询">迭代查询</h4>
<ul>
<li>主机 <a class="link"   target="_blank" rel="noopener" href="http://cis.poly.edu" >cis.poly.edu <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 想知道主机 <a class="link"   target="_blank" rel="noopener" href="http://gaia.cs.umass.edu" >gaia.cs.umass.edu <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 的IP地址
<ul>
<li>根（及各级域名）服务器返回的不是查询结果，而是下一个DNS的地址</li>
<li>最后由权威名字服务器给出解析结果</li>
<li>当前联络的服务器给出可以联系的服务器的名字</li>
<li>“我不知道这个名字，但可以向这个服务器请求”</li>
</ul>
</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/8eb6c3c72f37bb2c3ffa511673dbcd56-%E8%BF%AD%E4%BB%A3%E6%9F%A5%E8%AF%A2-9013c2.png"
                      style="zoom:50%;" 
                >
</blockquote>
<h6 id="DNS协议、报文">DNS协议、报文</h6>
<blockquote>
<p>DNS协议：==查询== 和 ==响应== 报文的 ==报文格式== 相同</p>
</blockquote>
<ul>
<li>
<p>报文首部</p>
  <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/25760765e647fa91214a4273dcaf1fa9-DNS%E5%8D%8F%E8%AE%AE%E3%80%81%E6%8A%A5%E6%96%87-f9dce8.png"
                      style="zoom:50%;" 
                >
<ul>
<li>标识符（ID）：16位</li>
<li>flags:
<ul>
<li>查询/应答</li>
<li>希望递归</li>
<li>递归可用</li>
<li>应答为权威</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<h5 id="提高性能：缓存">提高性能：缓存</h5>
<ul>
<li>一旦名字服务器学到了一个映射，就将该映射缓存起来</li>
<li>根服务器通常都在本地服务器中缓存着
<ul>
<li>使得根服务器不用经常被访问</li>
</ul>
</li>
<li>目的：提高效率</li>
<li>可能存在的问题：如果情况变化，缓存结果和权威资源记录不一致</li>
<li>解决方案：TTL（默认2天）</li>
</ul>
</blockquote>
<h5 id="问题3：维护问题：新增一个域">问题3：维护问题：新增一个域</h5>
<ul>
<li>在上级域的名字服务器中增加两条记录，指向这个新增的子域的域名和域名服务器的地址</li>
<li>在新增子域的名字服务器上运行名字服务器，负责本域的名字解析：名字-&gt;IP地址</li>
</ul>
<blockquote>
<p>例子：在com域中建立一个“Network Utopia”</p>
<ul>
<li><a class="link"   target="_blank" rel="noopener" href="http://xn--networkutopia-he1va63x07l7qs6z2ekhb685dda4847c0m2g.com" >到注册登记机构注册域名networkutopia.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>需要向该机构提供权威DNS服务器（基本的、和辅助的）的名字和IP地址</li>
<li>登记机构在com TLD服务器中插入两条RR记录:
<ul>
<li>(<a class="link"   target="_blank" rel="noopener" href="http://networkutopia.com" >networkutopia.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>, <a class="link"   target="_blank" rel="noopener" href="http://dns1.networkutopia.com" >dns1.networkutopia.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>, NS)</li>
<li>(<a class="link"   target="_blank" rel="noopener" href="http://dns1.networkutopia.com" >dns1.networkutopia.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>, 212.212.212.1, A)</li>
</ul>
</li>
<li>在networkutopia.com的权威服务器中确保有
<ul>
<li>用于Web服务器的www.networkuptopia.com的类型为A的记录</li>
<li>用于邮件服务器mail.networkutopia.com的类型为MX的记录</li>
</ul>
</li>
</ul>
</blockquote>
<h5 id="攻击DNS">攻击DNS</h5>
<h6 id="DDoS-攻击">DDoS 攻击</h6>
<ul>
<li>对根服务器进行流量轰炸攻击：发送大量ping
<ul>
<li>没有成功</li>
<li>原因１：根目录服务器配置 了流量过滤器，防火墙</li>
<li>原因２：Local DNS 服务器 缓存了TLD服务器的IP地址, 因此无需查询根服务器</li>
</ul>
</li>
<li>向TLD服务器流量轰炸攻击 ：发送大量查询
<ul>
<li>可能更危险</li>
<li>效果一般，大部分DNS缓存了TLD</li>
</ul>
</li>
</ul>
<h6 id="重定向攻击">重定向攻击</h6>
<ul>
<li>
<p>中间人攻击</p>
<ul>
<li>截获查询，伪造回答，从而攻击某个（DNS回答指定的IP）站点</li>
</ul>
</li>
<li>
<p>DNS中毒</p>
<ul>
<li>发送伪造的应答给DNS服务器，希望它能够缓存这个虚假的结果</li>
</ul>
</li>
<li>
<p>技术上较困难：分布式截获和伪造利用DNS基础设施进行DDoS</p>
</li>
<li>
<p>伪造某个IP进行查询， 攻击这个目标IP</p>
</li>
<li>
<p>查询放大，响应报文比查询报文大</p>
</li>
<li>
<p>效果有限</p>
</li>
</ul>
<p>==总的说来，DNS比较健壮==</p>
<h3 id="六、P2P-应用">六、P2P 应用</h3>
<h4 id="纯P2P架构">纯P2P架构</h4>
<ul>
<li>没有（或极少）一直运行的服务器</li>
<li>任意端系统都可以直接通信</li>
<li>利用peer的服务能力</li>
<li>Peer节点间歇上网，每次IP地址都有可能变化</li>
<li>例子:
<ul>
<li>文件分发 (BitTorrent)</li>
<li>流媒体(KanKan)</li>
<li>VoIP (Skype)</li>
</ul>
</li>
</ul>
<h4 id="C-S-vs-P2P">C/S vs P2P</h4>
<blockquote>
<h6 id="问题-从一台服务器分发文件（大小F）到N个peer-需要多少时间？">问题: 从一台服务器分发文件（大小F）到N个peer 需要多少时间？</h6>
<ul>
<li>Peer节点上下载能力是有限的资源</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/da22e194cd654e30f032faea5a0cc0b6-CS-VS-P2P-75e06f.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h4 id="C-S模式">C/S模式</h4>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/c4d7cb472de8e41a937f50384f10c13d-cs-37d034.png"
                      style="zoom:50%;" 
                >
<ul>
<li>
<p>服务器传输： 都是由服务器发送给peer，服务器必须顺序传输（上载）N个文件拷贝:</p>
<ul>
<li>发送一个copy: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>F</mi><msub><mi>u</mi><mi>s</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{F}{u_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3174em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li>发送N个copy： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mfrac><mi>F</mi><msub><mi>u</mi><mi>s</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">N\frac{F}{u_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3174em;vertical-align:-0.4451em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
</ul>
</li>
<li>
<p>客户端: 每个客户端必须下载一个文件拷贝</p>
<ul>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>=</mo><mtext>客户端最小的下载速率</mtext></mrow><annotation encoding="application/x-tex">d_{min}=客户端最小的下载速率</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">客户端最小的下载速率</span></span></span></span></p>
</li>
<li>
<p>下载带宽最小的客户端下载的时间：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>F</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{F}{d_{min}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3174em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
</li>
</ul>
</li>
</ul>
<h6 id="采用C-S的方法将一个F大小的文件分发给N个客户端耗时：">==采用C-S的方法将一个F大小的文件分发给N个客户端耗时：==</h6>
<p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mrow><mi>C</mi><mo>−</mo><mi>S</mi></mrow></msub><mo>≥</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">{</mo><mi>N</mi><mfrac><mi>F</mi><msub><mi>u</mi><mi>s</mi></msub></mfrac><mtext>，</mtext><mfrac><mi>F</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mfrac><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">D_{C-S}\ge max\{N\frac{F}{u_s}，\frac{F}{d_{min}}\}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1963em;vertical-align:-0.836em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">}</span></span></span></span></span></p>
<ul>
<li>==NF随着N线性增长==</li>
</ul>
</blockquote>
<blockquote>
<h4 id="P2P模式">P2P模式</h4>
<ul>
<li>服务器传输：最少需要上载一份拷贝
<ul>
<li>发送一个拷贝的时间：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>F</mi><msub><mi>u</mi><mi>s</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{F}{u_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3174em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
</ul>
</li>
<li>客户端: 每个客户端必须下载一个拷贝
<ul>
<li>最小下载带宽客户单耗时：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>F</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{F}{d_{min}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3174em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
</ul>
</li>
<li>客户端: 所有客户端总体下载量NF
<ul>
<li>最大上载带宽是：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>s</mi></msub><mo>+</mo><mo>∑</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u_s+\sum u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>除了服务器可以上载，其他所有的peer节点都可以上载</li>
</ul>
</li>
</ul>
<h6 id="采用P2P方法将一个F大小的文件分发给N个客户端耗时：">==采用P2P方法将一个F大小的文件分发给N个客户端耗时：==</h6>
<p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mrow><mi>P</mi><mn>2</mn><mi>P</mi></mrow></msub><mo>≥</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">{</mo><mfrac><mi>F</mi><msub><mi>u</mi><mi>s</mi></msub></mfrac><mo separator="true">,</mo><mfrac><mi>F</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mfrac><mo separator="true">,</mo><mi>N</mi><mfrac><mi>F</mi><mrow><msub><mi>u</mi><mi>s</mi></msub><mo>+</mo><mo>∑</mo><msub><mi>u</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">D_{P2P}\ge max \{\frac{F}{u_s},\frac{F}{d_{min}},N\frac{F}{u_s+\sum u_i}\}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2963em;vertical-align:-0.936em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">{</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">}</span></span></span></span></span></p>
<ul>
<li>==分子随着N线性变化，每个节点需要下载，整体下载量随着N增大==</li>
<li>==分母也随着 peer 节点的增多，每个 peer 也带了服务能力==</li>
</ul>
</blockquote>
<blockquote>
<h4 id="CS-VS-P2P-例子">CS VS P2P 例子</h4>
<p>客户端上载速率 = u，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi mathvariant="normal">/</mi><mi>u</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">F/u=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord">/</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>  小时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>s</mi></msub><mo>=</mo><mn>10</mn><mi>u</mi></mrow><annotation encoding="application/x-tex">u_s=10u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span><span class="mord mathnormal">u</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>≥</mo><msub><mi>u</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">d_{min}\ge u_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/29480ac4c8ca56bffdac0b10b644f149-cs-vs-p2p-eg-687829.png"
                      style="zoom:67%;" 
                > 
</blockquote>
<h4 id="P2P文件分发">P2P文件分发</h4>
<h5 id="BitTorrent">BitTorrent</h5>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/edcb1dd974eb0a92381e599e71578897-bittorrent-4fa60c.png"
                      style="zoom: 50%;" 
                >
<ul>
<li>文件被分为一个个块256KB</li>
<li>网络中的这些peers发送接收文件块，相互服务</li>
<li>Peer加入torrent:
<ul>
<li>一开始没有块，但是将会通过其他节点处累积文件块</li>
<li>向跟踪服务器注册，获得 peer 节点列表，和部分peer节点构成邻居关系 (“连接 ”)</li>
</ul>
</li>
<li>当peer下载时，该peer可以同时向其他节点提供上载服务</li>
<li>Peer可能会变换用于交换块的peer节点</li>
<li>==扰动churn==: peer节点可能会上线或者下线</li>
<li>一旦一个peer拥有整个文件，它会（自私的）离开或者保留（利他主义）在torrent中</li>
</ul>
<h6 id="请求文件块">请求文件块</h6>
<ul>
<li>在任何给定时间，不同 peer 节点拥有一个文件块的子集</li>
<li>周期性的，Alice节点向邻居询问他们拥有哪些块的信息</li>
<li>Alice向peer节点请求它希望的块，稀缺的块</li>
</ul>
<h6 id="发送文件块：一报还一报titfor-tat">发送文件块：一报还一报titfor-tat</h6>
<ul>
<li>
<p>Alice向4个peer发送块，这些块向它自己提供最大带宽的服务</p>
<ul>
<li>其他peer被Alice阻塞 (将不会从Alice处获得服务)</li>
<li>每10秒重新评估一次：前4位</li>
</ul>
</li>
<li>
<p>每个30秒：随机选择其他peer节点，向这个节点发送块</p>
<ul>
<li>
<p>“优化疏通” 这个节点</p>
</li>
<li>
<p>新选择的节点可以加入这个top 4</p>
</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>Alice “优化疏通” Bob</li>
<li>Alice 变成了Bob的前4位提供者; Bob答谢Alice</li>
<li>Bob 变成了Alice的前4提供者</li>
</ul>
<p>==更高的上载速率： 发现更好 的交易伙伴，获得更快的文件传输速率!==</p>
</blockquote>
<blockquote>
<h5 id="P2P文件共享例子">P2P文件共享例子</h5>
<ul>
<li>Alice在其笔记本电脑上运行P2P客户端程序</li>
<li>间歇性地连接到 Internet，每次从其 ISP 得到新的IP地址</li>
<li>请求“双截棍.MP3”</li>
<li>应用程序显示其他有“ 双截棍.MP3”拷贝的对等方</li>
<li>Alice选择其中一个对等方， 如Bob.</li>
<li>文件从Bob’s PC传送到 Alice的笔记本上：HTTP</li>
<li>当Alice下载时，其他用户也可以从Alice处下载</li>
<li>Alice的对等方既是一个 Web 客户端，也是一个瞬时 Web 服务器</li>
</ul>
<p>==所有的对等方都是服务器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\to</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span> 可扩展性好！==</p>
</blockquote>
<blockquote>
<h5 id="P2P文件共享的两个问题">P2P文件共享的两个问题</h5>
<ul>
<li>如何定位所需资源？</li>
<li>如何处理对等方的加入与离开？</li>
</ul>
<h6 id="可能的方案（非结构化P2P）">可能的方案（非结构化P2P）</h6>
<ul>
<li>集中</li>
<li>分散</li>
<li>半分散</li>
</ul>
</blockquote>
<h5 id="集中式目录——非结构化">集中式目录——非结构化</h5>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/b6f30176249a2e5f480a7422f3bb1ca6-%E9%9B%86%E4%B8%AD%E5%BC%8F%E7%9B%AE%E5%BD%95-ed65b3.png"
                      style="zoom:50%;" 
                >
<ul>
<li>最初的“Napster”设计
<ul>
<li>当对等方连接时，它告知中心服务器：
<ul>
<li>IP地址</li>
<li>内容</li>
</ul>
</li>
<li>Alice查询“双截棍 .MP3”</li>
<li>Alice从Bob处请求文件</li>
</ul>
</li>
</ul>
<blockquote>
<h5 id="P2P：集中式目录中存在的问题">P2P：集中式目录中存在的问题</h5>
<ul>
<li>单点故障</li>
<li>性能瓶颈</li>
<li>侵犯版权</li>
</ul>
<p>==文件传输是分散的， 而定位内容则是高度集中的==</p>
</blockquote>
<h5 id="完全分布式：查询洪泛（Gnutella）——非结构化">完全分布式：查询洪泛（Gnutella）——非结构化</h5>
<ul>
<li>全分布式
<ul>
<li>没有中心服务器</li>
</ul>
</li>
<li>开放文件共享协议</li>
<li>许多Gnutella客户端
<ul>
<li>实现了Gnutella协议</li>
<li>类似HTTP有许多的浏览器</li>
</ul>
</li>
</ul>
<h6 id="覆盖网络">覆盖网络</h6>
<ul>
<li>如果X和Y之间有一个 TCP 连接，则二者之间存在一条边</li>
<li>所有活动的对等方和边就是覆盖网络</li>
<li>边并不是物理链路</li>
<li>给定一个对等方，通常所连接的节点少于10个</li>
</ul>
<h6 id="协议">协议</h6>
<ul>
<li>在已有的TCP连接上发送查询报文</li>
<li>对等方转发查询报文</li>
<li>以反方向返回查询命中报文</li>
</ul>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/c45b5c83e934bc5a4919a9cd135cc789-Gnutella-275728.png"
                      style="zoom: 50%;" 
                >
<p>==可扩展性： 限制范围的洪泛查询==</p>
<h6 id="对等方加入">对等方加入</h6>
<ol>
<li>对等方X必须首先发现某些已经在覆盖网络中的其他对等方：使用可用对等方列表
<ul>
<li>自己维持一张对等方列表（经常开机的对等方的IP） 联系维持列表的Gnutella站点</li>
</ul>
</li>
<li>X接着试图与该列表上的对等方建立TCP连接，直到与某个对等方Y建立连接</li>
<li>X向Y发送一个Ping报文，Y转发该Ping报文</li>
<li>所有收到Ping报文的对等方以Pong报文响应 IP地址、共享文件的数量及总字节数</li>
<li>X收到许多Pong报文，然后它能建立其他TCP连接</li>
</ol>
<h5 id="混合体：利用不匀称性（KaZaA）——非结构化">混合体：利用不匀称性（KaZaA）——非结构化</h5>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/1a9ce6e0fe21ba5ecce671af61ff922d-KaZaA-55437d.png"
                      style="zoom:75%;" 
                >
<ul>
<li>每个对等方要么是一个组长，要么隶属于一个组长
<ul>
<li>对等方与其组长之间有 TCP 连接</li>
<li>组长对之间有TCP连接</li>
</ul>
</li>
<li>组长跟踪其所有的孩子的内容</li>
<li>组长与其他组长联系
<ul>
<li>转发查询到其他组长</li>
<li>获得其他组长的数据拷贝</li>
</ul>
</li>
</ul>
<h6 id="查询">查询</h6>
<ul>
<li>每个文件有一个散列标识码和一个描述符</li>
<li>客户端向其组长发送关键字查询</li>
<li>组长用匹配进行响应：
<ul>
<li>对每个匹配：元数据、散列标识码和IP地址</li>
</ul>
</li>
<li>如果组长将查询转发给其他组长，其他组长也可以匹配进行响应</li>
<li>客户端选择要下载的文件
<ul>
<li>向拥有文件的对等方发送一个带散列标识码的HTTP请求</li>
</ul>
</li>
</ul>
<h6 id="Kazaa小技巧">Kazaa小技巧</h6>
<ul>
<li>请求排队
<ul>
<li>限制并行上载的数量</li>
<li>确保每个被传输的文件从上载节点接收一定量的带宽</li>
</ul>
</li>
<li>激励优先权
<ul>
<li>鼓励用户上载文件</li>
<li>加强系统的扩展性</li>
</ul>
</li>
<li>并行下载
<ul>
<li>从多个对等方下载同一个文件的不同部分
<ul>
<li>HTTP的字节范围首部</li>
<li>更快地检索一个文件</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="Distributed-Hash-Table-DHT-——结构化-P2P">Distributed Hash Table (DHT)——结构化 P2P</h4>
<ul>
<li>哈希表</li>
<li>DHT方案</li>
<li>环形 DHT 以及覆盖网络</li>
<li>Peer波动</li>
</ul>
<h3 id="七、CDN——让内容靠近用户">七、CDN——让内容靠近用户</h3>
<h4 id="视频流化服务和CDN：上下文">视频流化服务和CDN：上下文</h4>
<ul>
<li>视频流量：占据着互联网大部分的带宽
<ul>
<li>Netflix, YouTube: 占据37%, 16% 的ISP下行流量</li>
<li>~1B YouTube 用户, ~75M Netflix用户</li>
</ul>
</li>
<li>挑战：规模性-如何服务者 ~1B 用户?
<ul>
<li>单个超级服务器无法提供服务（为什么）</li>
</ul>
</li>
<li>挑战：异构性
<ul>
<li>不同用户拥有不同的能力（例如：有线接入和移动用户；带宽丰富和受限用户）</li>
</ul>
</li>
<li>解决方案: 分布式的，应用层面的基础设施</li>
</ul>
<h4 id="视频">视频</h4>
<ul>
<li>视频：固定速度显示的图像序列
<ul>
<li>e.g. 24 images/sec</li>
</ul>
</li>
<li>网络视频特点：
<ul>
<li>高码率：&gt;10x于音频,高的网络带宽需求</li>
<li>可以被压缩</li>
<li>90%以上的网络流量是视频</li>
</ul>
</li>
<li>数字化图像：像素的阵列
<ul>
<li>每个像素被若干bits表示</li>
</ul>
</li>
<li>编码：使用图像内和图像间的冗余来降低编码的比特数
<ul>
<li>空间冗余(图像内)
<ul>
<li>空间编码例子： 不是发送N个相同的颜色（全部是紫色）值，仅仅发送2各值：颜色（紫色）和重复的个数 (N)</li>
</ul>
</li>
<li>时间冗余(相邻的图像间)
<ul>
<li>时间编码例子：不是发送第 <code>i+1</code> 帧的全部编码，而仅仅发送和帧 <code>i</code> 差别的地方</li>
</ul>
</li>
</ul>
</li>
<li>CBR: (constant bit rate): 以固定速率编码</li>
<li>VBR: (variable bit rate): 视频编码速率随 时间的变化而变化</li>
<li>例子:
<ul>
<li>MPEG 1 (CD-ROM) 1.5 Mbps</li>
<li>MPEG2 (DVD) 3-6 Mbps</li>
<li>MPEG4 (often used in Internet, &lt; 1 Mbps)</li>
</ul>
</li>
</ul>
<blockquote>
<h5 id="存储视频的流化服务">存储视频的流化服务</h5>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/0f9a9e05ebd8a9343a0502c768866c1d-%E5%AD%98%E5%82%A8%E8%A7%86%E9%A2%91%E7%9A%84%E6%B5%81%E5%8C%96%E6%9C%8D%E5%8A%A1-bf2920.png"
                      alt=""
                ></p>
</blockquote>
<h4 id="多媒体流化服务：DASH">多媒体流化服务：DASH</h4>
<ul>
<li>
<p>DASH: Dynamic, Adaptive Streaming over HTTP</p>
</li>
<li>
<p>服务器:</p>
<ul>
<li>将视频文件分割成多个块</li>
<li>每个块独立存储，编码于不同码率（8-10种）</li>
<li>告示文件（manifest file）: 提供不同块的URL</li>
</ul>
</li>
<li>
<p>客户端:</p>
<ul>
<li>先获取告示文件</li>
<li>周期性地测量服务器到客户端的带宽</li>
<li>查询告示文件,在一个时刻请求一个块，HTTP头部指定字节范围
<ul>
<li>如果带宽足够，选择最大码率的视频块</li>
<li>会话中的不同时刻，可以切换请求不同的编码块 (取决于当时的可用带宽)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>“智能”客户端: 客户端自适应决定</p>
<ul>
<li>什么时候去请求块 (不至于缓存挨饿，或者溢出)</li>
<li>请求什么编码速率的视频块 (当带宽够用时，请求高质量的视频块)</li>
<li>哪里去请求块 (可以向离自己近的服务器发送URL，或者向高可用带宽的服务器请求)</li>
</ul>
</li>
</ul>
<h4 id="Content-Distribution-Networks（CDNs）">Content Distribution Networks（CDNs）</h4>
<p><strong>==挑战: 服务器如何通过网络向上百万用户同时流化视频内容 (上百万视频内容)?==</strong></p>
<h6 id="选择1-单个的、大的超级服务中心“megaserver”">选择1: 单个的、大的超级服务中心“megaserver”</h6>
<ul>
<li>服务器到客户端路径上跳数较多，瓶颈链路的带宽小导致停顿</li>
<li>“二八规律”决定了网络同时充斥着同一个视频的多个拷贝，效率低（付费高、带宽浪费、效果差）</li>
<li>单点故障点，性能瓶颈</li>
<li>周边网络的拥塞</li>
</ul>
<p>==评述：相当简单，但是这个方法不可扩展==</p>
<h6 id="选项2-通过CDN，全网部署缓存节点，存储服务内容，就近为用户提供服务，提高用户体验">选项2: 通过CDN，全网部署缓存节点，存储服务内容，就近为用户提供服务，提高用户体验</h6>
<ul>
<li>enter deep: 将CDN服务器深入到许多接入网
<ul>
<li>更接近用户，数量多，离用户近，管理困难</li>
<li>Akamai, 1700个位置</li>
</ul>
</li>
<li>bring home: 部署在少数(10个左右)关键位置，如将服务器簇安装于POP附近（离若干1stISP POP较近）
<ul>
<li>采用租用线路将服务器簇连接起来</li>
<li>Limelight</li>
</ul>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/6db80bf91fb4f121fbd981e9e8c1b033-CDNS-4c99c1.png"
                      alt=""
                ></p>
<ul>
<li>CDN: 在CDN节点中存储内容的多个拷贝
<ul>
<li>e.g. Netflix stores copies of MadMen</li>
</ul>
</li>
<li>用户从CDN中请求内容
<ul>
<li>重定向到最近的拷贝，请求内容</li>
<li>如果网络路径拥塞，可能选择不同的拷贝</li>
</ul>
</li>
</ul>
<blockquote>
<h6 id="OTT-挑战-在拥塞的互联网上复制内容">OTT 挑战: 在拥塞的互联网上复制内容</h6>
<ul>
<li>从哪个CDN节点中获取内容？</li>
<li>用户在网络拥塞时的行为？</li>
<li>在哪些CDN节点中存储什么内容？</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/319f844292f81428a18bbc8478d0ca20-over%20the%20top-ae8137.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h5 id="CDN-“简单”内容访问场景">CDN:“简单”内容访问场景</h5>
<ul>
<li>
<p>Bob(客户端)请求视频<a class="link"   target="_blank" rel="noopener" href="http://netcinema.com/6Y7B23V" >http://netcinema.com/6Y7B23V <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</li>
<li>
<p>视频存储在CDN，位于<a class="link"   target="_blank" rel="noopener" href="http://KingCDN.com/NetC6y&amp;B23V" >http://KingCDN.com/NetC6y&amp;B23V <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/0a86688215e868c0bab9d7439d7ac26f-%E7%AE%80%E5%8D%95%E5%86%85%E5%AE%B9%E8%AE%BF%E9%97%AE%E5%9C%BA%E6%99%AF-f55f6e.png"
                      alt=""
                ></p>
</blockquote>
<h4 id="Netflix">Netflix</h4>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/8a5a5d62fd7007597a5b844d6805d9c2-Netflix-baad9d.png"
                      style="zoom:50%;" 
                >
<h3 id="八、TCP-套接字编程">八、TCP 套接字编程</h3>
<blockquote>
<p>应用进程使用传输层提供的服务才能够交换报文，实现应用协议，实现应用</p>
</blockquote>
<ul>
<li>TCP/IP：应用进程使用Socket API访问传输服务</li>
<li>地点：界面上的SAP(Socket） 方式：Socket API</li>
</ul>
<p>目标: 学习如何构建能借助sockets进行通信的C/S应用程序</p>
<p>socket: 分布式应用进程之间的门，传输层协议提供的端到端服务接口</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/b4f263fdcaf71bafcef7ba664947f445-socket%E7%BC%96%E7%A8%8B-dfb52b.png"
                      alt=""
                ></p>
<blockquote>
<h4 id="2种传输层服务的socket类型">2种传输层服务的socket类型:</h4>
<ul>
<li>TCP: 可靠的、字节流的服务</li>
<li>UDP: 不可靠（数据UDP数据报）服务</li>
</ul>
</blockquote>
<h4 id="TCP套接字编程">TCP套接字编程</h4>
<blockquote>
<ul>
<li>套接字：应用进程与端到端传输协议（TCP或UDP）之间的门户</li>
<li>TCP服务：从一个进程向另一个进程可靠地传输字节流</li>
</ul>
</blockquote>
<h5 id="服务器首先运行，等待连接建立">服务器首先运行，等待连接建立</h5>
<ol>
<li>
<p>服务器进程必须先处于运行状态</p>
<ul>
<li>
<p>创建欢迎socket</p>
</li>
<li>
<p>和本地端口捆绑</p>
</li>
<li>
<p>在欢迎socket上阻塞式等待接收用户的连接</p>
</li>
</ul>
</li>
</ol>
<h5 id="客户端主动和服务器建立连接：">客户端主动和服务器建立连接：</h5>
<ol start="2">
<li>创建客户端本地套接字（隐式捆绑到本地port）
<ul>
<li>指定服务器进程的IP地址和端口号，与服务器进程连接</li>
</ul>
</li>
<li>当与客户端连接请求到来时
<ul>
<li>服务器接受来自用户端的请求 ，解除阻塞式等待，返回一个新的socket（与欢迎socket不 一样），与客户端通信
<ul>
<li>允许服务器与多个客户端通信</li>
<li>使用源IP和源端口来区分不同的客户端</li>
</ul>
</li>
</ul>
</li>
<li>连接API调用有效时，客户端P与服务器建立了TCP连接</li>
</ol>
<blockquote>
<h3 id="从应用程序的角度">从应用程序的角度</h3>
<p>TCP 在客户端和服务器进程之间提供了可靠的、字节流（管道）服务</p>
</blockquote>
<blockquote>
<h4 id="C-S模式的应用样例">C/S模式的应用样例</h4>
<ol>
<li>客户端从标准输入装置读取一行字符，发送给服务器</li>
<li>服务器从socket读取字符</li>
<li>服务器将字符转换成大写 ，然后返回给客户端</li>
<li>客户端从socket中读取一行字符，然后打印出来</li>
</ol>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/e933aec52f18ec87b7a023fdf944c370-TCP-socket%E7%BC%96%E7%A8%8B-b96db1.png"
                      style="zoom:50%;" 
                >
<p>==实际上，这里描述了C-S之间交互的动作次序==</p>
</blockquote>
<h4 id="C-S-socket-交互-TCP">C/S socket 交互: TCP</h4>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/4cb6bf23f9baa013ec4937907fe1760d-CS-socket%E4%BA%A4%E4%BA%92-092fd1.png"
                      style="zoom:50%;" 
                >
<h4 id="数据结构">数据结构</h4>
<h5 id="sockaddr-in">sockaddr_in</h5>
<blockquote>
<p>IP地址和port捆绑关系的数据结构（标示进程的端节点）</p>
</blockquote>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> &#123;</span></span><br><span class="line">	<span class="type">short</span> sin_family; <span class="comment">// AF_INET</span></span><br><span class="line">    u_short sin_port; <span class="comment">// port</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">in_addr</span> <span class="title">sin_addr</span>;</span> <span class="comment">// IP address, unsigned long</span></span><br><span class="line">    <span class="type">char</span> sin_zero[<span class="number">8</span>]; <span class="comment">// align</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h5 id="hostent">hostent</h5>
<blockquote>
<p>域名和IP地址的数据结构</p>
<ul>
<li>作为调用域名解析函数时的参数</li>
<li>返回后，将IP地址拷贝到 sockaddr_in的IP地址部分</li>
</ul>
</blockquote>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">hostent</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> *h_name;</span><br><span class="line">    <span class="type">char</span> **h_aliases;</span><br><span class="line">    <span class="type">int</span> h_addrtype;</span><br><span class="line">    <span class="type">int</span> h_length;	<span class="comment">// 地址长度</span></span><br><span class="line">    <span class="type">char</span> **h_addr_list;</span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> h_addr h_addr_list[0];</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<blockquote>
<h4 id="例子-C-客户端-TCP">例子: C 客户端(TCP)</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/db3531ed6c5d1b27ba3cf9dfcef9ef05-client_TCP-3c3e79.png"
                      alt=""
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/bb24a0129b4a589b5d92bfb5c148f1c8-client_TCP1-1492e1.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h4 id="例子：C-服务器（TCP）">例子：C 服务器（TCP）</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/9810b85fce12692e0bb702afff7878dd-server_TCP-1f6c7a.png"
                      alt=""
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/c325a8a9afa481287c79f1e6b375d8fc-server_TCP1-241d49.png"
                      alt=""
                ></p>
</blockquote>
<h3 id="九、UDP-Socket编程">九、UDP Socket编程</h3>
<blockquote>
<h5 id="UDP-在客户端和服务器之间没有连接">UDP: 在客户端和服务器之间没有连接</h5>
<ul>
<li>
<p>没有握手</p>
</li>
<li>
<p>发送端在每一个报文中明确地指定目标的IP地址和端口号</p>
</li>
<li>
<p>服务器必须从收到的分组中 提取出发送端的IP地址和端口号</p>
</li>
</ul>
<p>==UDP: 传送的数据可能乱序，也可能丢失==</p>
</blockquote>
<blockquote>
<h3 id="进程视角看UDP服务">进程视角看UDP服务</h3>
<p>UDP 为客户端和服务器提供不可靠的字节组的传送服务</p>
</blockquote>
<h4 id="C-S-socket-交互-TCP-2">C/S socket 交互: TCP</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/5c2284d67c9dc124288c4725abaa11fc-CS-socket%E4%BA%A4%E4%BA%92UDP-e32263.png"
                      alt=""
                ></p>
<blockquote>
<h4 id="样例-C客户端-UDP">样例: C客户端 (UDP)</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/7c1ac417cf931c091314ee8529221671-client_UDP-a4806b.png"
                      alt=""
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/13fd97c6e6b099435b4da1e941a81560-client_UDP1-4d7ab2.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h4 id="样例-C服务器-UDP">样例: C服务器(UDP)</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/f4bdf05d314b78dab95206d059e66395-server_UDP-9cc486.png"
                      alt=""
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/f0a3fd2dc1e00fcfc07453437077b3aa-server_UDP1-830c93.png"
                      alt=""
                ></p>
</blockquote>
<h3 id="十、小结">十、小结</h3>
<ul>
<li>应用程序体系结构
<ul>
<li>客户-服务器</li>
<li>P2P</li>
<li>混合</li>
</ul>
</li>
<li>应用程序需要的服务品质描述:
<ul>
<li>可靠性、带宽、延时、安全</li>
</ul>
</li>
<li>Internet传输层服务模式
<ul>
<li>可靠的、面向连接的服务： TCP</li>
<li>不可靠的数据报：UDP Application Layer 3-154</li>
</ul>
</li>
<li>流行的应用层协议:
<ul>
<li>HTTP、FTP、SMTP、POP、IMAP、DNS</li>
</ul>
</li>
<li>Socket编程</li>
</ul>
<blockquote>
<h5 id="更重要的：学习协议的知识">更重要的：学习协议的知识</h5>
<ul>
<li>应用层协议报文类型：请求/响应报文：
<ul>
<li>客户端请求信息或服务</li>
<li>服务器以数据、状态码进行响应</li>
</ul>
</li>
<li>报文格式：
<ul>
<li>首部：关于数据信息的字段</li>
<li>数据：被交换的信息</li>
</ul>
</li>
<li>控制报文 vs. 数据报文
<ul>
<li>带内、带外</li>
</ul>
</li>
<li>集中式 vs. 分散式</li>
<li>无状态 vs. 维护状态</li>
<li>可靠的 vs. 不可靠的报文 传输</li>
<li>在网络边缘处理复杂性</li>
</ul>
<p>==一个协议定义了在两个或多个通信实体之间交换报文的格式和次序、以及就一条报文传输和接收或其他事件采取的动作==</p>
</blockquote>
<h2 id="第三章-传输层">第三章 传输层</h2>
<blockquote>
<h4 id="目标">目标</h4>
<ul>
<li>理解传输层的工作原理
<ul>
<li>多路复用/解复用</li>
<li>可靠数据传输</li>
<li>流量控制</li>
<li>拥塞控制</li>
</ul>
</li>
<li>学习Internet的传输层协议
<ul>
<li>UDP：无连接传输</li>
<li>TCP：面向连接的可靠传输</li>
<li>TCP的拥塞控制</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="一、概述和传输层服务">一、概述和传输层服务</h3>
<h4 id="传输服务和协议">传输服务和协议</h4>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/89a2ba4a0e8fa8b2d798444fa9dc1879-%E4%BC%A0%E8%BE%93%E6%9C%8D%E5%8A%A1%E5%92%8C%E5%8D%8F%E8%AE%AE-4ffa67.png"
                      style="zoom: 67%;" 
                >
<ul>
<li>为运行在不同主机上的应用进程提供 ==逻辑通信==</li>
<li>传输协议运行在端系统
<ul>
<li>发送方：将应用层的报文分成 ==报文段==，然后传递给网络层</li>
<li>接收方：将报文段重组成报文，然后传递给应用层</li>
</ul>
</li>
<li>有多个传输层协议可供应用选择
<ul>
<li>Internet: TCP和UDP</li>
</ul>
</li>
</ul>
<blockquote>
<h4 id="传输层-vs-网络层">传输层 vs. 网络层</h4>
<ul>
<li>网络层服务：主机之间的逻辑通信</li>
<li>传输层服务：进程间的逻辑通信
<ul>
<li>依赖于网络层的服务
<ul>
<li>延时、带宽</li>
</ul>
</li>
<li>并对网络层的服务进行增强
<ul>
<li>数据丢失、顺序混乱、加密</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<h5 id="例子：东西2个家庭的通信">例子：东西2个家庭的通信</h5>
<ul>
<li>Ann家的12个小孩给另Bill家的12个小孩发信
<ul>
<li>主机 = 家庭</li>
<li>进程 = 小孩</li>
<li>应用层报文= 信封中的信件</li>
<li>传输协议= Ann 和 Bill
<ul>
<li>为家庭小孩提供复用解复用服 务</li>
</ul>
</li>
<li>网络层协议 = 邮政服务
<ul>
<li>家庭-家庭的邮包传输服务</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<p>==有些服务是可以加强的：不可靠 -&gt; 可靠；安全==</p>
<p>==但有些服务是不可以被加强的：带宽，延迟==</p>
</blockquote>
<h4 id="Internet传输层协议">Internet传输层协议</h4>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/960138159317f55fc42f941d3427f9cd-internet%E4%BC%A0%E8%BE%93%E5%B1%82%E5%8D%8F%E8%AE%AE-03a5b8.png"
                      style="zoom:50%;" 
                >
<ul>
<li>可靠的、保序的传输： TCP
<ul>
<li>多路复用、解复用</li>
<li>拥塞控制</li>
<li>流量控制</li>
<li>建立连接</li>
</ul>
</li>
<li>不可靠、不保序的传输：UDP
<ul>
<li>多路复用、解复用</li>
<li>没有为尽力而为的IP服务添加更多的其它额外服务</li>
</ul>
</li>
<li>都不提供的服务：
<ul>
<li>延时保证</li>
<li>带宽保证</li>
</ul>
</li>
</ul>
<h3 id="二、多路复用与解复用">二、多路复用与解复用</h3>
<blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/9e49a6c015b3adbfddbae64baa53d4cf-%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E4%B8%8E%E8%A7%A3%E5%A4%8D%E7%94%A8-018230.png"
                      alt=""
                ></p>
</blockquote>
<h4 id="多路解复用工作原理">多路解复用工作原理</h4>
<p><strong>==TCP 和 UDP 不同==</strong></p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/e62969d88852dfedf3ea3a5b16c7c6b1-TCP-UDP%E6%8A%A5%E6%96%87%E6%AE%B5%E6%A0%BC%E5%BC%8F-7c7408.png"
                      style="zoom:50%;" 
                >
<ul>
<li>解复用作用
<ul>
<li>TCP或者UDP实体采用哪些信息，将报文段的数据部分交给正确的socket，从而交给正确的进程</li>
</ul>
</li>
<li>主机收到IP数据报
<ul>
<li>每个数据报有源IP地址和目标地址</li>
<li>每个数据报承载一个传输层报文段</li>
<li>每个报文段有一个源端口号和目标端口号 (特定应用有著名的端口号)</li>
</ul>
</li>
<li>主机联合使用 ==IP地址== 和 ==端口号== 将报文段发送给合适的套接字</li>
</ul>
<h4 id="无连接-UDP-多路解复用">无连接(UDP)多路解复用</h4>
<blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/56a893bfdf0ac3122ca58c16e9dcc0d5-UDP-socket-7bd3e3.png"
                      alt=""
                ></p>
</blockquote>
<ul>
<li>创建套接字</li>
</ul>
<blockquote>
<h4 id="服务器端：">服务器端：</h4>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">serverSocket=socket(PF_INET, SOCK_DGRAM,<span class="number">0</span>);</span><br><span class="line">bind(serverSocket, &amp;sad, <span class="keyword">sizeof</span>(sad)); <span class="comment">// serverSocket和Sad指定的端口号捆绑</span></span><br></pre></td></tr></table></figure></div>
</blockquote>
<blockquote>
<h4 id="客户端：">客户端：</h4>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 没有Bind,ClientSocket和OS为之分配的某个端口号捆绑</span></span><br><span class="line"><span class="comment">// 客户端使用什么端口号无所谓，客户端主动找服务器</span></span><br><span class="line">ClientSocket=socket(PF_INET, SOCK_DGRAM,<span class="number">0</span>);</span><br></pre></td></tr></table></figure></div>
</blockquote>
<p><strong>==UDP和TCP不同==</strong></p>
<ul>
<li>在接收端，UDP套接字用二元组标识 (==目标IP地址、目标端口号==)</li>
<li>当主机收到UDP报文段：
<ul>
<li>检查报文段的目标端口号</li>
<li>用该端口号将报文段定位给套接字</li>
</ul>
</li>
<li>如果两个不同源IP地址/源端口号的数据报，但是 ==有相同的目标IP地址和端口号==，则被定<br>
位到相同的套接字</li>
</ul>
<blockquote>
<h6 id="回顾">回顾</h6>
<ul>
<li>
<p>创建拥有本地端口号的套接字</p>
  <div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DatagramSocket mySocket1 = new DatagramSocket(<span class="number">12534</span>);</span><br></pre></td></tr></table></figure></div>
</li>
<li>
<p>当创建UDP段采用端口号，可以指定</p>
<ul>
<li>目标 IP 地址</li>
<li>目标端口号</li>
</ul>
</li>
</ul>
</blockquote>
<ul>
<li>当主机接收到UDP段时：
<ul>
<li>检查UDP段中的目标端口号</li>
<li>将UDP段交给具备那个端口号的套接字</li>
</ul>
</li>
</ul>
<blockquote>
<p>具备 ==相同目标IP地址和目标端口号==，即使是 ==源IP地址或/且源端口号的IP数据报==，将会被传到相同的目标UDP套接字上</p>
</blockquote>
<blockquote>
<h4 id="无连接多路复用例子">无连接多路复用例子</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/a30704c2dccad1fc12815af98eac539e-%E6%97%A0%E8%BF%9E%E6%8E%A5%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E4%BE%8B%E5%AD%90-d0c939.png"
                      alt=""
                ></p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">serverSocket = serverSocket=socket(PF_INET,SOCK_DGRAM,<span class="number">0</span>);</span><br><span class="line">bind(serverSocket, sad, <span class="keyword">sizeof</span>(sad));</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/acbfe47d9dfa769e05dd37aef21ce163-%E6%97%A0%E8%BF%9E%E6%8E%A5%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E4%BE%8B%E5%AD%901-3bc3f4.png"
                      alt=""
                ></p>
</blockquote>
<h4 id="面向连接-TCP-的多路复用">面向连接(TCP)的多路复用</h4>
<ul>
<li>TCP套接字:四元组本地标识
<ul>
<li>源IP地址、源端口号、目的IP地址、目的端口号</li>
</ul>
</li>
<li>解复用：接收主机用这四个值来将数据报定位到合适的套接字</li>
<li>服务器能够在一个TCP端口上同时支持多个TCP套接字
<ul>
<li>每个套接字由其四元组标识（有不同的源IP和源PORT）</li>
</ul>
</li>
<li>Web服务器对每个连接客户端有不同的套接字
<ul>
<li>非持久对每个请求有不同的套接字</li>
</ul>
</li>
</ul>
<blockquote>
<h4 id="面向连接的解复用例子">面向连接的解复用例子</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/8d8fef83cbc39f80ca806c3d93871672-%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E8%A7%A3%E5%A4%8D%E7%94%A8%E4%BE%8B%E5%AD%90-d8b621.png"
                      alt=""
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/8d8fef83cbc39f80ca806c3d93871672-%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E8%A7%A3%E5%A4%8D%E7%94%A8%E4%BE%8B%E5%AD%90-d8b621.png"
                      alt=""
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/36cfd8aa55e841b98cd2c590831ba497-%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E8%A7%A3%E5%A4%8D%E7%94%A8%E4%BE%8B%E5%AD%902-419e24.png"
                      alt=""
                ></p>
</blockquote>
<h4 id="面向连接的多路复用：多线程-Web-Server">面向连接的多路复用：多线程 Web Server</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/11f1d947c363b3b14a4905e87044ed43-%E5%A4%9A%E7%BA%BF%E7%A8%8BWeb%20server-e30fc2.png"
                      alt=""
                ></p>
<ul>
<li>一个进程下面可能有多个线程：由多个线程分别为客户提供服务</li>
<li>在这个场景下，还是根据4元组决定将报文段内容同一个进程下的不同线程</li>
<li>解复用到不同线程</li>
</ul>
<h3 id="三、无连接传输：UDP">三、无连接传输：UDP</h3>
<p>用户数据报协议（UDP，User Datagram Protocol [RFC 768]）</p>
<ul>
<li>“no frills,” “bare bones”Internet传输协议</li>
<li>“尽力而为”的服务，报文段可能 ==丢失==、 ==送到应用进程的报文段乱序==</li>
<li>无连接：
<ul>
<li>UDP发送端和接收端之间没有握手</li>
<li>每个UDP报文段都被独立地处理</li>
</ul>
</li>
<li>UDP 被用于:
<ul>
<li>流媒体（丢失不敏感， 速率敏感、应用可控制传输速率）</li>
<li>DNS</li>
<li>SNMP</li>
</ul>
</li>
<li>在UDP上可行可靠传输:
<ul>
<li>在应用层增加可靠性</li>
<li>应用特定的差错恢复</li>
</ul>
</li>
</ul>
<blockquote>
<h6 id="为什么要有UDP">为什么要有UDP?</h6>
<ul>
<li>不建立连接（会增加延时 ）</li>
<li>简单：在发送端和接收端没有连接状态</li>
<li>报文段的头部很小(开销小)</li>
<li>无拥塞控制和流量控制： UDP可以尽可能快的发送报文段
<ul>
<li>应用-&gt;传输的速率 = 主机-&gt;网络的速率</li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<h4 id="UDP报文段格式">UDP报文段格式</h4>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/e7ac66ad3173ebfe4a84755ff736de3e-UDP%E6%8A%A5%E6%96%87%E6%AE%B5%E6%A0%BC%E5%BC%8F-6ce194.png"
                      style="zoom:50%;" 
                >
</blockquote>
<h4 id="UDP校验和">UDP校验和</h4>
<ul>
<li>
<p>目标</p>
<ul>
<li>检测在被传输报文段中的差错 (如比特反转)</li>
</ul>
</li>
<li>
<p>发送方</p>
<ul>
<li>将报文段的内容视为 16 比特的整数</li>
<li>校验和：报文段的加法和（1的补运算）</li>
<li>发送方将校验和放在UDP的校验和字段</li>
</ul>
</li>
<li>
<p>接收方</p>
<ul>
<li>计算接收到的报文段的校验和</li>
<li>检查计算出的校验和与校验和字段的内容是否相等：
<ul>
<li>不相等––检测到差错</li>
<li>相等––没有检测到差错 ，但也许还是有差错
<ul>
<li>残存错误</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<h4 id="Internet校验和的例子">Internet校验和的例子</h4>
<h5 id="注意-：当数字相加时，在最高位的进位要回卷，再加到结果上">==注意==：当数字相加时，在最高位的进位要回卷，再加到结果上</h5>
<h6 id="例子：两个16比特的整数相加">==例子：两个16比特的整数相加==</h6>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/a3db892eb50795895d4e6362dda184be-%E4%B8%A4%E4%B8%AA16bit%E7%9A%84%E6%95%B4%E6%95%B0%E7%9B%B8%E5%8A%A0-920ebe.png"
                      alt=""
                ></p>
<ul>
<li>目标端：校验范围+校验和=1111111111111111 通过校验，否则没有通过校验</li>
</ul>
<p><strong>==注：求和时，必须将进位回卷到结果上==</strong></p>
</blockquote>
<h3 id="四、可靠数据传输（rdt）的原理">四、可靠数据传输（rdt）的原理</h3>
<blockquote>
<ul>
<li>
<p><code>rdt</code> 在应用层、传输层和数据链路层都很重要</p>
</li>
<li>
<p>是网络 Top 10 问题之一</p>
</li>
<li>
<p>信道的不可靠特点决定了可靠数据传输协议（ rdt ）的复杂性</p>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/4bb42ea250b3b5e707433d58fa4ad9ed-rdt-149c30.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h6 id="可靠数据传输：问题描述">可靠数据传输：问题描述</h6>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/ac19728a64674d60eb0b4124d2829f52-%E5%8F%AF%E9%9D%A0%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E7%9A%84%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0-fcc1b8.png"
                      alt=""
                ></p>
<h6 id="要做的事：">要做的事：</h6>
<ul>
<li>渐增式地开发可靠数据传输协议（ rdt ）的发送方和接收方</li>
<li>只考虑单向数据传输
<ul>
<li>==但控制信息是双向流动的！==</li>
</ul>
</li>
<li>双向的数据传输问题实际上是2个单向数据传输问题的综合</li>
<li>使用有限状态机 (FSM) 来描述发送方和接收方</li>
</ul>
</blockquote>
<h4 id="Rdt1-0：在可靠信道上的可靠数据传输">Rdt1.0：在可靠信道上的可靠数据传输</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/2adf0b4814766ba7b0e830202efa5261-rdt1.0-76870d.png"
                      alt=""
                ></p>
<ul>
<li>下层的信道是完全可靠的
<ul>
<li>没有比特出错</li>
<li>没有分组丢失</li>
</ul>
</li>
<li>发送方和接收方的FSM
<ul>
<li>发送方将数据发送到下层信道</li>
<li>接收方从下层信道接收数据</li>
</ul>
</li>
</ul>
<h4 id="Rdt2-0：具有比特差错的信道">Rdt2.0：具有比特差错的信道</h4>
<ul>
<li>下层信道可能会出错：将分组中的比特翻转
<ul>
<li>用校验和来检测比特差错</li>
</ul>
</li>
<li>问题：怎样从差错中恢复：
<ul>
<li>==确认(ACK)==：接收方显式地告诉发送方分组已被正确接收</li>
<li>==否定确认( NAK)==: 接收方显式地告诉发送方分组发生了差错
<ul>
<li>发送方收到NAK后，发送方重传分组</li>
</ul>
</li>
</ul>
</li>
<li>rdt2.0中的新机制：采用差错控制编码进行差错检测
<ul>
<li>发送方差错控制编码、缓存</li>
<li>接收方使用编码检错</li>
<li>接收方的反馈：控制报文（ACK，NAK）：接收方 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\to</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span> 发送方</li>
<li>发送方收到反馈相应的动作</li>
</ul>
</li>
</ul>
<blockquote>
<h4 id="FSM-描述">FSM 描述</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/d3aeafc20a34b6512051584ac7785dff-rdt2.0%20FSM%E6%8F%8F%E8%BF%B0-e18fc6.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h4 id="rdt2-0：ACK和NCK操作">rdt2.0：ACK和NCK操作</h4>
<h6 id="ACK（无差错）">==ACK（无差错）==</h6>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/3917f211f54050fd2146bb7007169ade-rdt2.0%E6%B2%A1%E6%9C%89%E5%B7%AE%E9%94%99%E6%97%B6%E7%9A%84%E6%93%8D%E4%BD%9C-a59995.png"
                      alt=""
                ></p>
<h6 id="NAK（有差错）">==NAK（有差错）==</h6>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/03018d28ed39f7a3462632704136944b-NAK-1b35bc.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h5 id="rdt2-0的致命缺陷！">rdt2.0的致命缺陷！</h5>
<ul>
<li>如果ACK/NAK出错？
<ul>
<li>发送方不知道接收方发生了什么事情！</li>
<li>发送方如何做？
<ul>
<li>重传？可能重复</li>
<li>不重传？可能死锁(或出错)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 id="需要引入新的机制：序号">==需要引入新的机制：序号==</h6>
<ul>
<li>处理重复：
<ul>
<li>发送方在每个分组中加入序号</li>
<li>如果ACK/NAK出错，发送方重传当前分组</li>
<li>接收方丢弃（不发给上层）重复分组</li>
</ul>
</li>
</ul>
<blockquote>
<h6 id="停等协议">停等协议</h6>
<p>发送方发送一个分组， 然后等待接收方的应答</p>
</blockquote>
</blockquote>
<h4 id="rdt2-1">rdt2.1</h4>
<blockquote>
<h4 id="发送方处理出错的ACK-NAK">发送方处理出错的ACK/NAK</h4>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/b0175fffc95322055d6b16a3d6c54611-rdt2.1-2079ab.png"
                       
                >
</blockquote>
<blockquote>
<h4 id="接收方处理出错的ACK-NAK">接收方处理出错的ACK/NAK</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/aca2cbbfd735b099c5dfa0698bacd530-rdt2.1_2-1397a1.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h3 id="讨论">讨论</h3>
<blockquote>
<h4 id="发送方：">发送方：</h4>
<ul>
<li>在分组中加入序列号</li>
<li>两个序列号（0，1）就足够了
<ul>
<li>一次只发送一个未经确认的分组</li>
</ul>
</li>
<li>必须检测ACK/NAK是否出错（需要EDC ）
<ul>
<li>状态数变成了两倍</li>
<li>必须记住当前分组的序列号为0还是1</li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<h4 id="接收方">接收方</h4>
<ul>
<li>必须检测接收到的分组是否是重复的
<ul>
<li>状态会指示希望接收到的分组的序号为0还是1</li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<h5 id="注意">注意</h5>
<p>接收方不知道它最后发送的ACK/NAK是否被正确地收到</p>
<ul>
<li>发送方不对收到的ack/nak给确认，没有所谓的确认的确认</li>
<li>接收方发送ack，如果后面接收方收到的是：
<ul>
<li>老分组p0？则ack 错误</li>
<li>下一个分组？P1，ack正确</li>
</ul>
</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/a192060e3b00c64c8690b36d190f62ed-rdt2.1%E7%9A%84%E8%BF%90%E8%A1%8C-6af13f.png"
                      alt=""
                ></p>
</blockquote>
</blockquote>
<h4 id="rdt2-2：无NAK的协议">rdt2.2：无NAK的协议</h4>
<ul>
<li>功能同rdt2.1，但只使用ACK(ack 要编号）</li>
<li>接收方对最后正确接收的分组发ACK，以替代NAK
<ul>
<li>接收方必须显式地包含被正确接收分组的序号</li>
</ul>
</li>
<li>当收到重复的ACK（如：再次收到ack0）时，发送方与收到NAK采取相同的动作：重传当前分组</li>
<li>为后面的一次发送多个数据单位做一个准备
<ul>
<li>一次能够发送多个</li>
<li>每一个的应答都有：ACK，NACK；麻烦</li>
<li>使用对前一个数据单位的ACK，代替本数据单位的nak</li>
<li>确认信息减少一半，协议处理简单</li>
</ul>
</li>
</ul>
<blockquote>
<h4 id="rdt2-2的运行">rdt2.2的运行</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/30687438f503abfdcd1f6259bf62557f-rdt2.2%E7%9A%84%E8%BF%90%E8%A1%8C-96a819.png"
                      alt=""
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/734fad7b750f3e9cedc3ac54e564c424-rdt2.2%E7%9A%84%E8%BF%90%E8%A1%8C_2-1a026c.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h4 id="rdt2-2：发送方和接收方片断">rdt2.2：发送方和接收方片断</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/bbcc6117cc34fddcb958cf50432e687f-rdt2.2%E5%8F%91%E9%80%81%E6%96%B9%E5%92%8C%E6%8E%A5%E6%94%B6%E6%96%B9%E7%89%87%E6%96%AD-692133.png"
                      alt=""
                ></p>
</blockquote>
<h4 id="rdt3-0：具有比特差错和分组丢失的信道">rdt3.0：具有比特差错和分组丢失的信道</h4>
<ul>
<li>
<p>新的假设：下层信道可能会丢失分组（数据或ACK）</p>
<ul>
<li>会死锁</li>
<li>机制还不够处理这种状况：
<ul>
<li>检验和、序列号、ACK、重传</li>
</ul>
</li>
</ul>
</li>
<li>
<p>方法：发送方等待ACK一段 ==合理的时间==</p>
<blockquote>
<p>链路层的timeout时间是确定的</p>
<p>传输层timeout时间是适应式的</p>
</blockquote>
<ul>
<li>发送端超时重传：如果到时没有收到ACK-&gt;重传</li>
<li>问题：如果分组（或ACK ）只是被延迟了：
<ul>
<li>重传将会导致数据重复，但利用序列号已经可以处理这个问题</li>
<li>接收方必须指明被正确接收的序列号</li>
</ul>
</li>
<li>需要一个倒计数定时器</li>
</ul>
</li>
</ul>
<blockquote>
<h4 id="发送方">发送方</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/38f3962fc553d0dc609b9bf587a8bcdc-rdt3.0%E5%8F%91%E9%80%81%E6%96%B9-8d92b3.png"
                      alt=""
                ></p>
</blockquote>
<blockquote>
<h4 id="rdt3-0的运行">rdt3.0的运行</h4>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/5f3878e5257705e90e955929d2a6198f-rdt3.0%E7%9A%84%E8%BF%90%E8%A1%8C-bd6383.png"
                      alt=""
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/coderlubo/blogimages@main/images/2023/03/08/eada2a8306f081050467e429d7474ca7-rdt3.0%E7%9A%84%E8%BF%90%E8%A1%8C_2-36b840.png"
                      alt=""
                ></p>
<ul>
<li>过早超时（延迟的ACK）也能够正常工作；但是效率较低，一半的分组和确认是重复的；</li>
<li>设置一个合理的超时时间也是比较重要的；</li>
</ul>
</blockquote>
<blockquote>
<h3 id="rdt3-0的性能">rdt3.0的性能</h3>
<p>rdt3.0可以工作，但链路容量比较大的情况下，性能很差</p>
<ul>
<li>链路容量比较大，一次发一个PDU的不能够充分利用链路的传输能力</li>
</ul>
</blockquote>

            </div>

            
                <div class="post-copyright-info">
                    <div class="article-copyright-info-container">
    <ul>
        <li>Post title：计算机网络</li>
        <li>Post author：Lubo</li>
        <li>Create time：2021-10-09 00:00:00</li>
        <li>
            Post link：https://coderlubo.github.io/posts/28758/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">#基础知识</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/Network/">#Network</a>&nbsp;
                        </li>
                    
                </ul>
            

            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                            rel="prev"
                            href="/posts/58205/"
                            >
                                <span class="left arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </span>
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">Moonbeam</span>
                                    <span class="post-nav-item">Prev posts</span>
                                </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                            rel="next"
                            href="/posts/15866/"
                            >
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">以太坊</span>
                                    <span class="post-nav-item">Next posts</span>
                                </span>
                                <span class="right arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </span>
                            </a>
                        </div>
                    
                </div>
            


            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">计算机网络</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-text">计算机网络</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-text">2021年10月9日</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A6%82%E8%BF%B0"><span class="nav-text">第一章 计算机网络概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF-Internet"><span class="nav-text">一、什么是 Internet</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-Internet-%E2%80%94%E2%80%94-%E4%BB%8E%E5%85%B7%E4%BD%93%E6%9E%84%E6%88%90%E8%A7%92%E5%BA%A6"><span class="nav-text">什么是 Internet —— 从具体构成角度</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-Internet-%E2%80%94%E2%80%94-%E4%BB%8E%E6%9C%8D%E5%8A%A1%E8%A7%92%E5%BA%A6"><span class="nav-text">什么是 Internet —— 从服务角度</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84"><span class="nav-text">网络结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E7%BD%91%E7%BB%9C%E8%BE%B9%E7%BC%98"><span class="nav-text">二、网络边缘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E7%BD%91%E7%BB%9C%E6%A0%B8%E5%BF%83"><span class="nav-text">三、网络核心</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2"><span class="nav-text">电路交换</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%AB%AF%E5%88%B0%E7%AB%AF%E7%9A%84%E8%B5%84%E6%BA%90%E8%A2%AB%E5%88%86%E9%85%8D%E7%BB%99%E4%BB%8E%E6%BA%90%E7%AB%AF%E5%88%B0%E7%9B%AE%E6%A0%87%E7%AB%AF%E7%9A%84%E5%91%BC%E5%8F%AB-%E2%80%9Ccall%E2%80%9D%EF%BC%9A"><span class="nav-text">端到端的资源被分配给从源端到目标端的呼叫 “call”：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%B8%BA%E5%91%BC%E5%8F%AB%E9%A2%84%E7%95%99%E7%AB%AF-%E7%AB%AF%E8%B5%84%E6%BA%90"><span class="nav-text">为呼叫预留端-端资源</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E8%B5%84%E6%BA%90%EF%BC%88%E5%A6%82%E5%B8%A6%E5%AE%BD%EF%BC%89%E8%A2%AB%E5%88%86%E6%88%90%E7%89%87"><span class="nav-text">网络资源（如带宽）被分成片</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#FDM-%E4%B8%8E-TDM"><span class="nav-text">FDM 与 TDM</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E4%B8%BE%E4%BE%8B"><span class="nav-text">计算举例</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A7%A3%EF%BC%9A"><span class="nav-text">解：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2%E4%B8%8D%E9%80%82%E5%90%88%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="nav-text">&#x3D;&#x3D;电路交换不适合计算机之间的通信&#x3D;&#x3D;</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2"><span class="nav-text">分组交换</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BB%A5%E5%88%86%E7%BB%84%E4%B8%BA%E5%8D%95%E4%BD%8D%E5%AD%98%E5%82%A8-%E8%BD%AC%E5%8F%91%E6%96%B9%E5%BC%8F"><span class="nav-text">以分组为单位存储-转发方式</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB%EF%BC%8C%E6%8C%89%E9%9C%80%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="nav-text">资源共享，按需使用：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Example"><span class="nav-text">Example:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8E%92%E9%98%9F%E5%BB%B6%E8%BF%9F%E5%92%8C%E4%B8%A2%E5%A4%B1"><span class="nav-text">排队延迟和丢失</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E6%A0%B8%E5%BF%83%E7%9A%84%E5%85%B3%E9%94%AE%E5%8A%9F%E8%83%BD"><span class="nav-text">网络核心的关键功能</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BB%9F%E8%AE%A1%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="nav-text">统计多路复用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2-VS-%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2"><span class="nav-text">分组交换 VS 电路交换</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2%E6%98%AF%E2%80%9C%E7%AA%81%E5%8F%91%E6%95%B0%E6%8D%AE%E7%9A%84%E8%83%9C%E5%88%A9%E8%80%85%EF%BC%9F%E2%80%9D"><span class="nav-text">分组交换是“突发数据的胜利者？”</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2%E7%BD%91%E7%BB%9C%EF%BC%9A%E5%AD%98%E5%82%A8-%E8%BD%AC%E5%8F%91"><span class="nav-text">分组交换网络：存储-转发</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%8A%A5-datagram-%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-text">数据报(datagram) 的工作原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%99%9A%E7%94%B5%E8%B7%AF-virtual-circuit-%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-text">虚电路(virtual circuit)的工作原理</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%88%86%E7%B1%BB"><span class="nav-text">网络分类</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E6%8E%A5%E5%85%A5%E7%BD%91%E7%BB%9C%E5%92%8C%E7%89%A9%E7%90%86%E5%AA%92%E4%BD%93"><span class="nav-text">四、接入网络和物理媒体</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%80%8E%E6%A0%B7%E5%B0%86%E7%AB%AF%E7%B3%BB%E7%BB%9F%E5%92%8C%E8%BE%B9%E7%BC%98%E8%B7%AF%E7%94%B1%E5%99%A8%E8%BF%9E%E6%8E%A5%EF%BC%9F"><span class="nav-text">怎样将端系统和边缘路由器连接？</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A5%E5%85%A5%E7%BD%91"><span class="nav-text">接入网</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%8F%E5%AE%85%E6%8E%A5%E5%85%A5%EF%BC%9Amodem"><span class="nav-text">住宅接入：modem</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%81%E4%B8%9A%E6%8E%A5%E5%85%A5%E7%BD%91%E7%BB%9C-Ethernet"><span class="nav-text">企业接入网络(Ethernet)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E7%BA%BF%E6%8E%A5%E5%85%A5%E7%BD%91%E7%BB%9C"><span class="nav-text">无线接入网络</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%A9%E7%90%86%E5%AA%92%E4%BD%93"><span class="nav-text">物理媒体</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%89%A9%E7%90%86%E5%AA%92%E4%BB%8B%EF%BC%9A%E6%97%A0%E7%BA%BF%E9%93%BE%E8%B7%AF"><span class="nav-text">物理媒介：无线链路</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94%E3%80%81Internet-%E7%BB%93%E6%9E%84%E5%92%8C-ISP"><span class="nav-text">五、Internet 结构和 ISP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E7%9A%84%E7%BD%91%E7%BB%9C"><span class="nav-text">网络的网络</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BB%99%E5%AE%9A%E6%95%B0%E7%99%BE%E4%B8%87%E6%8E%A5%E5%85%A5ISPs%EF%BC%8C%E5%A6%82%E4%BD%95%E5%B0%86%E5%AE%83%E4%BB%AC%E4%BA%92%E8%81%94%E5%88%B0%E4%B8%80%E8%B5%B7"><span class="nav-text">给定数百万接入ISPs，如何将它们互联到一起</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#network-of-networks"><span class="nav-text">network of networks</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%80%E4%B8%AA%E5%88%86%E7%BB%84%E8%A6%81%E7%BB%8F%E8%BF%87%E8%AE%B8%E5%A4%9A%E7%BD%91%E7%BB%9C%EF%BC%81"><span class="nav-text">一个分组要经过许多网络！</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ISP%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BF%9E%E6%8E%A5"><span class="nav-text">ISP之间的连接</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E5%88%86%E7%BB%84%E5%BB%B6%E6%97%B6%E3%80%81%E4%B8%A2%E5%A4%B1%E5%92%8C%E5%90%9E%E5%90%90%E9%87%8F"><span class="nav-text">六、分组延时、丢失和吞吐量</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E4%B8%A2%E5%A4%B1%E5%92%8C%E5%BB%B6%E6%97%B6%E6%98%AF%E6%80%8E%E6%A0%B7%E5%8F%91%E7%94%9F%E7%9A%84%EF%BC%9F"><span class="nav-text">分组丢失和延时是怎样发生的？</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%9B%E7%A7%8D%E5%88%86%E7%BB%84%E5%BB%B6%E6%97%B6"><span class="nav-text">四种分组延时</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E5%BB%B6%E6%97%B6"><span class="nav-text">节点延时</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%92%E9%98%9F%E5%BB%B6%E6%97%B6"><span class="nav-text">排队延时</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Internet%E7%9A%84%E5%BB%B6%E6%97%B6%E5%92%8C%E8%B7%AF%E7%94%B1"><span class="nav-text">Internet的延时和路由</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E4%B8%A2%E5%A4%B1"><span class="nav-text">分组丢失</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%9E%E5%90%90%E9%87%8F"><span class="nav-text">吞吐量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%9E%E5%90%90%E9%87%8F%EF%BC%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%9C%BA%E6%99%AF"><span class="nav-text">吞吐量：互联网场景</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%93%BE%E8%B7%AF%E4%B8%8A%E7%9A%84%E6%AF%8F%E4%B8%80%E6%AE%B5%E5%AE%9E%E9%99%85%E5%8F%AF%E7%94%A8%E5%B8%A6%E5%AE%BDRi%E2%80%99"><span class="nav-text">链路上的每一段实际可用带宽Ri’&#x3D;?</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E5%8D%8F%E8%AE%AE%E5%B1%82%E6%AC%A1%E5%8F%8A%E6%9C%8D%E5%8A%A1%E6%A8%A1%E5%9E%8B"><span class="nav-text">七、协议层次及服务模型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%82%E6%AC%A1%E5%8C%96%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E5%8A%9F%E8%83%BD"><span class="nav-text">层次化方式实现复杂网络功能:</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%92%8C%E6%9C%8D%E5%8A%A1%E8%AE%BF%E9%97%AE%E7%82%B9"><span class="nav-text">服务和服务访问点</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E7%B1%BB%E5%9E%8B"><span class="nav-text">服务类型</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%92%8C%E5%8D%8F%E8%AE%AE"><span class="nav-text">服务和协议</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%95%E5%85%83-DU"><span class="nav-text">数据单元(DU)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%86%E5%B1%82%E5%A4%84%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0%E5%A4%8D%E6%9D%82%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%A5%BD%E5%A4%84%EF%BC%9F"><span class="nav-text">分层处理和实现复杂系统的好处？</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Internet-%E5%8D%8F%E8%AE%AE%E6%A0%88"><span class="nav-text">Internet 协议栈</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ISO-OSI-%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B"><span class="nav-text">ISO&#x2F;OSI 参考模型</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%B0%81%E8%A3%85%E5%92%8C%E8%A7%A3%E5%B0%81%E8%A3%85"><span class="nav-text">封装和解封装</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%90%84%E5%B1%82%E6%AC%A1%E7%9A%84%E5%8D%8F%E8%AE%AE%E6%95%B0%E6%8D%AE%E5%8D%95%E5%85%83"><span class="nav-text">各层次的协议数据单元</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AB%E3%80%81%E5%8E%86%E5%8F%B2"><span class="nav-text">八、历史</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%97%A9%E6%9C%9F%EF%BC%881960%E4%BB%A5%E5%89%8D%EF%BC%89%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C"><span class="nav-text">早期（1960以前）计算机网络</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1961-1972-%E6%97%A9%E6%9C%9F%E7%9A%84%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2%E6%A6%82%E5%BF%B5"><span class="nav-text">1961-1972: 早期的分组交换概念</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1972-1980-%E4%B8%93%E7%94%A8%E7%BD%91%E7%BB%9C%E5%92%8C%E7%BD%91%E7%BB%9C%E4%BA%92%E8%81%94"><span class="nav-text">1972-1980: 专用网络和网络互联</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Cerf-and-Kahn-%E7%BD%91%E7%BB%9C%E4%BA%92%E8%81%94%E5%8E%9F%E5%88%99"><span class="nav-text">Cerf and Kahn 网络互联原则:</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1980-1990%EF%BC%9A%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E5%8F%98%E5%8C%96%EF%BC%8C%E7%BD%91%E7%BB%9C%E6%95%B0%E9%87%8F%E6%BF%80%E5%A2%9E%EF%BC%8C%E5%BA%94%E7%94%A8%E4%B8%B0%E5%AF%8C"><span class="nav-text">1980-1990：体系结构变化，网络数量激增，应用丰富</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1990-2000%E2%80%99s-%E5%95%86%E4%B8%9A%E5%8C%96-Web-%E6%96%B0%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-text">1990, 2000’s: 商业化, Web, 新的应用</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1990%E5%90%8E%E6%9C%9F-%E2%80%93-21%E4%B8%96%E7%BA%AA"><span class="nav-text">1990后期 – 21世纪:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2005-%E7%8E%B0%E5%9C%A8"><span class="nav-text">2005-现在</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%9D%E3%80%81%E5%B0%8F%E7%BB%93"><span class="nav-text">九、小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%BA%94%E7%94%A8%E5%B1%82"><span class="nav-text">第二章 应用层</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE%E5%8E%9F%E7%90%86"><span class="nav-text">一、应用层协议原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E7%9A%84%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="nav-text">网络应用的体系结构</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AE%A2%E6%88%B7-%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88C-S%EF%BC%89%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="nav-text">客户-服务器（C&#x2F;S）体系结构</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AF%B9%E7%AD%89%E4%BD%93%EF%BC%88P2P%EF%BC%89%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="nav-text">对等体（P2P）体系结构</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#C-S%E5%92%8CP2P%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E7%9A%84%E6%B7%B7%E5%90%88%E4%BD%93"><span class="nav-text">C&#x2F;S和P2P体系结构的混合体</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1"><span class="nav-text">进程通信</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1%E9%9C%80%E8%A6%81%E8%A7%A3%E5%86%B3%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">分布式进程通信需要解决的问题</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%97%AE%E9%A2%981%EF%BC%9A%E5%AF%B9%E8%BF%9B%E7%A8%8B%E8%BF%9B%E8%A1%8C%E7%BC%96%E5%9D%80%EF%BC%88addressing%EF%BC%89"><span class="nav-text">问题1：对进程进行编址（addressing）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%97%AE%E9%A2%982%EF%BC%9A%E4%BC%A0%E8%BE%93%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E6%9C%8D%E5%8A%A1"><span class="nav-text">问题2：传输层提供的服务</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#TCP%E4%B9%8B%E4%B8%8A%E7%9A%84%E5%A5%97%E6%8E%A5%E5%AD%97%EF%BC%88socket%EF%BC%89"><span class="nav-text">TCP之上的套接字（socket）</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#UDP%E4%B9%8B%E4%B8%8A%E7%9A%84%E5%A5%97%E6%8E%A5%E5%AD%97%EF%BC%88socket%EF%BC%89"><span class="nav-text">UDP之上的套接字（socket）</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A5%97%E6%8E%A5%E5%AD%97%EF%BC%88Socket%EF%BC%89"><span class="nav-text">套接字（Socket）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%97%AE%E9%A2%983%EF%BC%9A%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E4%BC%A0%E8%BE%93%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E5%BA%94%E7%94%A8"><span class="nav-text">问题3：如何使用传输层提供的服务实现应用</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE"><span class="nav-text">应用层协议</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E9%9C%80%E8%A6%81%E4%BC%A0%E8%BE%93%E5%B1%82%E6%8F%90%E4%BE%9B%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%E6%9C%8D%E5%8A%A1%EF%BC%9F"><span class="nav-text">应用需要传输层提供什么样的服务？</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E5%BA%94%E7%94%A8%E5%AF%B9%E4%BC%A0%E8%BE%93%E6%9C%8D%E5%8A%A1%E7%9A%84%E8%A6%81%E6%B1%82"><span class="nav-text">常见应用对传输服务的要求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Internet-%E4%BC%A0%E8%BE%93%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E6%9C%8D%E5%8A%A1"><span class="nav-text">Internet 传输层提供的服务</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#TCP-%E6%9C%8D%E5%8A%A1"><span class="nav-text">TCP 服务</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#UDP-%E6%9C%8D%E5%8A%A1"><span class="nav-text">UDP 服务</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UDP%E5%AD%98%E5%9C%A8%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7"><span class="nav-text">UDP存在的必要性</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%89%E5%85%A8TCP"><span class="nav-text">安全TCP</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#TCP-UDP"><span class="nav-text">TCP &amp; UDP</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#SSL-%E2%80%94%E2%80%94%E5%BA%94%E7%94%A8%E5%B1%82"><span class="nav-text">SSL ——应用层</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#SSL%E5%9C%A8%E5%BA%94%E7%94%A8%E5%B1%82"><span class="nav-text">SSL在应用层</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#SSL-socket-API"><span class="nav-text">SSL socket API</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81Web-and-HTTP"><span class="nav-text">二、Web and HTTP</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E6%9C%AF%E8%AF%AD"><span class="nav-text">一些术语</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP-%E6%A6%82%E5%86%B5"><span class="nav-text">HTTP 概况</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#HTTP-%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE"><span class="nav-text">HTTP: 超文本传输协议</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8TCP"><span class="nav-text">使用TCP</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#HTTP%E6%98%AF%E6%97%A0%E7%8A%B6%E6%80%81%E7%9A%84"><span class="nav-text">HTTP是无状态的</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%B4%E6%8A%A4%E7%8A%B6%E6%80%81%E7%9A%84%E5%8D%8F%E8%AE%AE%E5%BE%88%E5%A4%8D%E6%9D%82%EF%BC%81"><span class="nav-text">维护状态的协议很复杂！</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP%E8%BF%9E%E6%8E%A5"><span class="nav-text">HTTP连接</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%9D%9E%E6%8C%81%E4%B9%85HTTP"><span class="nav-text">非持久HTTP</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9D%9E%E6%8C%81%E4%B9%85HTTP%E8%BF%9E%E6%8E%A5"><span class="nav-text">非持久HTTP连接</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E6%A8%A1%E5%9E%8B"><span class="nav-text">响应时间模型</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8C%81%E4%B9%85HTTP"><span class="nav-text">持久HTTP</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HTTP%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87"><span class="nav-text">HTTP请求报文</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87%EF%BC%9A%E9%80%9A%E7%94%A8%E6%A0%BC%E5%BC%8F"><span class="nav-text">HTTP请求报文：通用格式</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8F%90%E4%BA%A4%E8%A1%A8%E5%8D%95%E8%BE%93%E5%85%A5"><span class="nav-text">提交表单输入</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E7%B1%BB%E5%9E%8B"><span class="nav-text">方法类型</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HTTP%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87"><span class="nav-text">HTTP响应报文</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#HTTP%E5%93%8D%E5%BA%94%E7%8A%B6%E6%80%81%E7%A0%81"><span class="nav-text">HTTP响应状态码</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Trying-out-HTTP-client-side-for-yourself"><span class="nav-text">Trying out HTTP (client side) for yourself</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%94%A8%E6%88%B7-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%8A%B6%E6%80%81%EF%BC%9Acookies"><span class="nav-text">用户-服务器状态：cookies</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#4%E4%B8%AA%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86%EF%BC%9A"><span class="nav-text">4个组成部分：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Cookies-%E7%BB%B4%E6%8A%A4%E7%8A%B6%E6%80%81"><span class="nav-text">Cookies: 维护状态</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Cookies%E8%83%BD%E5%B8%A6%E6%9D%A5%E4%BB%80%E4%B9%88"><span class="nav-text">Cookies能带来什么</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E7%BB%B4%E6%8C%81%E7%8A%B6%E6%80%81"><span class="nav-text">如何维持状态</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Cookies%E4%B8%8E%E9%9A%90%E7%A7%81"><span class="nav-text">Cookies与隐私</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Web%E7%BC%93%E5%AD%98-%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-text">Web缓存 (代理服务器)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8Web%E7%BC%93%E5%AD%98-%EF%BC%9F"><span class="nav-text">为什么要使用Web缓存 ？</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-text">示例</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%81%87%E8%AE%BE-%EF%BC%9A"><span class="nav-text">&#x3D;&#x3D;假设&#x3D;&#x3D;：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BB%93%E6%9E%9C-%EF%BC%9A"><span class="nav-text">&#x3D;&#x3D;结果&#x3D;&#x3D;：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9B%B4%E5%BF%AB%E7%9A%84%E6%8E%A5%E5%85%A5%E9%93%BE%E8%B7%AF"><span class="nav-text">更快的接入链路</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%81%87%E8%AE%BE-%EF%BC%9A-2"><span class="nav-text">&#x3D;&#x3D;假设&#x3D;&#x3D;：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BB%93%E6%9E%9C-%EF%BC%9A-2"><span class="nav-text">&#x3D;&#x3D;结果&#x3D;&#x3D;：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E6%9C%AC%E5%9C%B0%E7%BC%93%E5%AD%98"><span class="nav-text">安装本地缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%81%87%E8%AE%BE-%EF%BC%9A-3"><span class="nav-text">&#x3D;&#x3D;假设&#x3D;&#x3D;：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BB%93%E6%9E%9C-%EF%BC%9A-3"><span class="nav-text">&#x3D;&#x3D;结果&#x3D;&#x3D;：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6GET%E6%96%B9%E6%B3%95"><span class="nav-text">条件GET方法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81FTP%EF%BC%9A%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE"><span class="nav-text">三、FTP：文件传输协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E8%BF%9E%E6%8E%A5%E4%B8%8E%E6%95%B0%E6%8D%AE%E8%BF%9E%E6%8E%A5%E5%88%86%E5%BC%80"><span class="nav-text">控制连接与数据连接分开</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FTP%E5%91%BD%E4%BB%A4%E3%80%81%E5%93%8D%E5%BA%94"><span class="nav-text">FTP命令、响应</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%A0%B7%E4%BE%8B%EF%BC%9A"><span class="nav-text">命令样例：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E7%A0%81%E6%A0%B7%E4%BE%8B%EF%BC%9A"><span class="nav-text">返回码样例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E3%80%81EMail%EF%BC%9A%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6"><span class="nav-text">四、EMail：电子邮件</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3%E4%B8%AA%E4%B8%BB%E8%A6%81%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86"><span class="nav-text">3个主要组成部分</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E4%BB%A3%E7%90%86"><span class="nav-text">用户代理</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-text">邮件服务器</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#EMail-SMTP-RFC-2821"><span class="nav-text">EMail: SMTP [RFC 2821]</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%B8%BE%E4%BE%8B%EF%BC%9AAlice%E7%BB%99Bob%E5%8F%91%E9%80%81%E6%8A%A5%E6%96%87"><span class="nav-text">举例：Alice给Bob发送报文</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84SMTP%E4%BA%A4%E4%BA%92"><span class="nav-text">简单的SMTP交互</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Try-SMTP-interaction-for-yourself"><span class="nav-text">Try SMTP interaction for yourself</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#HTTP%E6%AF%94%E8%BE%83%EF%BC%9A"><span class="nav-text">HTTP比较：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%82%AE%E4%BB%B6%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F"><span class="nav-text">邮件报文格式</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%A4%9A%E5%AA%92%E4%BD%93%E6%89%A9%E5%B1%95"><span class="nav-text">多媒体扩展</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%82%AE%E4%BB%B6%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE"><span class="nav-text">邮件访问协议</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#POP3%E5%8D%8F%E8%AE%AE"><span class="nav-text">POP3协议</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#IMAP"><span class="nav-text">IMAP</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94%E3%80%81DNS%EF%BC%88Domain-Name-System%EF%BC%89"><span class="nav-text">五、DNS（Domain Name System）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#DNS%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7"><span class="nav-text">DNS的必要性</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#DNS%E7%B3%BB%E7%BB%9F%E9%9C%80%E8%A6%81%E8%A7%A3%E5%86%B3%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">DNS系统需要解决的问题</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#DNS-Domain-Name-System-%E7%9A%84%E5%8E%86%E5%8F%B2"><span class="nav-text">DNS(Domain Name System)的历史</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#DNS-Domain-Name-System-%E6%80%BB%E4%BD%93%E6%80%9D%E8%B7%AF%E5%92%8C%E7%9B%AE%E6%A0%87"><span class="nav-text">DNS(Domain Name System)总体思路和目标</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%97%AE%E9%A2%981%EF%BC%9ADNS%E5%90%8D%E5%AD%97%E7%A9%BA%E9%97%B4-The-DNS-Name-Space"><span class="nav-text">问题1：DNS名字空间(The DNS Name Space)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DNS-%E6%A0%B9%E5%90%8D%E5%AD%97%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-text">DNS: 根名字服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%97%AE%E9%A2%982%EF%BC%9A%E8%A7%A3%E6%9E%90%E9%97%AE%E9%A2%98-%E5%90%8D%E5%AD%97%E6%9C%8D%E5%8A%A1%E5%99%A8-Name-Server"><span class="nav-text">问题2：解析问题-名字服务器(Name Server)</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8C%BA%E5%9F%9F%E5%90%8D%E5%AD%97%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%B4%E6%8A%A4%E8%B5%84%E6%BA%90%E8%AE%B0%E5%BD%95"><span class="nav-text">区域名字服务器维护资源记录</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#DNS%E8%AE%B0%E5%BD%95"><span class="nav-text">DNS记录</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90"><span class="nav-text">一个例子</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E5%90%8D%E5%AD%97%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88Local-Name-Server%EF%BC%89"><span class="nav-text">本地名字服务器（Local Name Server）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8D%E5%AD%97%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88Name-Server%EF%BC%89"><span class="nav-text">名字服务器（Name Server）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%92%E5%BD%92%E6%9F%A5%E8%AF%A2"><span class="nav-text">递归查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%AD%E4%BB%A3%E6%9F%A5%E8%AF%A2"><span class="nav-text">迭代查询</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#DNS%E5%8D%8F%E8%AE%AE%E3%80%81%E6%8A%A5%E6%96%87"><span class="nav-text">DNS协议、报文</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%90%E9%AB%98%E6%80%A7%E8%83%BD%EF%BC%9A%E7%BC%93%E5%AD%98"><span class="nav-text">提高性能：缓存</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%97%AE%E9%A2%983%EF%BC%9A%E7%BB%B4%E6%8A%A4%E9%97%AE%E9%A2%98%EF%BC%9A%E6%96%B0%E5%A2%9E%E4%B8%80%E4%B8%AA%E5%9F%9F"><span class="nav-text">问题3：维护问题：新增一个域</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%94%BB%E5%87%BBDNS"><span class="nav-text">攻击DNS</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#DDoS-%E6%94%BB%E5%87%BB"><span class="nav-text">DDoS 攻击</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91%E6%94%BB%E5%87%BB"><span class="nav-text">重定向攻击</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AD%E3%80%81P2P-%E5%BA%94%E7%94%A8"><span class="nav-text">六、P2P 应用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BA%AFP2P%E6%9E%B6%E6%9E%84"><span class="nav-text">纯P2P架构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#C-S-vs-P2P"><span class="nav-text">C&#x2F;S vs P2P</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%97%AE%E9%A2%98-%E4%BB%8E%E4%B8%80%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%88%86%E5%8F%91%E6%96%87%E4%BB%B6%EF%BC%88%E5%A4%A7%E5%B0%8FF%EF%BC%89%E5%88%B0N%E4%B8%AApeer-%E9%9C%80%E8%A6%81%E5%A4%9A%E5%B0%91%E6%97%B6%E9%97%B4%EF%BC%9F"><span class="nav-text">问题: 从一台服务器分发文件（大小F）到N个peer 需要多少时间？</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#C-S%E6%A8%A1%E5%BC%8F"><span class="nav-text">C&#x2F;S模式</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%87%87%E7%94%A8C-S%E7%9A%84%E6%96%B9%E6%B3%95%E5%B0%86%E4%B8%80%E4%B8%AAF%E5%A4%A7%E5%B0%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%86%E5%8F%91%E7%BB%99N%E4%B8%AA%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%80%97%E6%97%B6%EF%BC%9A"><span class="nav-text">&#x3D;&#x3D;采用C-S的方法将一个F大小的文件分发给N个客户端耗时：&#x3D;&#x3D;</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#P2P%E6%A8%A1%E5%BC%8F"><span class="nav-text">P2P模式</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%87%87%E7%94%A8P2P%E6%96%B9%E6%B3%95%E5%B0%86%E4%B8%80%E4%B8%AAF%E5%A4%A7%E5%B0%8F%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%86%E5%8F%91%E7%BB%99N%E4%B8%AA%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%80%97%E6%97%B6%EF%BC%9A"><span class="nav-text">&#x3D;&#x3D;采用P2P方法将一个F大小的文件分发给N个客户端耗时：&#x3D;&#x3D;</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CS-VS-P2P-%E4%BE%8B%E5%AD%90"><span class="nav-text">CS VS P2P 例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#P2P%E6%96%87%E4%BB%B6%E5%88%86%E5%8F%91"><span class="nav-text">P2P文件分发</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#BitTorrent"><span class="nav-text">BitTorrent</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E6%96%87%E4%BB%B6%E5%9D%97"><span class="nav-text">请求文件块</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8F%91%E9%80%81%E6%96%87%E4%BB%B6%E5%9D%97%EF%BC%9A%E4%B8%80%E6%8A%A5%E8%BF%98%E4%B8%80%E6%8A%A5titfor-tat"><span class="nav-text">发送文件块：一报还一报titfor-tat</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#P2P%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB%E4%BE%8B%E5%AD%90"><span class="nav-text">P2P文件共享例子</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#P2P%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB%E7%9A%84%E4%B8%A4%E4%B8%AA%E9%97%AE%E9%A2%98"><span class="nav-text">P2P文件共享的两个问题</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8F%AF%E8%83%BD%E7%9A%84%E6%96%B9%E6%A1%88%EF%BC%88%E9%9D%9E%E7%BB%93%E6%9E%84%E5%8C%96P2P%EF%BC%89"><span class="nav-text">可能的方案（非结构化P2P）</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9B%86%E4%B8%AD%E5%BC%8F%E7%9B%AE%E5%BD%95%E2%80%94%E2%80%94%E9%9D%9E%E7%BB%93%E6%9E%84%E5%8C%96"><span class="nav-text">集中式目录——非结构化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#P2P%EF%BC%9A%E9%9B%86%E4%B8%AD%E5%BC%8F%E7%9B%AE%E5%BD%95%E4%B8%AD%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">P2P：集中式目录中存在的问题</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%8C%E5%85%A8%E5%88%86%E5%B8%83%E5%BC%8F%EF%BC%9A%E6%9F%A5%E8%AF%A2%E6%B4%AA%E6%B3%9B%EF%BC%88Gnutella%EF%BC%89%E2%80%94%E2%80%94%E9%9D%9E%E7%BB%93%E6%9E%84%E5%8C%96"><span class="nav-text">完全分布式：查询洪泛（Gnutella）——非结构化</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A6%86%E7%9B%96%E7%BD%91%E7%BB%9C"><span class="nav-text">覆盖网络</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8D%8F%E8%AE%AE"><span class="nav-text">协议</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AF%B9%E7%AD%89%E6%96%B9%E5%8A%A0%E5%85%A5"><span class="nav-text">对等方加入</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B7%B7%E5%90%88%E4%BD%93%EF%BC%9A%E5%88%A9%E7%94%A8%E4%B8%8D%E5%8C%80%E7%A7%B0%E6%80%A7%EF%BC%88KaZaA%EF%BC%89%E2%80%94%E2%80%94%E9%9D%9E%E7%BB%93%E6%9E%84%E5%8C%96"><span class="nav-text">混合体：利用不匀称性（KaZaA）——非结构化</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2"><span class="nav-text">查询</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Kazaa%E5%B0%8F%E6%8A%80%E5%B7%A7"><span class="nav-text">Kazaa小技巧</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Distributed-Hash-Table-DHT-%E2%80%94%E2%80%94%E7%BB%93%E6%9E%84%E5%8C%96-P2P"><span class="nav-text">Distributed Hash Table (DHT)——结构化 P2P</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%83%E3%80%81CDN%E2%80%94%E2%80%94%E8%AE%A9%E5%86%85%E5%AE%B9%E9%9D%A0%E8%BF%91%E7%94%A8%E6%88%B7"><span class="nav-text">七、CDN——让内容靠近用户</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%86%E9%A2%91%E6%B5%81%E5%8C%96%E6%9C%8D%E5%8A%A1%E5%92%8CCDN%EF%BC%9A%E4%B8%8A%E4%B8%8B%E6%96%87"><span class="nav-text">视频流化服务和CDN：上下文</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%86%E9%A2%91"><span class="nav-text">视频</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E8%A7%86%E9%A2%91%E7%9A%84%E6%B5%81%E5%8C%96%E6%9C%8D%E5%8A%A1"><span class="nav-text">存储视频的流化服务</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E5%AA%92%E4%BD%93%E6%B5%81%E5%8C%96%E6%9C%8D%E5%8A%A1%EF%BC%9ADASH"><span class="nav-text">多媒体流化服务：DASH</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Content-Distribution-Networks%EF%BC%88CDNs%EF%BC%89"><span class="nav-text">Content Distribution Networks（CDNs）</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%80%89%E6%8B%A91-%E5%8D%95%E4%B8%AA%E7%9A%84%E3%80%81%E5%A4%A7%E7%9A%84%E8%B6%85%E7%BA%A7%E6%9C%8D%E5%8A%A1%E4%B8%AD%E5%BF%83%E2%80%9Cmegaserver%E2%80%9D"><span class="nav-text">选择1: 单个的、大的超级服务中心“megaserver”</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%80%89%E9%A1%B92-%E9%80%9A%E8%BF%87CDN%EF%BC%8C%E5%85%A8%E7%BD%91%E9%83%A8%E7%BD%B2%E7%BC%93%E5%AD%98%E8%8A%82%E7%82%B9%EF%BC%8C%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1%E5%86%85%E5%AE%B9%EF%BC%8C%E5%B0%B1%E8%BF%91%E4%B8%BA%E7%94%A8%E6%88%B7%E6%8F%90%E4%BE%9B%E6%9C%8D%E5%8A%A1%EF%BC%8C%E6%8F%90%E9%AB%98%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C"><span class="nav-text">选项2: 通过CDN，全网部署缓存节点，存储服务内容，就近为用户提供服务，提高用户体验</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#OTT-%E6%8C%91%E6%88%98-%E5%9C%A8%E6%8B%A5%E5%A1%9E%E7%9A%84%E4%BA%92%E8%81%94%E7%BD%91%E4%B8%8A%E5%A4%8D%E5%88%B6%E5%86%85%E5%AE%B9"><span class="nav-text">OTT 挑战: 在拥塞的互联网上复制内容</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#CDN-%E2%80%9C%E7%AE%80%E5%8D%95%E2%80%9D%E5%86%85%E5%AE%B9%E8%AE%BF%E9%97%AE%E5%9C%BA%E6%99%AF"><span class="nav-text">CDN:“简单”内容访问场景</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Netflix"><span class="nav-text">Netflix</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AB%E3%80%81TCP-%E5%A5%97%E6%8E%A5%E5%AD%97%E7%BC%96%E7%A8%8B"><span class="nav-text">八、TCP 套接字编程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2%E7%A7%8D%E4%BC%A0%E8%BE%93%E5%B1%82%E6%9C%8D%E5%8A%A1%E7%9A%84socket%E7%B1%BB%E5%9E%8B"><span class="nav-text">2种传输层服务的socket类型:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TCP%E5%A5%97%E6%8E%A5%E5%AD%97%E7%BC%96%E7%A8%8B"><span class="nav-text">TCP套接字编程</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%A6%96%E5%85%88%E8%BF%90%E8%A1%8C%EF%BC%8C%E7%AD%89%E5%BE%85%E8%BF%9E%E6%8E%A5%E5%BB%BA%E7%AB%8B"><span class="nav-text">服务器首先运行，等待连接建立</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%BB%E5%8A%A8%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5%EF%BC%9A"><span class="nav-text">客户端主动和服务器建立连接：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%9A%84%E8%A7%92%E5%BA%A6"><span class="nav-text">从应用程序的角度</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#C-S%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%BA%94%E7%94%A8%E6%A0%B7%E4%BE%8B"><span class="nav-text">C&#x2F;S模式的应用样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#C-S-socket-%E4%BA%A4%E4%BA%92-TCP"><span class="nav-text">C&#x2F;S socket 交互: TCP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-text">数据结构</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#sockaddr-in"><span class="nav-text">sockaddr_in</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hostent"><span class="nav-text">hostent</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90-C-%E5%AE%A2%E6%88%B7%E7%AB%AF-TCP"><span class="nav-text">例子: C 客户端(TCP)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9AC-%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88TCP%EF%BC%89"><span class="nav-text">例子：C 服务器（TCP）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%9D%E3%80%81UDP-Socket%E7%BC%96%E7%A8%8B"><span class="nav-text">九、UDP Socket编程</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#UDP-%E5%9C%A8%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B9%8B%E9%97%B4%E6%B2%A1%E6%9C%89%E8%BF%9E%E6%8E%A5"><span class="nav-text">UDP: 在客户端和服务器之间没有连接</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E8%A7%86%E8%A7%92%E7%9C%8BUDP%E6%9C%8D%E5%8A%A1"><span class="nav-text">进程视角看UDP服务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#C-S-socket-%E4%BA%A4%E4%BA%92-TCP-2"><span class="nav-text">C&#x2F;S socket 交互: TCP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B-C%E5%AE%A2%E6%88%B7%E7%AB%AF-UDP"><span class="nav-text">样例: C客户端 (UDP)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B7%E4%BE%8B-C%E6%9C%8D%E5%8A%A1%E5%99%A8-UDP"><span class="nav-text">样例: C服务器(UDP)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%81%E3%80%81%E5%B0%8F%E7%BB%93"><span class="nav-text">十、小结</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9B%B4%E9%87%8D%E8%A6%81%E7%9A%84%EF%BC%9A%E5%AD%A6%E4%B9%A0%E5%8D%8F%E8%AE%AE%E7%9A%84%E7%9F%A5%E8%AF%86"><span class="nav-text">更重要的：学习协议的知识</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E4%BC%A0%E8%BE%93%E5%B1%82"><span class="nav-text">第三章 传输层</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E6%A0%87"><span class="nav-text">目标</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E6%A6%82%E8%BF%B0%E5%92%8C%E4%BC%A0%E8%BE%93%E5%B1%82%E6%9C%8D%E5%8A%A1"><span class="nav-text">一、概述和传输层服务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%A0%E8%BE%93%E6%9C%8D%E5%8A%A1%E5%92%8C%E5%8D%8F%E8%AE%AE"><span class="nav-text">传输服务和协议</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82-vs-%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="nav-text">传输层 vs. 网络层</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9A%E4%B8%9C%E8%A5%BF2%E4%B8%AA%E5%AE%B6%E5%BA%AD%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="nav-text">例子：东西2个家庭的通信</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Internet%E4%BC%A0%E8%BE%93%E5%B1%82%E5%8D%8F%E8%AE%AE"><span class="nav-text">Internet传输层协议</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E4%B8%8E%E8%A7%A3%E5%A4%8D%E7%94%A8"><span class="nav-text">二、多路复用与解复用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E8%B7%AF%E8%A7%A3%E5%A4%8D%E7%94%A8%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-text">多路解复用工作原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E8%BF%9E%E6%8E%A5-UDP-%E5%A4%9A%E8%B7%AF%E8%A7%A3%E5%A4%8D%E7%94%A8"><span class="nav-text">无连接(UDP)多路解复用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%EF%BC%9A"><span class="nav-text">服务器端：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%EF%BC%9A"><span class="nav-text">客户端：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%9B%9E%E9%A1%BE"><span class="nav-text">回顾</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E8%BF%9E%E6%8E%A5%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E4%BE%8B%E5%AD%90"><span class="nav-text">无连接多路复用例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5-TCP-%E7%9A%84%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="nav-text">面向连接(TCP)的多路复用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E8%A7%A3%E5%A4%8D%E7%94%A8%E4%BE%8B%E5%AD%90"><span class="nav-text">面向连接的解复用例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9A%E5%A4%9A%E7%BA%BF%E7%A8%8B-Web-Server"><span class="nav-text">面向连接的多路复用：多线程 Web Server</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E6%97%A0%E8%BF%9E%E6%8E%A5%E4%BC%A0%E8%BE%93%EF%BC%9AUDP"><span class="nav-text">三、无连接传输：UDP</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E6%9C%89UDP"><span class="nav-text">为什么要有UDP?</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#UDP%E6%8A%A5%E6%96%87%E6%AE%B5%E6%A0%BC%E5%BC%8F"><span class="nav-text">UDP报文段格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#UDP%E6%A0%A1%E9%AA%8C%E5%92%8C"><span class="nav-text">UDP校验和</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Internet%E6%A0%A1%E9%AA%8C%E5%92%8C%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="nav-text">Internet校验和的例子</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F-%EF%BC%9A%E5%BD%93%E6%95%B0%E5%AD%97%E7%9B%B8%E5%8A%A0%E6%97%B6%EF%BC%8C%E5%9C%A8%E6%9C%80%E9%AB%98%E4%BD%8D%E7%9A%84%E8%BF%9B%E4%BD%8D%E8%A6%81%E5%9B%9E%E5%8D%B7%EF%BC%8C%E5%86%8D%E5%8A%A0%E5%88%B0%E7%BB%93%E6%9E%9C%E4%B8%8A"><span class="nav-text">&#x3D;&#x3D;注意&#x3D;&#x3D;：当数字相加时，在最高位的进位要回卷，再加到结果上</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9A%E4%B8%A4%E4%B8%AA16%E6%AF%94%E7%89%B9%E7%9A%84%E6%95%B4%E6%95%B0%E7%9B%B8%E5%8A%A0"><span class="nav-text">&#x3D;&#x3D;例子：两个16比特的整数相加&#x3D;&#x3D;</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E5%8F%AF%E9%9D%A0%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%EF%BC%88rdt%EF%BC%89%E7%9A%84%E5%8E%9F%E7%90%86"><span class="nav-text">四、可靠数据传输（rdt）的原理</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8F%AF%E9%9D%A0%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%EF%BC%9A%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0"><span class="nav-text">可靠数据传输：问题描述</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A6%81%E5%81%9A%E7%9A%84%E4%BA%8B%EF%BC%9A"><span class="nav-text">要做的事：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Rdt1-0%EF%BC%9A%E5%9C%A8%E5%8F%AF%E9%9D%A0%E4%BF%A1%E9%81%93%E4%B8%8A%E7%9A%84%E5%8F%AF%E9%9D%A0%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93"><span class="nav-text">Rdt1.0：在可靠信道上的可靠数据传输</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Rdt2-0%EF%BC%9A%E5%85%B7%E6%9C%89%E6%AF%94%E7%89%B9%E5%B7%AE%E9%94%99%E7%9A%84%E4%BF%A1%E9%81%93"><span class="nav-text">Rdt2.0：具有比特差错的信道</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FSM-%E6%8F%8F%E8%BF%B0"><span class="nav-text">FSM 描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rdt2-0%EF%BC%9AACK%E5%92%8CNCK%E6%93%8D%E4%BD%9C"><span class="nav-text">rdt2.0：ACK和NCK操作</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#ACK%EF%BC%88%E6%97%A0%E5%B7%AE%E9%94%99%EF%BC%89"><span class="nav-text">&#x3D;&#x3D;ACK（无差错）&#x3D;&#x3D;</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#NAK%EF%BC%88%E6%9C%89%E5%B7%AE%E9%94%99%EF%BC%89"><span class="nav-text">&#x3D;&#x3D;NAK（有差错）&#x3D;&#x3D;</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#rdt2-0%E7%9A%84%E8%87%B4%E5%91%BD%E7%BC%BA%E9%99%B7%EF%BC%81"><span class="nav-text">rdt2.0的致命缺陷！</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%9C%80%E8%A6%81%E5%BC%95%E5%85%A5%E6%96%B0%E7%9A%84%E6%9C%BA%E5%88%B6%EF%BC%9A%E5%BA%8F%E5%8F%B7"><span class="nav-text">&#x3D;&#x3D;需要引入新的机制：序号&#x3D;&#x3D;</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%81%9C%E7%AD%89%E5%8D%8F%E8%AE%AE"><span class="nav-text">停等协议</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rdt2-1"><span class="nav-text">rdt2.1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%91%E9%80%81%E6%96%B9%E5%A4%84%E7%90%86%E5%87%BA%E9%94%99%E7%9A%84ACK-NAK"><span class="nav-text">发送方处理出错的ACK&#x2F;NAK</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A5%E6%94%B6%E6%96%B9%E5%A4%84%E7%90%86%E5%87%BA%E9%94%99%E7%9A%84ACK-NAK"><span class="nav-text">接收方处理出错的ACK&#x2F;NAK</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%A8%E8%AE%BA"><span class="nav-text">讨论</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%91%E9%80%81%E6%96%B9%EF%BC%9A"><span class="nav-text">发送方：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A5%E6%94%B6%E6%96%B9"><span class="nav-text">接收方</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F"><span class="nav-text">注意</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rdt2-2%EF%BC%9A%E6%97%A0NAK%E7%9A%84%E5%8D%8F%E8%AE%AE"><span class="nav-text">rdt2.2：无NAK的协议</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rdt2-2%E7%9A%84%E8%BF%90%E8%A1%8C"><span class="nav-text">rdt2.2的运行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rdt2-2%EF%BC%9A%E5%8F%91%E9%80%81%E6%96%B9%E5%92%8C%E6%8E%A5%E6%94%B6%E6%96%B9%E7%89%87%E6%96%AD"><span class="nav-text">rdt2.2：发送方和接收方片断</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rdt3-0%EF%BC%9A%E5%85%B7%E6%9C%89%E6%AF%94%E7%89%B9%E5%B7%AE%E9%94%99%E5%92%8C%E5%88%86%E7%BB%84%E4%B8%A2%E5%A4%B1%E7%9A%84%E4%BF%A1%E9%81%93"><span class="nav-text">rdt3.0：具有比特差错和分组丢失的信道</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%91%E9%80%81%E6%96%B9"><span class="nav-text">发送方</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rdt3-0%E7%9A%84%E8%BF%90%E8%A1%8C"><span class="nav-text">rdt3.0的运行</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rdt3-0%E7%9A%84%E6%80%A7%E8%83%BD"><span class="nav-text">rdt3.0的性能</span></a></li></ol></li></ol></li></ol>

    </div>
</div>
            </div>
        
    </div>
</div>


                

            </div>



        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info">
            &copy;
            
              <span>2023</span>
              -
            
            2023&nbsp;&nbsp;<i class="fa-regular fa-computer-classic"></i>&nbsp;&nbsp;<a href="/">Lubo</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv" class="busuanzi_container_site_uv">
                        VISITOR COUNT&nbsp;<span id="busuanzi_value_site_uv" class="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="busuanzi_container_site_pv">
                        TOTAL PAGE VIEWS&nbsp;<span id="busuanzi_value_site_pv" class="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            <span class="powered-by-container">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" href="https://hexo.io">Hexo</a></span>
                <br> 
            <span class="theme-version-container">THEME&nbsp;<a class="theme-version" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v1.1.3</a>
        </div>
        
        
        
            <div id="start_time_div" style="display:none">
                2023/2/28 00:00:00
            </div>
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
        
            <script async data-pjax>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="unfolded-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-expand-width flex-center">
            <i class="fa-regular fa-expand"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="right-bottom-tools tool-scroll-to-top flex-center">
                <i class="fa-regular fa-arrow-up"></i>
            </li>
        

        <li class="right-bottom-tools tool-scroll-to-bottom flex-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="folded-tools-list">
        <li class="right-bottom-tools tool-toggle-show flex-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    


</main>



<script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/utils.js"></script><script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/main.js"></script><script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/layouts/menu-shrink.js"></script><script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/tools/go-top-bottom.js"></script><script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/tools/dark-light-toggle.js"></script>


    <script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/tools/local-search.js"></script>



    <script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/tools/code-block.js"></script>



    <script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/layouts/lazyload.js"></script>



    <script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/tools/runtime.js"></script>
    <script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/layouts/odometer.min.js"></script>
    <link rel="stylesheet" href="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/assets/odometer-theme-minimal.css">


<div class="post-scripts pjax">
    
        <script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/tools/toc-toggle.js"></script><script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/libs/anime.min.js"></script><script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/layouts/toc.js"></script><script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/plugins/tabs.js"></script>
    
    
</div>


    <script src="//evan.beee.top/projects/hexo-theme-redefine/v1.1.3/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            REDEFINE.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            REDEFINE.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            REDEFINE.refresh();
        });
    });
</script>



</body>
</html>
